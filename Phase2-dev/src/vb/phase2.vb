Imports Microsoft.VisualBasic
Imports Microsoft.Office.Interop
Imports System.Data
Imports System.Data.SqlClient
Imports System.IO

Public Class ExcelSpreadsheet

#Region "Member variables"

    'Worksheet Titles
    Dim sTitle_RR_YEAR As String
    Dim sTitle_WORKTABLE As String
    Dim sNullValueString As String
    Dim sSheetTitle As String
    Dim iColumnCount As Integer
    Dim sWorktableColumn As String
    Dim sColumnName As String
    Dim sColumnRange As String
    Dim sSelectWorktable As String
    Dim sSelectStringRows As String
    Dim iROW_COUNT As Integer
    Dim iRailroadNumber As Integer
    Dim iRRICC As Integer
    Dim sRailRoadShortName As String
    Dim sRailRoadName As String
    Dim iCurrentYear As Integer
    Dim iRunYears As Integer
    Dim bCapitalCost As Boolean
    Dim bVarialabilityFlow As Boolean
    Dim bAccount76 As Boolean
    Dim bAccount80 As Boolean
    Dim bAccount90 As Boolean
    Dim bSSAC As Boolean

    'Tables
    Dim dtFootnotes As DataTable
    Dim dtTitles As DataTable
    Dim dtAValue As DataTable
    Dim dtAValue0_RR As DataTable
    Dim dtAValueRegion_RR As DataTable
    Dim dtLineSourceText As DataTable
    Dim dtCarTypeStatistics As DataTable
    Dim dtCarTypeStatisticsPart2 As DataTable
    Dim dtCarTypeStatisticsPart3 As DataTable
    Dim dtPriceIndexes As DataTable
    Dim dtPriceIndexReferences As DataTable
    Dim dtRegression As DataTable
    Dim dtRegressionDependentVariable As DataTable
    Dim dtRegressionDistribution As DataTable
    Dim dtDataDictionary As DataTable
    Dim dtDefinitions As DataTable
    Dim dtECodes As DataTable

    'Excel variables
    Dim oExcel As Excel.Application = Nothing 'IV
    Dim oBook As Excel.Workbook = Nothing 'IV
    Dim oBooks As Excel.Workbooks = Nothing
    Dim oXLWsheet As Excel.Worksheet = Nothing
    Dim oRange As Excel.Range = Nothing
    Dim oTempRange As Excel.Range = Nothing
    Dim intColumn, intRow, intColumnValue As Integer
    Dim sNamedRange As String = ""
    Dim iLineNumberOffset As Integer = 0
    Dim sNamedRangePrefix As String = ""
    Dim iWorkTableColumnCount As Integer = 0
    Dim oVariabilityMatrix As Excel.Range = Nothing

    Dim oDB As DBManager
    Dim sFileName As String
    Dim sLogFileName As String
    Dim bCreateLog As Boolean

    Public Event StatusUpdated(RailRoadNumber As Integer, Status As String, Completed As Boolean)

#End Region

    Public Sub New(ByVal OutputFolder As String, ByVal CurrentYear As String, ByVal RR_No As Integer, ByVal RRICC As String,
                   ByVal RR_Name As String, ByVal RR_LongName As String, ByVal NullStringReplace As String, ByVal runYears As Integer,
                   ByVal CapitalCost As Boolean, ByVal VarialabilityFlow As Boolean, ByVal Account76 As Boolean,
                   ByVal Account80 As Boolean, ByVal Account90 As Boolean, ByVal SSAC As Boolean, ByVal CreateLog As Boolean, ByVal DB As DBManager)

        oDB = DB
        sFileName = OutputFolder & "\" & RR_Name & CurrentYear
        sLogFileName = OutputFolder & "\Log\" & RR_Name & CurrentYear & ".log"
        bCreateLog = CreateLog

        'STORE THE NULL VALUE STRING
        sNullValueString = NullStringReplace

        'STORE THE RUN YEARS
        iRunYears = runYears

        'STORE THE RAILROAD IDENTIFICATION DATA
        iRailroadNumber = RR_No
        iRRICC = RRICC
        sRailRoadShortName = RR_Name
        sRailRoadName = RR_LongName

        'STORE PROCESSING OPTIONS
        bCapitalCost = CapitalCost
        bVarialabilityFlow = VarialabilityFlow
        bAccount76 = Account76
        bAccount80 = Account80
        bAccount90 = Account90
        bSSAC = SSAC

        'STORE THE CURRENT YEAR
        iCurrentYear = Integer.Parse(CurrentYear)

        'STORE THE RAILROAD AND YEAR IN THE MAIN TITLE
        sTitle_RR_YEAR = RR_Name & " " & CurrentYear & " Run: " & DateTime.Now.ToString("MM/dd/yyyy hh:mm:ss tt")

    End Sub

    Public Sub Create()

        Try
            UpdateStatus("Started " + sRailRoadShortName + " for " + iCurrentYear.ToString())

            'GET THE TITLES TABLE
            dtTitles = oDB.GetCustomData("REPORT_TITLES")

            'GET THE FOOTNOTES TABLE
            dtFootnotes = oDB.GetCustomData("REPORT_FOOTNOTES")

            'GET THE aValueS FOR OUR RR_ID
            dtAValue = oDB.GetAValue(iRailroadNumber)

            'GET THE aValueS FOR THE 0 ID RR
            dtAValue0_RR = oDB.GetAValue0_RR()

            'GET THE aValueS FOR THE REGION ID RR
            dtAValueRegion_RR = oDB.GetAValueRegion_RR(iRailroadNumber)

            'GET THE U_PRICE_INDEX
            dtPriceIndexes = oDB.GetPriceIndexes(iRailroadNumber, iCurrentYear.ToString())

            'GET THE U_PRICE_INDEX_REFERENCE
            dtPriceIndexReferences = oDB.GetCustomData("PRICE_INDEX_REFERENCE")

            'GET THE U_REGR
            dtRegression = oDB.GetCustomData("REGR")

            'GET THE U_REGR_DEP_VAR
            dtRegressionDependentVariable = oDB.GetCustomData("REGR_DEP_VAR")

            'GET THE U_REGR_DISTRIBUTION
            dtRegressionDistribution = oDB.GetCustomData("REGR_DISTRIB")

            'GET THE URCS_DEFAULTS
            dtDefinitions = oDB.GetCustomData("URCSDEF")

            'GET THE R_OP_STATS_BY_CAR_TYPE
            dtCarTypeStatistics = oDB.GetCarTypeStatistics(iRailroadNumber)

            'GET THE R_OP_STATS_BY_CAR_TYPE_2
            dtCarTypeStatisticsPart2 = oDB.GetCarTypeStatisticsPart2(iRailroadNumber)

            'GET THE R_OP_STATS_BY_CAR_TYPE_3
            dtCarTypeStatisticsPart3 = oDB.GetCarTypeStatisticsPart3()

            'GET LINE SOURCE TEXT
            dtLineSourceText = oDB.GetLineSourceText()

            'GET DATADICTIONARY
            dtDataDictionary = oDB.GetDataDictionary(iCurrentYear)

            'GET ECODES
            dtECodes = oDB.GetEcodes()

            'CREATE A NEW EXCEL OBJECT
            oExcel = New Excel.Application
            oExcel.Visible = False
            oBooks = oExcel.Workbooks
            oBook = oBooks.Add

            'ADD THE CORRECT NUMBER OF WORKSHEETS
            For i As Integer = oBook.Sheets.Count To 147
                oBook.Sheets.Add()
            Next

            oExcel.Calculation = Excel.XlCalculation.xlCalculationManual
            oExcel.ScreenUpdating = False
            oExcel.EnableEvents = False

            'SETUP THE FIRST SHEET
            SHEETONE(1)

            'BUILD A1P1
            A1P1(2)

            'BUILD A1P2A
            A1P2A(3)

            'BUILD A1P2B
            A1P2B(4)

            'BUILD A1P2C
            A1P2C(5)

            'BUILD A1P3A
            A1P3A(6)

            'BUILD A1P3B
            A1P3B(7)

            'BUILD A1P4
            A1P4(8)

            'BUILD A1P5A
            A1P5A(9)

            'BUILD A1P5B
            A1P5B(10)

            'BUILD A1P6
            A1P6(11)

            'BUILD A1P7
            A1P7(12)

            'BUILD A1P8
            A1P8(13)

            'BUILD A1P9
            A1P9(14)

            'BUILD A2P1
            A2P1(15)

            'BUILD A2P2
            A2P2(16)

            'BUILD A2P3
            A2P3(17)

            'BUILD A2P4
            A2P4(18)

            'BUILD A3P1
            A3P1(19)

            'BUILD A3P2
            A3P2(20)

            'BUILD A3P3
            A3P3(21)

            'BUILD A3P4
            A3P4(22)

            'BUILD A3P5
            A3P5(23)

            'BUILD A3P6
            A3P6(24)

            'BUILD A3P7
            A3P7(25)

            'BUILD A3P8
            A3P8(26)

            'BUILD A4P1
            A4P1(27)

            'BUILD A4P2
            A4P2(28)

            'BUILD A4P3
            A4P3(29)

            'BUILD B1P1
            B1P1(30)

            'BUILD B2P1
            B2P1(31)

            'BUILD B2P2
            B2P2(32)

            'BUILD B2P3
            B2P3(33)

            'BUILD B2P4
            B2P4(34)

            'BUILD B2P5
            B2P5(35)

            'BUILD B2P6
            B2P6(36)

            'BUILD B2P8
            B2P8(37)

            'BUILD B2P9
            B2P9(38)

            'BUILD B3P1
            B3P1(39)

            'BUILD B3P1A
            B3P1A(40)

            'BUILD B3P1B
            B3P1B(41)

            'BUILD B3P1C
            B3P1C(42)

            'BUILD B3P1D
            B3P1D(43)

            'BUILD B3P2
            B3P2(44)

            'BUILD B3P3
            B3P3(45)

            'BUILD B3P4
            B3P4(46)

            'BUILD B3P5
            B3P5(47)

            'BUILD B3P6
            B3P6(48)

            'BUILD B3P7
            B3P7(49)

            'BUILD B3P8
            B3P8(50)

            'BUILD B5P3
            B5P3(51)

            'BUILD B5P4
            B5P4(52)

            'BUILD B5P5
            B5P5(53)

            'BUILD B5P6
            B5P6(54)

            'BUILD B5P7
            B5P7(55)

            'BUILD B6P1
            B6P1(56)

            'BUILD B6P2A
            B6P2A(57)

            'BUILD B6P2B
            B6P2B(58)

            'BUILD B6P2C
            B6P2C(59)

            'BUILD B6P2D
            B6P2D(60)

            'BUILD B6P2E
            B6P2E(61)

            'BUILD B6P3
            B6P3(62)

            'BUILD B7P1
            B7P1(63)

            'BUILD B7P2
            B7P2(64)

            'BUILD B7P3
            B7P3(65)

            'BUILD B7P4
            B7P4(66)

            'BUILD B7P5
            B7P5(67)

            'BUILD B7P6
            B7P6(68)

            'BUILD B7P7
            B7P7(69)

            'BUILD B7P8
            B7P8(70)

            'BUILD B8P1
            B8P1(71)

            'BUILD B9P1
            B9P1(72)

            'BUILD B9P2
            B9P2(73)

            'BUILD B9P3
            B9P3(74)

            'BUILD B9P4
            B9P4(75)

            'BUILD B9P5
            B9P5(76)

            'BUILD C
            C(77)

            'BUILD C SUMMARY
            CSummary(92)

            'BUILD D1P1
            D1P1(93)

            'BUILD D1P2
            D1P2(94)

            'BUILD(D2P1)
            D2P1(95)

            'BUILD D2P2
            D2P2(96)

            'BUILD D3P1
            D3P1(97)

            'BUILD(D3P2)
            D3P2(98)

            'BUILD D4P1
            D4P1(99)

            'BUILD D4P2
            D4P2(100)

            'BUILD D5P1
            D5P1(101)

            'BUILD D6P1
            D6P1(102)

            'BUILD D6P1A
            D6P1A_P17(103, "1A")

            'BUILD D6P2
            D6P1A_P17(104, "2")

            'BUILD D6P3
            D6P1A_P17(105, "3")

            'BUILD D6P4
            D6P1A_P17(106, "4")

            'BUILD D6P5
            D6P1A_P17(107, "5")

            'BUILD D6P6
            D6P1A_P17(108, "6")

            'BUILD D6P7
            D6P1A_P17(109, "7")

            'BUILD D6P8
            D6P1A_P17(110, "8")

            'BUILD D6P9
            D6P1A_P17(111, "9")

            'BUILD D6P10
            D6P1A_P17(112, "10")

            'BUILD D6P11
            D6P1A_P17(113, "11")

            'BUILD D6P12
            D6P1A_P17(114, "12")

            'BUILD D6P13
            D6P1A_P17(115, "13")

            'BUILD D6P14
            D6P1A_P17(116, "14")

            'BUILD D6P15
            D6P1A_P17(117, "15")

            'BUILD D6P16
            D6P1A_P17(118, "16")

            'BUILD D6P17
            D6P1A_P17(119, "17")

            'BUILD D6P18
            D6P18(120)

            'BUILD D6P19
            D6P19(121)

            'BUILD D7P1
            D7P1(122)

            'BUILD D7P2
            D7P2(123)

            'BUILD D7P3
            D7P3(124)

            'BUILD D7P4
            D7P4(125)

            'BUILD D7P5
            D7P5(126)

            'BUILD D7P6
            D7P6(127)

            'BUILD D7P7A
            D7P7A(128)

            'BUILD D7P7B
            D7P7B(129)

            'BUILD D7P7C
            D7P7C(130)

            'BUILD D7P8
            D7P8(131)

            'BUILD D7P9
            D7P9(132)

            'BUILD D7P10
            D7P10(133)

            'BUILD D7P11
            D7P11(134)

            'BUILD D7P12
            D7P12(135)

            'BUILD D7P13
            D7P13(136)

            'BUILD D8P1
            D8P1(137)

            'BUILD D8P2
            D8P2(138)

            'BUILD D8P4
            D8P4(139)

            'BUILD D8P6
            D8P6(140)

            'BUILD D8P7A
            D8P7A(141)

            'BUILD D8P7B
            D8P7B(142)

            'BUILD E1P1
            E1P1(143)

            'BUILD E1P2
            E1P2(144)

            'BUILD E1P3
            E1P3(145)

            'BUILD E2P1
            E2P1(146)

            'BUILD E2P2
            E2P2(147)

            'BUILD E Summary
            ESummary(148)

            'OFFER SAVE/DOWNLOAD FILE
            oExcel.Calculation = Excel.XlCalculation.xlCalculationManual
            oExcel.DisplayAlerts = False
            oBook.SaveAs(sFileName)
            oExcel.DisplayAlerts = True
            oExcel.Quit()
            oExcel = Nothing

            UpdateStatus("Finished " + sRailRoadShortName + " for " + iCurrentYear.ToString(), True)

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "CreateExcelSpreadsheet_AValues")

        End Try

    End Sub

    Public Sub SHEETONE(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "User Inputs and Index"
            sSheetTitle = "INDEX"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'WRITE OUT TITLES
            oRange = oXLWsheet.Cells

            oRange.Font.Name = "Consolas"
            oRange.Font.Size = 10
            oRange(1, 1) = sTitle_RR_YEAR
            oTempRange = oRange(1, 1)
            oTempRange.Font.Italic = True

            oRange(2, 1) = sTitle_WORKTABLE
            oTempRange = oRange(2, 1)
            oTempRange.Font.Bold = True
            oTempRange.Font.Size = 12

            'USER INPUT TABLE
            oRange(4, 1) = "User Input values:"
            oTempRange = oRange(2, 1)
            oTempRange.ColumnWidth = 33
            oTempRange.Font.Bold = True
            oTempRange.Font.Size = 12

            oTempRange = oXLWsheet.Range("A4:B4")
            oTempRange.Borders.LineStyle = Excel.XlLineStyle.xlContinuous
            oTempRange.Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlDouble
            oTempRange.MergeCells = True

            oRange(5, 1) = "RRICC:"
            oRange(5, 2) = iRRICC.ToString()
            oTempRange = oRange(5, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "RRICC"

            oRange(6, 1) = "Railroad Short Name:"
            oRange(6, 2) = sRailRoadShortName
            oTempRange = oRange(6, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "RR_SHORT_NAME"

            oRange(7, 1) = "Railroad Name:"
            oRange(7, 2) = sRailRoadName.ToString()
            oTempRange = oRange(7, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "RR_NAME"

            oRange(8, 1) = "Railroad ID:"
            oRange(8, 2) = iRailroadNumber.ToString()
            oTempRange = oRange(8, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "RR_ID"

            oRange(9, 1) = "Current Year:"
            oRange(9, 2) = iCurrentYear.ToString()
            oTempRange = oRange(9, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "CURRENT_YEAR"

            oRange(10, 1) = "Run Years:"
            oRange(10, 2) = iRunYears.ToString()
            oTempRange = oRange(10, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "RUN_YEARS"

            oRange(11, 1) = "Embedded Cost of Capital for ROI:"
            oRange(11, 2) = IIf(bCapitalCost, "Y", "N")
            oTempRange = oRange(11, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "EMBEDDED_COC"

            oRange(12, 1) = "100% Variability Flow Thru:"
            oRange(12, 2) = IIf(bVarialabilityFlow, "Y", "N")
            oTempRange = oRange(12, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "FLOW_THRU_100PCT"

            oRange(13, 1) = "Include Account 76:"
            oRange(13, 2) = IIf(bAccount76, "Y", "N")
            oTempRange = oRange(13, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "INCL_ACCT_76"

            oRange(14, 1) = "Include Account 80:"
            oRange(14, 2) = IIf(bAccount80, "Y", "N")
            oTempRange = oRange(14, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "INCL_ACCT_80"

            oRange(15, 1) = "Include Account 90:"
            oRange(15, 2) = IIf(bAccount90, "Y", "N")
            oTempRange = oRange(15, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "INCL_ACCT_90"

            oRange(16, 1) = "SSAC:"
            oRange(16, 2) = IIf(bSSAC, "Y", "N")
            oTempRange = oRange(16, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "SSAC"

            oRange(17, 1) = "Replace Null Values With:"
            oRange(17, 2) = sNullValueString.ToString()
            oTempRange = oRange(17, 2)
            oTempRange.ColumnWidth = 20
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            oTempRange.Name = "NULL_VALUE"

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P1")

        End Try
    End Sub

    Public Sub A1P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 1"
            iColumnCount = 21
            sSheetTitle = "A1P1"
            iLineNumberOffset = 93

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"


            'GET OUR SHEET
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES FOR ALL LINES BUT 158
            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)
                If draValues("aLine") <> 158 Then
                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = (iCurrentYear - 1) Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = (iCurrentYear - 2) Then
                        oRange(iROW_COUNT, 9) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C3"
                    ElseIf iProcessYear = (iCurrentYear - 3) Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = (iCurrentYear - 4) Then
                        oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    End If

                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.Name = sNamedRange
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE HARD VALUES FROM AVALUES FOR LINE 158
            For Each draValues As DataRow In dtaValue0_RR.Select(sSelectStringRows)
                If draValues("aLine") = 158 Then
                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = (iCurrentYear - 1) Then
                        oRange(iROW_COUNT, 7) = "0"
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = (iCurrentYear - 2) Then
                        oRange(iROW_COUNT, 9) = "0"
                        oTempRange = oRange(iROW_COUNT, 9)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C3"
                    ElseIf iProcessYear = (iCurrentYear - 3) Then
                        oRange(iROW_COUNT, 11) = "0"
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = (iCurrentYear - 4) Then
                        oRange(iROW_COUNT, 13) = "0"
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    End If

                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.Name = sNamedRange
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())

                'C6 - C9 Values
                oRange(iLine, 15) = IIf(drSource("Line") = 158, "0", drSource("C6").ToString())
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = IIf(drSource("Line") = 158, "0", drSource("C7").ToString())
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = IIf(drSource("Line") = 158, "0", drSource("C8").ToString())
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = IIf(drSource("Line") = 158, "0", drSource("C9").ToString())
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0"

                'Random Values that are not from the Data Dictionary
                If Integer.Parse(drSource("Line")) = 111 Or Integer.Parse(drSource("Line")) = 122 Or Integer.Parse(drSource("Line")) = 131 Or
                    Integer.Parse(drSource("Line")) = 133 Or Integer.Parse(drSource("Line")) = 137 Or Integer.Parse(drSource("Line")) = 144 Or
                    Integer.Parse(drSource("Line")) = 145 Or Integer.Parse(drSource("Line")) = 146 Or Integer.Parse(drSource("Line")) = 151 Or
                    Integer.Parse(drSource("Line")) = 154 Or Integer.Parse(drSource("Line")) = 155 Then

                    oRange(iLine, 5) = drSource("C1").ToString()
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 9) = drSource("C3").ToString()
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = drSource("C5").ToString()
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"
                    oTempRange.NumberFormat = "#,##0"

                End If

            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P1")

        End Try
    End Sub

    Public Sub A1P2A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE
            sTitle_WORKTABLE = "WORKTABLE A1 PART 2A"
            iColumnCount = 57
            sSheetTitle = "A1P2A"
            iLineNumberOffset = 193

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aCode_id")) Mod 2 = 0 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 17) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C7"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C10"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 29)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C13"
                    End If
                Else
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C8"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C11"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C14"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.Name = sNamedRange
                oTempRange.NumberFormat = "#,##0"

            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())

                'Derived Values
                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "#,##0"

            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2A")

        End Try
    End Sub

    Public Sub A1P2B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 2B"
            iColumnCount = 57
            sSheetTitle = "A1P2B"
            iLineNumberOffset = 209

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aCode_id")) Mod 2 = 0 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 17) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C7"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C10"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 29)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C13"
                    End If
                Else
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C8"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C11"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C14"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.Name = sNamedRange
                oTempRange.NumberFormat = "#,##0"

            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())

                'Derived Values
                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "#,##0"

                'Random Values that are not from the Data Dictionary
                If Integer.Parse(drSource("Line")) = 234 Then

                    oRange(iLine, 5) = drSource("C1").ToString()
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = drSource("C5").ToString()
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = drSource("C7").ToString()
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C7"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = drSource("C13").ToString()
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C13"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                End If

            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2B")

        End Try
    End Sub

    Public Sub A1P2C(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 2C"
            iColumnCount = 57
            iWorkTableColumnCount = 27
            sSheetTitle = "A1P2C"
            iLineNumberOffset = 228
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'NO VALUES FROM DATA DICTIONARY

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            Dim iCol As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                iCol = 4

                For i As Integer = 4 To iWorkTableColumnCount + 3

                    oRange(iLine, iCol) = "'" & scrubYear(drSource(i))

                    oRange(iLine, (iCol + 1)) = drSource(i)
                    oTempRange = oRange(iLine, (iCol + 1))
                    sNamedRange = sNamedRangePrefix & (iLine + iLineNumberOffset).ToString() + drSource.Table.Columns(i).ColumnName
                    oTempRange.Name = sNamedRange
                    oTempRange.NumberFormat = "#,##0"

                    iCol = iCol + 2

                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2C")

        End Try
    End Sub

    Public Sub A1P3A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 3A"
            iColumnCount = 41
            iWorkTableColumnCount = 19
            sSheetTitle = "A1P3A"
            iLineNumberOffset = 293
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aCode_id")) Mod 2 = 0 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 17) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C7"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C10"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 29)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C13"
                    End If
                Else
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C8"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C11"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C14"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.Name = sNamedRange
                oTempRange.NumberFormat = "#,##0"

            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "#,##0"

                If Integer.Parse(drSource("Line")) = 304 Or Integer.Parse(drSource("Line")) = 308 Or Integer.Parse(drSource("Line")) = 312 Or Integer.Parse(drSource("Line")) = 323 Or Integer.Parse(drSource("Line")) = 324 Then

                    oRange(iLine, 5) = drSource("C1").ToString()
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = drSource("C5").ToString()
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = drSource("C7").ToString()
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C7"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = drSource("C13").ToString()
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C13"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2B")

        End Try
    End Sub

    Public Sub A1P3B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 3B"
            iColumnCount = 41
            iWorkTableColumnCount = 19
            sSheetTitle = "A1P3B"
            iLineNumberOffset = 333
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aCode_id")) Mod 2 = 0 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 17) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C7"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C10"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 29)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C13"
                    End If
                Else
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C5"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C8"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C11"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C14"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.Name = sNamedRange
                oTempRange.NumberFormat = "#,##0"

            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "#,##0"

                If Integer.Parse(drSource("Line")) = 344 Or Integer.Parse(drSource("Line")) = 348 Or Integer.Parse(drSource("Line")) = 352 Or Integer.Parse(drSource("Line")) = 363 Or Integer.Parse(drSource("Line")) = 364 Then

                    oRange(iLine, 5) = drSource("C1").ToString()
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = drSource("C5").ToString()
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = drSource("C7").ToString()
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C7"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = drSource("C13").ToString()
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C13"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2B")

        End Try
    End Sub

    Public Sub A1P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 4"
            iColumnCount = 9
            iWorkTableColumnCount = 3
            sSheetTitle = "A1P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""

            For Each draValue0_RR As DataRow In dtaValue0_RR.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValue0_RR("Year"))
                iROW_COUNT = Integer.Parse(draValue0_RR("aLine")) - iLineNumberOffset

                If iProcessYear = iCurrentYear Then
                    If Integer.Parse(draValue0_RR("aCode_id")) Mod 2 = 0 Then
                        oRange(iROW_COUNT, 5) = draValue0_RR("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValue0_RR("aLine").ToString() & "C1"
                    Else
                        oRange(iROW_COUNT, 7) = draValue0_RR("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValue0_RR("aLine").ToString() & "C2"
                    End If

                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.Name = sNamedRange
                    oTempRange.NumberFormat = "#,##0"

                End If

            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"

                If Integer.Parse(drSource("Line")) = 406 Or Integer.Parse(drSource("Line")) = 426 Or Integer.Parse(drSource("Line")) = 431 Or Integer.Parse(drSource("Line")) = 439 Or Integer.Parse(drSource("Line")) = 445 Or Integer.Parse(drSource("Line")) = 449 Or Integer.Parse(drSource("Line")) = 453 Or Integer.Parse(drSource("Line")) = 457 Or Integer.Parse(drSource("Line")) = 460 Or Integer.Parse(drSource("Line")) = 465 Or Integer.Parse(drSource("Line")) = 470 Or Integer.Parse(drSource("Line")) = 475 Or Integer.Parse(drSource("Line")) = 480 Then

                    oRange(iLine, 5) = drSource("C1").ToString()
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                End If

            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P2B")

        End Try
    End Sub

    Public Sub A1P5A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 5A"
            iColumnCount = 25
            iWorkTableColumnCount = 11
            sSheetTitle = "A1P5A"
            iLineNumberOffset = 493
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM R_OP_STATS_BY_CAR_TYPE
            For Each drCarTypeStatistics As DataRow In dtCarTypeStatistics.Rows
                iROW_COUNT = Integer.Parse(drCarTypeStatistics("Line")) - iLineNumberOffset

                oRange(iROW_COUNT, 5) = drCarTypeStatistics("C1").ToString()
                oTempRange = oRange(iROW_COUNT, 5)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C1"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 7) = drCarTypeStatistics("C2").ToString()
                oTempRange = oRange(iROW_COUNT, 7)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C2"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 9) = drCarTypeStatistics("C3").ToString()
                oTempRange = oRange(iROW_COUNT, 9)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C3"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 13) = drCarTypeStatistics("C5").ToString()
                oTempRange = oRange(iROW_COUNT, 13)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C5"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 15) = drCarTypeStatistics("C6").ToString()
                oTempRange = oRange(iROW_COUNT, 15)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C6"

                oRange(iROW_COUNT, 17) = drCarTypeStatistics("C7").ToString()
                oTempRange = oRange(iROW_COUNT, 17)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C7"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 19) = drCarTypeStatistics("C8").ToString()
                oTempRange = oRange(iROW_COUNT, 19)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 21) = drCarTypeStatistics("C9").ToString()
                oTempRange = oRange(iROW_COUNT, 21)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 23) = drCarTypeStatistics("C10").ToString()
                oTempRange = oRange(iROW_COUNT, 23)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C10"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iROW_COUNT, 25) = drCarTypeStatistics("C11").ToString()
                oTempRange = oRange(iROW_COUNT, 25)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C11"
                oTempRange.NumberFormat = "#,##0.#####"
            Next

            'WRITE HARD VALUES FROM AVALUES REGION VALUES
            Dim iLine As Integer
            For Each draValueRegion As DataRow In dtaValueRegion_RR.Select(sSelectStringRows)

                iLine = Integer.Parse(draValueRegion("aLine"))
                If draValueRegion("Year") = iCurrentYear And draValueRegion("Code") = "C4" Then
                    iROW_COUNT = iLine - iLineNumberOffset

                    oRange(iROW_COUNT, 11) = draValueRegion("Value").ToString()
                    oTempRange = oRange(iROW_COUNT, 11)
                    oTempRange.Name = "A1L" & draValueRegion("aLine").ToString() & "C4"
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P5A")

        End Try
    End Sub

    Public Sub A1P5B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 5B"
            iColumnCount = 31
            iWorkTableColumnCount = 14
            sSheetTitle = "A1P5B"
            iLineNumberOffset = 513
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM R_OP_STATS_BY_CAR_TYPE_2
            For Each drCarTypeStatistics As DataRow In dtCarTypeStatisticsPart2.Rows
                iROW_COUNT = Integer.Parse(drCarTypeStatistics("Line")) - iLineNumberOffset

                oRange(iROW_COUNT, 5) = drCarTypeStatistics("C1").ToString()
                oTempRange = oRange(iROW_COUNT, 5)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C1"

                oRange(iROW_COUNT, 7) = drCarTypeStatistics("C2").ToString()
                oTempRange = oRange(iROW_COUNT, 7)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C2"

                oRange(iROW_COUNT, 9) = drCarTypeStatistics("C3").ToString()
                oTempRange = oRange(iROW_COUNT, 9)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C3"

                oRange(iROW_COUNT, 11) = drCarTypeStatistics("C4").ToString()
                oTempRange = oRange(iROW_COUNT, 11)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C4"

                oRange(iROW_COUNT, 13) = drCarTypeStatistics("C5").ToString()
                oTempRange = oRange(iROW_COUNT, 13)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C5"

                oRange(iROW_COUNT, 15) = drCarTypeStatistics("C6").ToString()
                oTempRange = oRange(iROW_COUNT, 15)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C6"

                oRange(iROW_COUNT, 17) = drCarTypeStatistics("C7").ToString()
                oTempRange = oRange(iROW_COUNT, 17)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C7"

                oRange(iROW_COUNT, 19) = drCarTypeStatistics("C8").ToString()
                oTempRange = oRange(iROW_COUNT, 19)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C8"

                oRange(iROW_COUNT, 21) = drCarTypeStatistics("C9").ToString()
                oTempRange = oRange(iROW_COUNT, 21)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C9"

                oRange(iROW_COUNT, 23) = drCarTypeStatistics("C10").ToString()
                oTempRange = oRange(iROW_COUNT, 23)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C10"

                oRange(iROW_COUNT, 25) = drCarTypeStatistics("C11").ToString()
                oTempRange = oRange(iROW_COUNT, 25)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C11"

                oRange(iROW_COUNT, 27) = drCarTypeStatistics("C12").ToString()
                oTempRange = oRange(iROW_COUNT, 27)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C12"

                oRange(iROW_COUNT, 29) = drCarTypeStatistics("C13").ToString()
                oTempRange = oRange(iROW_COUNT, 29)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C13"

                oRange(iROW_COUNT, 31) = drCarTypeStatistics("C14").ToString()
                oTempRange = oRange(iROW_COUNT, 31)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C14"
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P5B")

        End Try
    End Sub

    Public Sub A1P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 6"
            iColumnCount = 165
            iWorkTableColumnCount = 81
            sSheetTitle = "A1P6"
            iLineNumberOffset = 533
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""
            Dim iCodeOffset As Integer = 738

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                Dim iLineAdjustment = (Integer.Parse(draValues("aLine")) - iLineNumberOffset - 8)
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aCode_id")) = iCodeOffset + iLineAdjustment * 4 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C1"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C10"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 41) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 41)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C19"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 59) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 59)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C28"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 77) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 77)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C37"
                    End If
                ElseIf Integer.Parse(draValues("aCode_id")) = iCodeOffset + iLineAdjustment * 4 + 1 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C2"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C11"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 43)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C20"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 61) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 61)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C29"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 79) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 79)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C38"
                    End If
                ElseIf Integer.Parse(draValues("aCode_id")) = iCodeOffset + iLineAdjustment * 4 + 2 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 9) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C3"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 27) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 27)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C12"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 45) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 45)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C21"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 63) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C30"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 81) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 81)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C39"
                    End If
                Else
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C4"
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 29)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C13"
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 47) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 47)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C22"
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 65) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 65)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C31"
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 83) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 83)
                        sNamedRange = "A1L" & draValues("aLine").ToString() & "C40"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.Name = sNamedRange
                'oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())
                oRange(iLine, 94) = "'" & scrubYear(drSource("C46").ToString())
                oRange(iLine, 96) = "'" & scrubYear(drSource("C47").ToString())
                oRange(iLine, 98) = "'" & scrubYear(drSource("C48").ToString())
                oRange(iLine, 100) = "'" & scrubYear(drSource("C49").ToString())
                oRange(iLine, 102) = "'" & scrubYear(drSource("C50").ToString())
                oRange(iLine, 104) = "'" & scrubYear(drSource("C51").ToString())
                oRange(iLine, 106) = "'" & scrubYear(drSource("C52").ToString())
                oRange(iLine, 108) = "'" & scrubYear(drSource("C53").ToString())
                oRange(iLine, 110) = "'" & scrubYear(drSource("C54").ToString())
                oRange(iLine, 112) = "'" & scrubYear(drSource("C55").ToString())
                oRange(iLine, 114) = "'" & scrubYear(drSource("C56").ToString())
                oRange(iLine, 116) = "'" & scrubYear(drSource("C57").ToString())
                oRange(iLine, 118) = "'" & scrubYear(drSource("C58").ToString())
                oRange(iLine, 120) = "'" & scrubYear(drSource("C59").ToString())
                oRange(iLine, 122) = "'" & scrubYear(drSource("C60").ToString())
                oRange(iLine, 124) = "'" & scrubYear(drSource("C61").ToString())
                oRange(iLine, 126) = "'" & scrubYear(drSource("C62").ToString())
                oRange(iLine, 128) = "'" & scrubYear(drSource("C63").ToString())
                oRange(iLine, 130) = "'" & scrubYear(drSource("C64").ToString())
                oRange(iLine, 132) = "'" & scrubYear(drSource("C65").ToString())
                oRange(iLine, 134) = "'" & scrubYear(drSource("C66").ToString())
                oRange(iLine, 136) = "'" & scrubYear(drSource("C67").ToString())
                oRange(iLine, 138) = "'" & scrubYear(drSource("C68").ToString())
                oRange(iLine, 140) = "'" & scrubYear(drSource("C69").ToString())
                oRange(iLine, 142) = "'" & scrubYear(drSource("C70").ToString())
                oRange(iLine, 144) = "'" & scrubYear(drSource("C71").ToString())
                oRange(iLine, 146) = "'" & scrubYear(drSource("C72").ToString())
                oRange(iLine, 148) = "'" & scrubYear(drSource("C73").ToString())
                oRange(iLine, 150) = "'" & scrubYear(drSource("C74").ToString())
                oRange(iLine, 152) = "'" & scrubYear(drSource("C75").ToString())
                oRange(iLine, 154) = "'" & scrubYear(drSource("C76").ToString())
                oRange(iLine, 156) = "'" & scrubYear(drSource("C77").ToString())
                oRange(iLine, 158) = "'" & scrubYear(drSource("C78").ToString())
                oRange(iLine, 160) = "'" & scrubYear(drSource("C79").ToString())
                oRange(iLine, 162) = "'" & scrubYear(drSource("C80").ToString())
                oRange(iLine, 164) = "'" & scrubYear(drSource("C81").ToString())

                'Derived Values
                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C6"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C7"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C14"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C15"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C16"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C23"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C24"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C25"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C32"

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C33"

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C34"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C41"

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C42"

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C43"

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C44"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 95) = drSource("C46").ToString()
                oTempRange = oRange(iLine, 95)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C46"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 97) = drSource("C47").ToString()
                oTempRange = oRange(iLine, 97)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C47"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 99) = drSource("C48").ToString()
                oTempRange = oRange(iLine, 99)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C48"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 101) = drSource("C49").ToString()
                oTempRange = oRange(iLine, 101)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C49"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 103) = drSource("C50").ToString()
                oTempRange = oRange(iLine, 103)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C50"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 105) = drSource("C51").ToString()
                oTempRange = oRange(iLine, 105)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C51"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 107) = drSource("C52").ToString()
                oTempRange = oRange(iLine, 107)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C52"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 109) = drSource("C53").ToString()
                oTempRange = oRange(iLine, 109)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C53"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 111) = drSource("C54").ToString()
                oTempRange = oRange(iLine, 111)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C54"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 113) = drSource("C55").ToString()
                oTempRange = oRange(iLine, 113)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C55"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 115) = drSource("C56").ToString()
                oTempRange = oRange(iLine, 115)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C56"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 117) = drSource("C57").ToString()
                oTempRange = oRange(iLine, 117)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C57"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 119) = drSource("C58").ToString()
                oTempRange = oRange(iLine, 119)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C58"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 121) = drSource("C59").ToString()
                oTempRange = oRange(iLine, 121)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C59"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 123) = drSource("C60").ToString()
                oTempRange = oRange(iLine, 123)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C60"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 125) = drSource("C61").ToString()
                oTempRange = oRange(iLine, 125)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C61"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 127) = drSource("C62").ToString()
                oTempRange = oRange(iLine, 127)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C62"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 129) = drSource("C63").ToString()
                oTempRange = oRange(iLine, 129)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C63"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 131) = drSource("C64").ToString()
                oTempRange = oRange(iLine, 131)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C64"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 133) = drSource("C65").ToString()
                oTempRange = oRange(iLine, 133)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C65"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 135) = drSource("C66").ToString()
                oTempRange = oRange(iLine, 135)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C66"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 137) = drSource("C67").ToString()
                oTempRange = oRange(iLine, 137)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C67"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 139) = drSource("C68").ToString()
                oTempRange = oRange(iLine, 139)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C68"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 141) = drSource("C69").ToString()
                oTempRange = oRange(iLine, 141)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C69"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 143) = drSource("C70").ToString()
                oTempRange = oRange(iLine, 143)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C70"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 145) = drSource("C71").ToString()
                oTempRange = oRange(iLine, 145)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C71"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 147) = drSource("C72").ToString()
                oTempRange = oRange(iLine, 147)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C72"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 149) = drSource("C73").ToString()
                oTempRange = oRange(iLine, 149)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C73"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 151) = drSource("C74").ToString()
                oTempRange = oRange(iLine, 151)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C74"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 153) = drSource("C75").ToString()
                oTempRange = oRange(iLine, 153)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C75"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 155) = drSource("C76").ToString()
                oTempRange = oRange(iLine, 155)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C76"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 157) = drSource("C77").ToString()
                oTempRange = oRange(iLine, 157)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C77"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 159) = drSource("C78").ToString()
                oTempRange = oRange(iLine, 159)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C78"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 161) = drSource("C79").ToString()
                oTempRange = oRange(iLine, 161)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C79"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 163) = drSource("C80").ToString()
                oTempRange = oRange(iLine, 163)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C80"
                oTempRange.NumberFormat = "#,##0.#####"

                oRange(iLine, 165) = drSource("C81").ToString()
                oTempRange = oRange(iLine, 165)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C81"
                oTempRange.NumberFormat = "#,##0.#####"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P6")

        End Try
    End Sub

    Public Sub A1P7(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 7"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "A1P7"
            iLineNumberOffset = 553
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM R_OP_STATS_BY_CAR_TYPE_3
            For Each drCarTypeStatistics As DataRow In dtCarTypeStatisticsPart3.Rows
                iROW_COUNT = Integer.Parse(drCarTypeStatistics("Line")) - iLineNumberOffset

                oRange(iROW_COUNT, 5) = drCarTypeStatistics("C1").ToString()
                oTempRange = oRange(iROW_COUNT, 5)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C1"

                oRange(iROW_COUNT, 7) = drCarTypeStatistics("C2").ToString()
                oTempRange = oRange(iROW_COUNT, 7)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C2"

                oRange(iROW_COUNT, 9) = drCarTypeStatistics("C3").ToString()
                oTempRange = oRange(iROW_COUNT, 9)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C3"

                oRange(iROW_COUNT, 11) = drCarTypeStatistics("C4").ToString()
                oTempRange = oRange(iROW_COUNT, 11)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C4"

                oRange(iROW_COUNT, 13) = drCarTypeStatistics("C5").ToString()
                oTempRange = oRange(iROW_COUNT, 13)
                oTempRange.Name = "A1L" & drCarTypeStatistics("Line").ToString() & "C5"
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P7")

        End Try
    End Sub

    Public Sub A1P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 8"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "A1P8"
            iLineNumberOffset = 572
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE VALUES FROM AVALUES (REGION)
            Dim iLine As Integer
            For Each draValueRegion As DataRow In dtaValueRegion_RR.Select(sSelectStringRows)

                iLine = Integer.Parse(draValueRegion("aLine"))
                If draValueRegion("Year") = iCurrentYear And draValueRegion("Code") = "C1" Then
                    iROW_COUNT = iLine - iLineNumberOffset

                    oRange(iROW_COUNT, 5) = draValueRegion("Value").ToString()
                    oTempRange = oRange(iROW_COUNT, 5)
                    oTempRange.Name = "A1L" & draValueRegion("aLine").ToString() & "C1"
                End If
            Next

            'WRITE VALUES FROM aValueS (ALL)
            For Each draValue0_RR As DataRow In dtaValue0_RR.Select(sSelectStringRows)

                iLine = Integer.Parse(draValue0_RR("aLine"))
                If draValue0_RR("Year") = iCurrentYear And
                    (iLine = 584 Or iLine = 585 Or iLine = 586 Or iLine = 587 Or iLine = 595) Then
                    iROW_COUNT = iLine - iLineNumberOffset

                    oRange(iROW_COUNT, 5) = draValue0_RR("Value").ToString()
                    oTempRange = oRange(iROW_COUNT, 5)
                    oTempRange.Name = "A1L" & draValue0_RR("aLine").ToString() & "C1"
                End If
            Next

            'WRITE VALUES FROM AVALUES (RAILROAD)
            For Each draValue As DataRow In dtaValue.Select(sSelectStringRows)

                iLine = Integer.Parse(draValue("aLine"))
                If draValue("Year") = iCurrentYear And iLine = 581 Then
                    iROW_COUNT = iLine - iLineNumberOffset

                    oRange(iROW_COUNT, 5) = draValue("Value").ToString()
                    oTempRange = oRange(iROW_COUNT, 5)
                    oTempRange.Name = "A1L" & draValue("aLine").ToString() & "C1"
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P8")

        End Try
    End Sub

    Public Sub A1P9(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A1 PART 9"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "A1P9"
            iLineNumberOffset = 893
            sNamedRangePrefix = "A1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C1"

                If (iLine > 12 And iLine < 25) Then
                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C2"

                If (iLine > 12 And iLine < 25) Then
                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C3"

                If (iLine > 12 And iLine < 25) Then
                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C4"

                If (iLine > 12 And iLine < 25) Then
                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "A1L" & drSource("Line").ToString() & "C5"

                If (iLine > 12 And iLine < 25) Then
                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 13
                    If i <> 88 Or j = 5 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A1L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A1P9")

        End Try
    End Sub

    Public Sub A2P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A2 PART 1"
            iColumnCount = 91
            iWorkTableColumnCount = 44
            sSheetTitle = "A2P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "A2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim iCodeOffset As Integer
            Dim iRowOffset As Integer

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A2L" + draValues("aLine").ToString() + "'")

                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aLine")) < 142 Then
                    iCodeOffset = 898
                    iRowOffset = 8
                Else
                    iCodeOffset = 1267
                    iRowOffset = 82
                End If

                If iProcessYear = iCurrentYear Then
                    oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                    oTempRange = oRange(iROW_COUNT, 5)
                    oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C1"
                End If

                If (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C2"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 29) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 29)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C13"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 27) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 27)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C12"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 45) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 45)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C21"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 43)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C20"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 61) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 61)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C29"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 59) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 59)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C28"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 77) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 77)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C37"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 75) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 75)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C36"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                            And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 1 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C4"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 33) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 33)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C15"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C14"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 49) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 49)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C23"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 47) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 47)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C22"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 65) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 65)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C31"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 63) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C30"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 81) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 81)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C39"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 79) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 79)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C38"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                            And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 2 Or
                       Integer.Parse(draValues("aCode_id")) = 1162 Or
                       Integer.Parse(draValues("aCode_id")) = 1166 Or
                       Integer.Parse(draValues("aCode_id")) = 1170 Or
                       Integer.Parse(draValues("aCode_id")) = 1174 Or
                       Integer.Parse(draValues("aCode_id")) = 1178 Or
                       Integer.Parse(draValues("aCode_id")) = 1182 Or
                       Integer.Parse(draValues("aCode_id")) = 1186 Or
                       Integer.Parse(draValues("aCode_id")) = 1190 Or
                       Integer.Parse(draValues("aCode_id")) = 1194 Or
                       Integer.Parse(draValues("aCode_id")) = 1198 Or
                       Integer.Parse(draValues("aCode_id")) = 1202 Or
                       Integer.Parse(draValues("aCode_id")) = 1206 Or
                       Integer.Parse(draValues("aCode_id")) = 1210 Or
                       Integer.Parse(draValues("aCode_id")) = 1214 Or
                       Integer.Parse(draValues("aCode_id")) = 1218 Or
                       Integer.Parse(draValues("aCode_id")) = 1222 Or
                       Integer.Parse(draValues("aCode_id")) = 1226 Or
                       Integer.Parse(draValues("aCode_id")) = 1230 Or
                       Integer.Parse(draValues("aCode_id")) = 1243 Or
                       Integer.Parse(draValues("aCode_id")) = 1247 Or
                       Integer.Parse(draValues("aCode_id")) = 1251 Or
                       Integer.Parse(draValues("aCode_id")) = 1255 Or
                       Integer.Parse(draValues("aCode_id")) = 1259 Or
                       Integer.Parse(draValues("aCode_id")) = 1263 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C6"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 37) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 37)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C17"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 35) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 35)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C16"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 53) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 53)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C25"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 51) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 51)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C24"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 69) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 69)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C33"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 67) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 67)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C32"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 85) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 85)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C41"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 83) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 83)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C40"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                            And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 3 Or
                       Integer.Parse(draValues("aCode_id")) = 1144 Or
                       Integer.Parse(draValues("aCode_id")) = 1147 Or
                       Integer.Parse(draValues("aCode_id")) = 1150 Or
                       Integer.Parse(draValues("aCode_id")) = 1153 Or
                       Integer.Parse(draValues("aCode_id")) = 1156 Or
                       Integer.Parse(draValues("aCode_id")) = 1159 Or
                       Integer.Parse(draValues("aCode_id")) = 1234 Or
                       Integer.Parse(draValues("aCode_id")) = 1237 Or
                       Integer.Parse(draValues("aCode_id")) = 1240 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C8"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 41) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 41)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C19"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 39) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 39)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C18"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 57) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 57)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C27"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 55) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 55)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C26"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 73) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 73)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C35"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 71) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 71)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C34"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 89) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 89)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C43"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 87) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 87)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C42"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                            And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 4 Or
                       Integer.Parse(draValues("aCode_id")) = 1145 Or
                       Integer.Parse(draValues("aCode_id")) = 1148 Or
                       Integer.Parse(draValues("aCode_id")) = 1151 Or
                       Integer.Parse(draValues("aCode_id")) = 1154 Or
                       Integer.Parse(draValues("aCode_id")) = 1157 Or
                       Integer.Parse(draValues("aCode_id")) = 1160 Or
                       Integer.Parse(draValues("aCode_id")) = 1164 Or
                       Integer.Parse(draValues("aCode_id")) = 1168 Or
                       Integer.Parse(draValues("aCode_id")) = 1172 Or
                       Integer.Parse(draValues("aCode_id")) = 1176 Or
                       Integer.Parse(draValues("aCode_id")) = 1180 Or
                       Integer.Parse(draValues("aCode_id")) = 1184 Or
                       Integer.Parse(draValues("aCode_id")) = 1188 Or
                       Integer.Parse(draValues("aCode_id")) = 1192 Or
                       Integer.Parse(draValues("aCode_id")) = 1196 Or
                       Integer.Parse(draValues("aCode_id")) = 1200 Or
                       Integer.Parse(draValues("aCode_id")) = 1204 Or
                       Integer.Parse(draValues("aCode_id")) = 1208 Or
                       Integer.Parse(draValues("aCode_id")) = 1212 Or
                       Integer.Parse(draValues("aCode_id")) = 1216 Or
                       Integer.Parse(draValues("aCode_id")) = 1220 Or
                       Integer.Parse(draValues("aCode_id")) = 1224 Or
                       Integer.Parse(draValues("aCode_id")) = 1228 Or
                       Integer.Parse(draValues("aCode_id")) = 1232 Or
                       Integer.Parse(draValues("aCode_id")) = 1235 Or
                       Integer.Parse(draValues("aCode_id")) = 1238 Or
                       Integer.Parse(draValues("aCode_id")) = 1241 Or
                       Integer.Parse(draValues("aCode_id")) = 1245 Or
                       Integer.Parse(draValues("aCode_id")) = 1249 Or
                       Integer.Parse(draValues("aCode_id")) = 1253 Or
                       Integer.Parse(draValues("aCode_id")) = 1257 Or
                       Integer.Parse(draValues("aCode_id")) = 1261 Or
                       Integer.Parse(draValues("aCode_id")) = 1265 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C10"
                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 142 Or Integer.Parse(draValues("aLine")) > 174 And Integer.Parse(draValues("aLine")) < 181) _
                            And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 5 Or
                       Integer.Parse(draValues("aCode_id")) = 1146 Or
                       Integer.Parse(draValues("aCode_id")) = 1149 Or
                       Integer.Parse(draValues("aCode_id")) = 1152 Or
                       Integer.Parse(draValues("aCode_id")) = 1155 Or
                       Integer.Parse(draValues("aCode_id")) = 1158 Or
                       Integer.Parse(draValues("aCode_id")) = 1161 Or
                       Integer.Parse(draValues("aCode_id")) = 1165 Or
                       Integer.Parse(draValues("aCode_id")) = 1169 Or
                       Integer.Parse(draValues("aCode_id")) = 1173 Or
                       Integer.Parse(draValues("aCode_id")) = 1177 Or
                       Integer.Parse(draValues("aCode_id")) = 1181 Or
                       Integer.Parse(draValues("aCode_id")) = 1185 Or
                       Integer.Parse(draValues("aCode_id")) = 1189 Or
                       Integer.Parse(draValues("aCode_id")) = 1193 Or
                       Integer.Parse(draValues("aCode_id")) = 1197 Or
                       Integer.Parse(draValues("aCode_id")) = 1201 Or
                       Integer.Parse(draValues("aCode_id")) = 1205 Or
                       Integer.Parse(draValues("aCode_id")) = 1209 Or
                       Integer.Parse(draValues("aCode_id")) = 1213 Or
                       Integer.Parse(draValues("aCode_id")) = 1217 Or
                       Integer.Parse(draValues("aCode_id")) = 1221 Or
                       Integer.Parse(draValues("aCode_id")) = 1225 Or
                       Integer.Parse(draValues("aCode_id")) = 1229 Or
                       Integer.Parse(draValues("aCode_id")) = 1233 Or
                       Integer.Parse(draValues("aCode_id")) = 1236 Or
                       Integer.Parse(draValues("aCode_id")) = 1239 Or
                       Integer.Parse(draValues("aCode_id")) = 1242 Or
                       Integer.Parse(draValues("aCode_id")) = 1246 Or
                       Integer.Parse(draValues("aCode_id")) = 1250 Or
                       Integer.Parse(draValues("aCode_id")) = 1254 Or
                       Integer.Parse(draValues("aCode_id")) = 1258 Or
                       Integer.Parse(draValues("aCode_id")) = 1262 Or
                       Integer.Parse(draValues("aCode_id")) = 1266 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C11"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            Dim SSAC_Cells() As String = {"A2L166C8", "A2L166C10", "A2L166C11", "A2L166C18", "A2L166C26", "A2L166C34", "A2L166C42",
                                          "A2L167C8", "A2L167C10", "A2L167C11", "A2L167C18", "A2L167C26", "A2L167C34", "A2L167C42",
                                          "A2L168C8", "A2L168C10", "A2L168C11", "A2L168C18", "A2L168C26", "A2L168C34", "A2L168C42",
                                          "A2L175C2", "A2L175C4", "A2L175C6", "A2L175C8", "A2L175C10", "A2L175C11", "A2L175C12", "A2L175C14", "A2L175C16", "A2L175C18", "A2L175C20", "A2L175C22", "A2L175C24", "A2L175C26", "A2L175C28", "A2L175C30", "A2L175C32", "A2L175C34", "A2L175C36", "A2L175C38", "A2L175C40", "A2L175C42",
                                          "A2L176C2", "A2L176C4", "A2L176C6", "A2L176C8", "A2L176C10", "A2L176C11", "A2L176C12", "A2L176C14", "A2L176C16", "A2L176C18", "A2L176C20", "A2L176C22", "A2L176C24", "A2L176C26", "A2L176C28", "A2L176C30", "A2L176C32", "A2L176C34", "A2L176C36", "A2L176C38", "A2L176C40", "A2L176C42",
                                          "A2L177C2", "A2L177C4", "A2L177C6", "A2L177C8", "A2L177C10", "A2L177C11", "A2L177C12", "A2L177C14", "A2L177C16", "A2L177C18", "A2L177C20", "A2L177C22", "A2L177C24", "A2L177C26", "A2L177C28", "A2L177C30", "A2L177C32", "A2L177C34", "A2L177C36", "A2L177C38", "A2L177C40", "A2L177C42"}

            'WRITE RANGE NAMES FOR EMPTY CELLS AND HANDLE SSAC SETTING
            For i As Integer = 8 To 91
                For j As Integer = 5 To 91

                    If i <> 88 Or j = 5 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) Then
                            If IsNothing(oCell.Value2) Then
                                oRange(i, j) = "=NULL_VALUE"
                                oTempRange = oCell
                                oTempRange.Name = "A2L" & (i + iLineNumberOffset).ToString() &
                                                            oCaption.Value.ToString().Replace("(", "").Replace(")", "")
                                'APPLY FORMATTING
                                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                                oTempRange.NumberFormat = "#######0"
                            Else
                                If SSAC_Cells.Contains(oRange(i, j).Name.Name.ToString()) Then
                                    oRange(i, j) = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                                End If
                            End If
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())

                If iLine = 88 Then
                    'Derived Values
                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = drSource("C6").ToString()
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C6"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 27) = drSource("C12").ToString()
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C12"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 33) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 35) = drSource("C16").ToString()
                    oTempRange = oRange(iLine, 35)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C16"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 37) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 39) = drSource("C18").ToString()
                    oTempRange = oRange(iLine, 39)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C18"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 41) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 43) = drSource("C20").ToString()
                    oTempRange = oRange(iLine, 43)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C20"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 45) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 45)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C21"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 47) = drSource("C22").ToString()
                    oTempRange = oRange(iLine, 47)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C22"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 49) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 51) = drSource("C24").ToString()
                    oTempRange = oRange(iLine, 51)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C24"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 53) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 53)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C25"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 55) = drSource("C26").ToString()
                    oTempRange = oRange(iLine, 55)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C26"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 57) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 59) = drSource("C28").ToString()
                    oTempRange = oRange(iLine, 59)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C28"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 61) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 61)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C29"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 63) = drSource("C30").ToString()
                    oTempRange = oRange(iLine, 63)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C30"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 65) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 65)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C31"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 67) = drSource("C32").ToString()
                    oTempRange = oRange(iLine, 67)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C32"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 69) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 69)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C33"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 71) = drSource("C34").ToString()
                    oTempRange = oRange(iLine, 71)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C34"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 73) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 73)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C35"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 75) = drSource("C36").ToString()
                    oTempRange = oRange(iLine, 75)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C36"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 77) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 77)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C37"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 79) = drSource("C38").ToString()
                    oTempRange = oRange(iLine, 79)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C38"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 81) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 81)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C39"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 83) = drSource("C40").ToString()
                    oTempRange = oRange(iLine, 83)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C40"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 85) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 85)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C41"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 87) = drSource("C42").ToString()
                    oTempRange = oRange(iLine, 87)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C42"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 89) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 89)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C43"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())

                    oRange(iLine, 91) = drSource("C44").ToString()
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                Else

                    'Create source for C44
                    Dim sSource As String = GetSourceForA2SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 90) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 91) = sSource
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A2P1")

        End Try
    End Sub

    Private Function GetSourceForA2SummaryColumn(LineNumber As String, CellLineNumber As Integer) As String
        Dim sReturn As String

        Dim oCell As Excel.Range = oRange(CellLineNumber, 5)
        Dim iPeriod As Integer = IIf(Integer.TryParse(oCell.Value2, iPeriod), iPeriod, 0)

        If iPeriod > 0 Then
            sReturn = "=SUM(A2L" + LineNumber + "C10"

            If iPeriod > 1 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A2L", "C12,A2L", "C13),PRODUCT(A2L", "C14,A2L", "C15),PRODUCT(A2L", "C16,A2L", "C17),PRODUCT(A2L", "C18,A2L", "C19)")
            If iPeriod > 2 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A2L", "C20,A2L", "C21),PRODUCT(A2L", "C22,A2L", "C23),PRODUCT(A2L", "C24,A2L", "C25),PRODUCT(A2L", "C26,A2L", "C27)")
            If iPeriod > 3 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A2L", "C28,A2L", "C29),PRODUCT(A2L", "C30,A2L", "C31),PRODUCT(A2L", "C32,A2L", "C33),PRODUCT(A2L", "C34,A2L", "C35)")
            If iPeriod > 4 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A2L", "C36,A2L", "C37),PRODUCT(A2L", "C38,A2L", "C39),PRODUCT(A2L", "C40,A2L", "C41),PRODUCT(A2L", "C42,A2L", "C43)")

            sReturn = sReturn + ")/A2L" + LineNumber + "C1"
        Else
            sReturn = ""
        End If

        Return sReturn

    End Function

    Private Function GetSourceForA3P1SummaryColumn(LineNumber As String, CellLineNumber As Integer) As String
        Dim sReturn As String

        Dim oCell As Excel.Range = oRange(CellLineNumber, 5)
        Dim iPeriod As Integer = IIf(Integer.TryParse(oCell.Value2, iPeriod), iPeriod, 0)

        If iPeriod > 0 Then

            sReturn = "=SUM(PRODUCT(A3L" + LineNumber + "C2,A3L" + LineNumber + "C3)"

            If iPeriod > 1 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C4,A3L", LineNumber, "C5)")
            If iPeriod > 2 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C6,A3L", LineNumber, "C7)")
            If iPeriod > 3 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C8,A3L", LineNumber, "C9)")
            If iPeriod > 4 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C10,A3L", LineNumber, "C11)")

            sReturn = sReturn + ")/A3L" + LineNumber + "C1"
        Else
            sReturn = ""
        End If

        Return sReturn

    End Function

    Private Function GetSourceForA3P2SummaryColumn(LineNumber As String, CellLineNumber As Integer, ColumnNumber As Integer) As String
        Dim sReturn As String

        Dim oCell As Excel.Range = oRange(CellLineNumber, 5)
        Dim iPeriod As Integer = IIf(Integer.TryParse(oCell.Value2, iPeriod), iPeriod, 0)

        If iPeriod > 0 Then

            sReturn = "=SUM(PRODUCT(A3L" + LineNumber + "C2,A3L" + LineNumber + "C" + (ColumnNumber).ToString() + ")"

            If iPeriod > 1 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C9,A3L", LineNumber, "C" + (ColumnNumber + 7).ToString() + ")")
            If iPeriod > 2 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C16,A3L", LineNumber, "C" + (ColumnNumber + 14).ToString() + ")")
            If iPeriod > 3 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C23,A3L", LineNumber, "C" + (ColumnNumber + 21).ToString() + ")")
            If iPeriod > 4 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", LineNumber, "C30,A3L", LineNumber, "C" + (ColumnNumber + 38).ToString() + ")")

            sReturn = sReturn + ")/A3L" + LineNumber + "C1"
        Else
            sReturn = ""
        End If

        Return sReturn

    End Function

    Private Function GetSourceForA3P3toP8SummaryColumn(LineNumber As String, CellLineNumber As Integer) As String
        Dim sReturn As String

        Dim oCell As Excel.Range = oRange(CellLineNumber, 5)
        Dim iPeriod As Integer = IIf(Integer.TryParse(oCell.Value2, iPeriod), iPeriod, 0)

        If iPeriod > 0 Then

            sReturn = "=SUM(PRODUCT(A3L" + LineNumber + "C2,A3L" + LineNumber + "C3)"

            If iPeriod > 1 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", "C4,A3L", "C5)")
            If iPeriod > 2 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", "C6,A3L", "C7)")
            If iPeriod > 3 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", "C8,A3L", "C9)")
            If iPeriod > 4 Then sReturn = sReturn + String.Join(LineNumber, ",PRODUCT(A3L", "C10,A3L", "C11)")

            sReturn = sReturn + ")/A3L" + LineNumber + "C1"
        Else
            sReturn = ""
        End If

        Return sReturn

    End Function

    Public Sub A2P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A2 PART 2"
            iColumnCount = 91
            iWorkTableColumnCount = 44
            sSheetTitle = "A2P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "A2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim sNamedRange As String = ""
            Dim iCodeOffset As Integer
            Dim iRowOffset As Integer

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = draValues("Year")
                Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A2L" + draValues("aLine").ToString() + "'")

                iROW_COUNT = draValues("aLine") - iLineNumberOffset

                If draValues("aLine") < 205 Then
                    iCodeOffset = 1311
                    iRowOffset = 8
                ElseIf draValues("aLine") > 216 And draValues("aLine") < 219 Then
                    iCodeOffset = 1380
                    iRowOffset = 24
                ElseIf draValues("aLine") > 219 And draValues("aLine") < 224 Then
                    iCodeOffset = 1394
                    iRowOffset = 27
                ElseIf draValues("aLine") > 235 And draValues("aLine") < 238 Then
                    iCodeOffset = 1463
                    iRowOffset = 43
                ElseIf draValues("aLine") > 238 And draValues("aLine") < 247 Then
                    iCodeOffset = 1476
                    iRowOffset = 46
                ElseIf draValues("aLine") > 258 And draValues("aLine") < 261 Then
                    iCodeOffset = 1569
                    iRowOffset = 66
                End If

                If draValues("aLine") <> 219 And draValues("aLine") <> 238 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C1"
                    End If
                End If

                If (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                   And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C2"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 29) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 29)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C13"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 27) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 27)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C12"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 45) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 45)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C21"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 43)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C20"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 61) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 61)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C29"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 59) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 59)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C28"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 77) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 77)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C37"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 75) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 75)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C36"

                    End If
                ElseIf (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                           And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 1 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C4"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 33) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 33)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C15"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C14"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 49) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 49)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C23"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 47) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 47)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C22"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 65) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 65)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C31"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 63) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C30"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 81) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 81)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C39"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 79) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 79)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C38"

                    End If
                ElseIf (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                      And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 2 Or
                      draValues("aCode_id") = 1341 Or
                      draValues("aCode_id") = 1345 Or
                      draValues("aCode_id") = 1349 Or
                      draValues("aCode_id") = 1353 Or
                      draValues("aCode_id") = 1357 Or
                      draValues("aCode_id") = 1361 Or
                      draValues("aCode_id") = 1368 Or
                      draValues("aCode_id") = 1372 Or
                      draValues("aCode_id") = 1376 Or
                      draValues("aCode_id") = 1424 Or
                      draValues("aCode_id") = 1428 Or
                      draValues("aCode_id") = 1432 Or
                      draValues("aCode_id") = 1436 Or
                      draValues("aCode_id") = 1440 Or
                      draValues("aCode_id") = 1444 Or
                      draValues("aCode_id") = 1451 Or
                      draValues("aCode_id") = 1455 Or
                      draValues("aCode_id") = 1459 Or
                      draValues("aCode_id") = 1530 Or
                      draValues("aCode_id") = 1534 Or
                      draValues("aCode_id") = 1538 Or
                      draValues("aCode_id") = 1542 Or
                      draValues("aCode_id") = 1546 Or
                      draValues("aCode_id") = 1550 Or
                      draValues("aCode_id") = 1557 Or
                      draValues("aCode_id") = 1561 Or
                      draValues("aCode_id") = 1565 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C6"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 37) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 37)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C17"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 35) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 35)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C16"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 53) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 53)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C25"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 51) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 51)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C24"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 69) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 69)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C33"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 67) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 67)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C32"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 85) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 85)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C41"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 83) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 83)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C40"

                    End If
                ElseIf (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                      And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 3 Or
                      draValues("aCode_id") = 1335 Or
                      draValues("aCode_id") = 1338 Or
                      draValues("aCode_id") = 1342 Or
                      draValues("aCode_id") = 1346 Or
                      draValues("aCode_id") = 1350 Or
                      draValues("aCode_id") = 1354 Or
                      draValues("aCode_id") = 1358 Or
                      draValues("aCode_id") = 1362 Or
                      draValues("aCode_id") = 1365 Or
                      draValues("aCode_id") = 1369 Or
                      draValues("aCode_id") = 1373 Or
                      draValues("aCode_id") = 1377 Or
                      draValues("aCode_id") = 1418 Or
                      draValues("aCode_id") = 1421 Or
                      draValues("aCode_id") = 1425 Or
                      draValues("aCode_id") = 1429 Or
                      draValues("aCode_id") = 1433 Or
                      draValues("aCode_id") = 1437 Or
                      draValues("aCode_id") = 1441 Or
                      draValues("aCode_id") = 1445 Or
                      draValues("aCode_id") = 1448 Or
                      draValues("aCode_id") = 1452 Or
                      draValues("aCode_id") = 1456 Or
                      draValues("aCode_id") = 1460 Or
                      draValues("aCode_id") = 1524 Or
                      draValues("aCode_id") = 1527 Or
                      draValues("aCode_id") = 1531 Or
                      draValues("aCode_id") = 1535 Or
                      draValues("aCode_id") = 1539 Or
                      draValues("aCode_id") = 1543 Or
                      draValues("aCode_id") = 1547 Or
                      draValues("aCode_id") = 1551 Or
                      draValues("aCode_id") = 1554 Or
                      draValues("aCode_id") = 1558 Or
                      draValues("aCode_id") = 1562 Or
                      draValues("aCode_id") = 1566 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C8"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 41) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 41)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C19"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 39) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 39)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C18"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 57) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 57)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C27"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 55) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 55)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C26"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 73) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 73)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C35"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 71) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 71)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C34"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 89) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 89)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C43"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 87) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 87)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C42"

                    End If
                ElseIf (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                      And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 4 Or
                      draValues("aCode_id") = 1336 Or
                      draValues("aCode_id") = 1339 Or
                      draValues("aCode_id") = 1343 Or
                      draValues("aCode_id") = 1347 Or
                      draValues("aCode_id") = 1351 Or
                      draValues("aCode_id") = 1355 Or
                      draValues("aCode_id") = 1359 Or
                      draValues("aCode_id") = 1363 Or
                      draValues("aCode_id") = 1366 Or
                      draValues("aCode_id") = 1370 Or
                      draValues("aCode_id") = 1374 Or
                      draValues("aCode_id") = 1378 Or
                      draValues("aCode_id") = 1419 Or
                      draValues("aCode_id") = 1422 Or
                      draValues("aCode_id") = 1426 Or
                      draValues("aCode_id") = 1430 Or
                      draValues("aCode_id") = 1434 Or
                      draValues("aCode_id") = 1438 Or
                      draValues("aCode_id") = 1442 Or
                      draValues("aCode_id") = 1446 Or
                      draValues("aCode_id") = 1449 Or
                      draValues("aCode_id") = 1453 Or
                      draValues("aCode_id") = 1457 Or
                      draValues("aCode_id") = 1461 Or
                      draValues("aCode_id") = 1525 Or
                      draValues("aCode_id") = 1528 Or
                      draValues("aCode_id") = 1532 Or
                      draValues("aCode_id") = 1536 Or
                      draValues("aCode_id") = 1540 Or
                      draValues("aCode_id") = 1544 Or
                      draValues("aCode_id") = 1548 Or
                      draValues("aCode_id") = 1552 Or
                      draValues("aCode_id") = 1555 Or
                      draValues("aCode_id") = 1559 Or
                      draValues("aCode_id") = 1563 Or
                      draValues("aCode_id") = 1567 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C10"
                    End If
                ElseIf (draValues("aLine") < 205 _
                     Or draValues("aLine") > 216 And draValues("aLine") < 219 _
                     Or draValues("aLine") > 219 And draValues("aLine") < 224 _
                     Or draValues("aLine") > 235 And draValues("aLine") < 238 _
                     Or draValues("aLine") > 238 And draValues("aLine") < 247 _
                     Or draValues("aLine") > 258 And draValues("aLine") < 261) _
                      And draValues("aCode_id") = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 5 Or
                      draValues("aCode_id") = 1337 Or
                      draValues("aCode_id") = 1340 Or
                      draValues("aCode_id") = 1344 Or
                      draValues("aCode_id") = 1348 Or
                      draValues("aCode_id") = 1352 Or
                      draValues("aCode_id") = 1356 Or
                      draValues("aCode_id") = 1360 Or
                      draValues("aCode_id") = 1364 Or
                      draValues("aCode_id") = 1367 Or
                      draValues("aCode_id") = 1371 Or
                      draValues("aCode_id") = 1375 Or
                      draValues("aCode_id") = 1379 Or
                      draValues("aCode_id") = 1420 Or
                      draValues("aCode_id") = 1423 Or
                      draValues("aCode_id") = 1427 Or
                      draValues("aCode_id") = 1431 Or
                      draValues("aCode_id") = 1435 Or
                      draValues("aCode_id") = 1439 Or
                      draValues("aCode_id") = 1443 Or
                      draValues("aCode_id") = 1447 Or
                      draValues("aCode_id") = 1450 Or
                      draValues("aCode_id") = 1454 Or
                      draValues("aCode_id") = 1458 Or
                      draValues("aCode_id") = 1462 Or
                      draValues("aCode_id") = 1526 Or
                      draValues("aCode_id") = 1529 Or
                      draValues("aCode_id") = 1533 Or
                      draValues("aCode_id") = 1537 Or
                      draValues("aCode_id") = 1541 Or
                      draValues("aCode_id") = 1545 Or
                      draValues("aCode_id") = 1549 Or
                      draValues("aCode_id") = 1553 Or
                      draValues("aCode_id") = 1556 Or
                      draValues("aCode_id") = 1560 Or
                      draValues("aCode_id") = 1564 Or
                      draValues("aCode_id") = 1568 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C11"
                    End If

                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 69
                For j As Integer = 5 To 91
                    If i <> 26 And i <> 45 And i <> 68 And i <> 69 Or j = 5 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A2L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = drSource("Line") - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())

                If iLine = 26 Or iLine = 45 Or iLine = 68 Or iLine = 69 Then
                    'Derived Values
                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = drSource("C6").ToString()
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C6"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 27) = drSource("C12").ToString()
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C12"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 33) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 35) = drSource("C16").ToString()
                    oTempRange = oRange(iLine, 35)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C16"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 37) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 39) = drSource("C18").ToString()
                    oTempRange = oRange(iLine, 39)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C18"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 41) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 43) = drSource("C20").ToString()
                    oTempRange = oRange(iLine, 43)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C20"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 45) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 45)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C21"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 47) = drSource("C22").ToString()
                    oTempRange = oRange(iLine, 47)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C22"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 49) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 51) = drSource("C24").ToString()
                    oTempRange = oRange(iLine, 51)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C24"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 53) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 53)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C25"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 55) = drSource("C26").ToString()
                    oTempRange = oRange(iLine, 55)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C26"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 57) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 59) = drSource("C28").ToString()
                    oTempRange = oRange(iLine, 59)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C28"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 61) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 61)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C29"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 63) = drSource("C30").ToString()
                    oTempRange = oRange(iLine, 63)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C30"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 65) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 65)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C31"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 67) = drSource("C32").ToString()
                    oTempRange = oRange(iLine, 67)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C32"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 69) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 69)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C33"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 71) = drSource("C34").ToString()
                    oTempRange = oRange(iLine, 71)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C34"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 73) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 73)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C35"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 75) = drSource("C36").ToString()
                    oTempRange = oRange(iLine, 75)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C36"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 77) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 77)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C37"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 79) = drSource("C38").ToString()
                    oTempRange = oRange(iLine, 79)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C38"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 81) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 81)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C39"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 83) = drSource("C40").ToString()
                    oTempRange = oRange(iLine, 83)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C40"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 85) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 85)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C41"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 87) = drSource("C42").ToString()
                    oTempRange = oRange(iLine, 87)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C42"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 89) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 89)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C43"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())

                    oRange(iLine, 91) = drSource("C44").ToString()
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                Else
                    'Create source for C44
                    Dim sSource As String = GetSourceForA2SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 90) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 91) = sSource
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A2P2")

        End Try
    End Sub

    Public Sub A2P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A2 PART 3"
            iColumnCount = 91
            iWorkTableColumnCount = 44
            sSheetTitle = "A2P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "A2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM AVALUES
            Dim iCodeOffset As Integer
            Dim iRowOffset As Integer

            For Each draValues As DataRow In dtaValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A2L" + draValues("aLine").ToString() + "'")

                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aLine")) < 312 Then
                    iCodeOffset = 1581
                    iRowOffset = 8
                ElseIf Integer.Parse(draValues("aLine")) = 313 Then
                    iCodeOffset = 1650
                    iRowOffset = 20
                ElseIf Integer.Parse(draValues("aLine")) = 318 Then
                    iCodeOffset = 1670
                    iRowOffset = 25
                ElseIf Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Then
                    iCodeOffset = 1678
                    iRowOffset = 27
                ElseIf Integer.Parse(draValues("aLine")) = 329 Then
                    iCodeOffset = 1729
                    iRowOffset = 36
                ElseIf Integer.Parse(draValues("aLine")) = 334 Then
                    iCodeOffset = 1749
                    iRowOffset = 41
                ElseIf Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Then
                    iCodeOffset = 1756
                    iRowOffset = 43
                ElseIf Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Then
                    iCodeOffset = 1780
                    iRowOffset = 49
                ElseIf Integer.Parse(draValues("aLine")) = 351 Then
                    iCodeOffset = 1821
                    iRowOffset = 58
                ElseIf Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Then
                    iCodeOffset = 1828
                    iRowOffset = 60
                ElseIf Integer.Parse(draValues("aLine")) = 361 Then
                    iCodeOffset = 1866
                    iRowOffset = 68
                ElseIf Integer.Parse(draValues("aLine")) = 364 Then
                    iCodeOffset = 1874
                    iRowOffset = 71
                End If

                If draValues("aLine") <> 319 And draValues("aLine") <> 335 And draValues("aLine") <> 352 And draValues("aLine") <> 362 And draValues("aLine") <> 363 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C1"
                    End If
                End If

                If (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                   And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C2"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 29) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 29)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C13"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 27) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 27)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C12"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 45) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 45)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C21"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 43)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C20"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 61) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 61)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C29"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 59) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 59)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C28"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 77) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 77)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C37"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 75) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 75)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C36"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 1 Then

                    Dim sIndex As String = IIf(draValues("aLine") = 309 Or draValues("aLine") = 325, "5", "2")

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C4"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 33) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 33)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C15"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C14"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 49) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 49)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C23"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 47) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 47)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C22"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 65) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 65)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C31"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 63) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C30"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 81) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 81)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C39"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 79) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 79)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C38"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 2 Or
                       Integer.Parse(draValues("aCode_id")) = 1662 Or
                       Integer.Parse(draValues("aCode_id")) = 1666 Or
                       Integer.Parse(draValues("aCode_id")) = 1741 Or
                       Integer.Parse(draValues("aCode_id")) = 1745 Or
                       Integer.Parse(draValues("aCode_id")) = 1813 Or
                       Integer.Parse(draValues("aCode_id")) = 1817 Or
                       Integer.Parse(draValues("aCode_id")) = 1858 Or
                       Integer.Parse(draValues("aCode_id")) = 1862 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C6"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 37) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 37)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C17"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 35) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 35)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C16"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 53) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 53)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C25"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 51) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 51)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C24"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 69) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 69)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C33"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 67) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 67)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C32"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 85) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 85)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C41"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 83) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 83)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C40"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 3 Or
                       Integer.Parse(draValues("aCode_id")) = 1647 Or
                       Integer.Parse(draValues("aCode_id")) = 1656 Or
                       Integer.Parse(draValues("aCode_id")) = 1659 Or
                       Integer.Parse(draValues("aCode_id")) = 1663 Or
                       Integer.Parse(draValues("aCode_id")) = 1667 Or
                       Integer.Parse(draValues("aCode_id")) = 1726 Or
                       Integer.Parse(draValues("aCode_id")) = 1735 Or
                       Integer.Parse(draValues("aCode_id")) = 1738 Or
                       Integer.Parse(draValues("aCode_id")) = 1742 Or
                       Integer.Parse(draValues("aCode_id")) = 1746 Or
                       Integer.Parse(draValues("aCode_id")) = 1774 Or
                       Integer.Parse(draValues("aCode_id")) = 1777 Or
                       Integer.Parse(draValues("aCode_id")) = 1804 Or
                       Integer.Parse(draValues("aCode_id")) = 1807 Or
                       Integer.Parse(draValues("aCode_id")) = 1810 Or
                       Integer.Parse(draValues("aCode_id")) = 1814 Or
                       Integer.Parse(draValues("aCode_id")) = 1818 Or
                       Integer.Parse(draValues("aCode_id")) = 1852 Or
                       Integer.Parse(draValues("aCode_id")) = 1855 Or
                       Integer.Parse(draValues("aCode_id")) = 1859 Or
                       Integer.Parse(draValues("aCode_id")) = 1863 Or
                       Integer.Parse(draValues("aCode_id")) = 1880 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C8"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 41) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 41)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C19"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 39) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 39)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C18"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 57) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 57)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C27"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 55) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 55)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C26"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 73) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 73)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C35"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 71) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 71)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C34"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 89) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 4")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 89)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C43"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 87) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 87)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C42"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                   And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 4 Or
                       Integer.Parse(draValues("aCode_id")) = 1648 Or
                       Integer.Parse(draValues("aCode_id")) = 1657 Or
                       Integer.Parse(draValues("aCode_id")) = 1660 Or
                       Integer.Parse(draValues("aCode_id")) = 1664 Or
                       Integer.Parse(draValues("aCode_id")) = 1668 Or
                       Integer.Parse(draValues("aCode_id")) = 1727 Or
                       Integer.Parse(draValues("aCode_id")) = 1736 Or
                       Integer.Parse(draValues("aCode_id")) = 1739 Or
                       Integer.Parse(draValues("aCode_id")) = 1743 Or
                       Integer.Parse(draValues("aCode_id")) = 1747 Or
                       Integer.Parse(draValues("aCode_id")) = 1775 Or
                       Integer.Parse(draValues("aCode_id")) = 1778 Or
                       Integer.Parse(draValues("aCode_id")) = 1805 Or
                       Integer.Parse(draValues("aCode_id")) = 1808 Or
                       Integer.Parse(draValues("aCode_id")) = 1811 Or
                       Integer.Parse(draValues("aCode_id")) = 1815 Or
                       Integer.Parse(draValues("aCode_id")) = 1819 Or
                       Integer.Parse(draValues("aCode_id")) = 1853 Or
                       Integer.Parse(draValues("aCode_id")) = 1856 Or
                       Integer.Parse(draValues("aCode_id")) = 1860 Or
                       Integer.Parse(draValues("aCode_id")) = 1864 Or
                       Integer.Parse(draValues("aCode_id")) = 1881 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C10"
                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 312 Or Integer.Parse(draValues("aLine")) = 313 Or Integer.Parse(draValues("aLine")) = 318 Or
                    Integer.Parse(draValues("aLine")) > 319 And Integer.Parse(draValues("aLine")) < 328 Or Integer.Parse(draValues("aLine")) = 329 Or
                    Integer.Parse(draValues("aLine")) = 334 Or Integer.Parse(draValues("aLine")) > 335 And Integer.Parse(draValues("aLine")) < 339 Or
                    Integer.Parse(draValues("aLine")) > 341 And Integer.Parse(draValues("aLine")) < 346 Or Integer.Parse(draValues("aLine")) = 351 Or
                    Integer.Parse(draValues("aLine")) > 352 And Integer.Parse(draValues("aLine")) < 357 Or Integer.Parse(draValues("aLine")) = 361 Or
                    Integer.Parse(draValues("aLine")) = 364) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 5 Or
                       Integer.Parse(draValues("aCode_id")) = 1649 Or
                       Integer.Parse(draValues("aCode_id")) = 1658 Or
                       Integer.Parse(draValues("aCode_id")) = 1661 Or
                       Integer.Parse(draValues("aCode_id")) = 1665 Or
                       Integer.Parse(draValues("aCode_id")) = 1669 Or
                       Integer.Parse(draValues("aCode_id")) = 1728 Or
                       Integer.Parse(draValues("aCode_id")) = 1737 Or
                       Integer.Parse(draValues("aCode_id")) = 1740 Or
                       Integer.Parse(draValues("aCode_id")) = 1744 Or
                       Integer.Parse(draValues("aCode_id")) = 1748 Or
                       Integer.Parse(draValues("aCode_id")) = 1776 Or
                       Integer.Parse(draValues("aCode_id")) = 1779 Or
                       Integer.Parse(draValues("aCode_id")) = 1806 Or
                       Integer.Parse(draValues("aCode_id")) = 1809 Or
                       Integer.Parse(draValues("aCode_id")) = 1812 Or
                       Integer.Parse(draValues("aCode_id")) = 1816 Or
                       Integer.Parse(draValues("aCode_id")) = 1820 Or
                       Integer.Parse(draValues("aCode_id")) = 1854 Or
                       Integer.Parse(draValues("aCode_id")) = 1857 Or
                       Integer.Parse(draValues("aCode_id")) = 1861 Or
                       Integer.Parse(draValues("aCode_id")) = 1865 Or
                       Integer.Parse(draValues("aCode_id")) = 1882 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C11"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 73
                For j As Integer = 5 To 91
                    If (i <> 26 And i <> 42) Or j = 5 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A2L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())

                If iLine = 26 Or iLine = 42 Or iLine = 48 Or iLine = 59 Or iLine = 69 Or iLine = 70 Or iLine = 73 Then
                    'Derived Values
                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = drSource("C6").ToString()
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C6"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 27) = drSource("C12").ToString()
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C12"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 33) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 35) = drSource("C16").ToString()
                    oTempRange = oRange(iLine, 35)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C16"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 37) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 39) = drSource("C18").ToString()
                    oTempRange = oRange(iLine, 39)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C18"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 41) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 43) = drSource("C20").ToString()
                    oTempRange = oRange(iLine, 43)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C20"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 45) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 45)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C21"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 47) = drSource("C22").ToString()
                    oTempRange = oRange(iLine, 47)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C22"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 49) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 51) = drSource("C24").ToString()
                    oTempRange = oRange(iLine, 51)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C24"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 53) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 53)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C25"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 55) = drSource("C26").ToString()
                    oTempRange = oRange(iLine, 55)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C26"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 57) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 59) = drSource("C28").ToString()
                    oTempRange = oRange(iLine, 59)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C28"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 61) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 61)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C29"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 63) = drSource("C30").ToString()
                    oTempRange = oRange(iLine, 63)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C30"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 65) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 65)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C31"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 67) = drSource("C32").ToString()
                    oTempRange = oRange(iLine, 67)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C32"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 69) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 69)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C33"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 71) = drSource("C34").ToString()
                    oTempRange = oRange(iLine, 71)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C34"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 73) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 73)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C35"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 75) = drSource("C36").ToString()
                    oTempRange = oRange(iLine, 75)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C36"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 77) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 77)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C37"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 79) = drSource("C38").ToString()
                    oTempRange = oRange(iLine, 79)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C38"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 81) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 81)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C39"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 83) = drSource("C40").ToString()
                    oTempRange = oRange(iLine, 83)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C40"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 85) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 85)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C41"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 87) = drSource("C42").ToString()
                    oTempRange = oRange(iLine, 87)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C42"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 89) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 89)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C43"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())

                    oRange(iLine, 91) = drSource("C44").ToString()
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                Else
                    'Create source for C44
                    Dim sSource As String = GetSourceForA2SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 90) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 91) = sSource
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A2P3")

        End Try
    End Sub

    Public Sub A2P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A2 PART 4"
            iColumnCount = 91
            iWorkTableColumnCount = 44
            sSheetTitle = "A2P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "A2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS
            Dim iCodeOffset As Integer
            Dim iRowOffset As Integer

            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A2L" + draValues("aLine").ToString() + "'")

                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If Integer.Parse(draValues("aLine")) < 411 Then
                    iCodeOffset = 1883
                    iRowOffset = 8
                ElseIf Integer.Parse(draValues("aLine")) = 418 Then
                    iCodeOffset = 1966
                    iRowOffset = 25
                End If

                If draValues("aLine") <> 419 And draValues("aLine") <> 420 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C1"
                    End If
                End If

                If (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                  And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C2"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 29) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 29)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C13"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 27) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 27)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C12"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 45) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 45)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C21"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 43)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C20"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 61) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 61)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C29"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 59) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 59)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C28"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 77) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 1")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 77)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C37"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 75) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 75)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C36"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 1 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C4"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 33) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 33)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C15"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 31) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 31)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C14"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 49) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 49)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C23"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 47) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 47)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C22"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 65) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 65)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C31"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 63) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C30"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 81) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 2")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 81)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C39"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 79) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 79)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C38"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 2 Or
                       Integer.Parse(draValues("aCode_id")) = 1958 Or
                       Integer.Parse(draValues("aCode_id")) = 1962 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C6"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 37) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 37)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C17"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 35) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 35)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C16"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 53) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 53)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C25"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 51) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 51)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C24"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 69) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 69)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C33"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 67) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 67)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C32"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 85) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 3")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 85)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C41"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 83) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 83)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C40"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 3 Or
                       Integer.Parse(draValues("aCode_id")) = 1943 Or
                       Integer.Parse(draValues("aCode_id")) = 1946 Or
                       Integer.Parse(draValues("aCode_id")) = 1949 Or
                       Integer.Parse(draValues("aCode_id")) = 1952 Or
                       Integer.Parse(draValues("aCode_id")) = 1955 Or
                       Integer.Parse(draValues("aCode_id")) = 1959 Or
                       Integer.Parse(draValues("aCode_id")) = 1963 Or
                       Integer.Parse(draValues("aCode_id")) = 1974 Or
                       Integer.Parse(draValues("aCode_id")) = 1977 Then

                    Dim sIndex As String = IIf(draValues("aLine") > 420, "23", "4")

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C8"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 41) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 41)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C19"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 39) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 39)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C18"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 57) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 57)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C27"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 55) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 55)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C26"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 73) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 73)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C35"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 71) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 71)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C34"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 89) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + sIndex)(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 89)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C43"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 87) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 87)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C42"

                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                   And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 4 Or
                       Integer.Parse(draValues("aCode_id")) = 1944 Or
                       Integer.Parse(draValues("aCode_id")) = 1947 Or
                       Integer.Parse(draValues("aCode_id")) = 1950 Or
                       Integer.Parse(draValues("aCode_id")) = 1953 Or
                       Integer.Parse(draValues("aCode_id")) = 1956 Or
                       Integer.Parse(draValues("aCode_id")) = 1960 Or
                       Integer.Parse(draValues("aCode_id")) = 1964 Or
                       Integer.Parse(draValues("aCode_id")) = 1975 Or
                       Integer.Parse(draValues("aCode_id")) = 1978 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C10"
                    End If
                ElseIf (Integer.Parse(draValues("aLine")) < 411 Or Integer.Parse(draValues("aLine")) = 418) _
                    And Integer.Parse(draValues("aCode_id")) = iCodeOffset + 6 * (iROW_COUNT - iRowOffset) + 5 Or
                       Integer.Parse(draValues("aCode_id")) = 1945 Or
                       Integer.Parse(draValues("aCode_id")) = 1948 Or
                       Integer.Parse(draValues("aCode_id")) = 1951 Or
                       Integer.Parse(draValues("aCode_id")) = 1954 Or
                       Integer.Parse(draValues("aCode_id")) = 1957 Or
                       Integer.Parse(draValues("aCode_id")) = 1961 Or
                       Integer.Parse(draValues("aCode_id")) = 1965 Or
                       Integer.Parse(draValues("aCode_id")) = 1976 Or
                       Integer.Parse(draValues("aCode_id")) = 1979 Then
                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 25) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A2L" & draValues("aLine").ToString() & "C11"
                    End If
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 29
                For j As Integer = 5 To 91
                    If (i <> 26 And i <> 42) Or j = 5 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A2L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())

                If iLine = 26 Or iLine = 27 Then
                    'Derived Values
                    oRange(iLine, 7) = drSource("C2").ToString()
                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C2"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C4"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = drSource("C6").ToString()
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C6"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = drSource("C8").ToString()
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C8"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = drSource("C10").ToString()
                    oTempRange = oRange(iLine, 23)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C10"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 25) = drSource("C11").ToString()
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C11"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 27) = drSource("C12").ToString()
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C12"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 29) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 31) = drSource("C14").ToString()
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C14"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 33) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 35) = drSource("C16").ToString()
                    oTempRange = oRange(iLine, 35)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C16"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 37) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 39) = drSource("C18").ToString()
                    oTempRange = oRange(iLine, 39)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C18"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 41) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 43) = drSource("C20").ToString()
                    oTempRange = oRange(iLine, 43)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C20"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 45) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 45)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C21"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 47) = drSource("C22").ToString()
                    oTempRange = oRange(iLine, 47)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C22"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 49) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 51) = drSource("C24").ToString()
                    oTempRange = oRange(iLine, 51)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C24"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 53) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 53)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C25"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 55) = drSource("C26").ToString()
                    oTempRange = oRange(iLine, 55)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C26"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 57) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 59) = drSource("C28").ToString()
                    oTempRange = oRange(iLine, 59)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C28"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 61) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 61)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C29"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 63) = drSource("C30").ToString()
                    oTempRange = oRange(iLine, 63)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C30"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 65) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 65)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C31"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 67) = drSource("C32").ToString()
                    oTempRange = oRange(iLine, 67)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C32"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 69) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 69)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C33"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 71) = drSource("C34").ToString()
                    oTempRange = oRange(iLine, 71)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C34"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 73) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 73)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C35"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 75) = drSource("C36").ToString()
                    oTempRange = oRange(iLine, 75)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C36"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 77) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 77)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C37"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 79) = drSource("C38").ToString()
                    oTempRange = oRange(iLine, 79)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C38"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 81) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 81)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C39"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 83) = drSource("C40").ToString()
                    oTempRange = oRange(iLine, 83)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C40"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 85) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 85)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C41"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 87) = drSource("C42").ToString()
                    oTempRange = oRange(iLine, 87)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C42"
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 89) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 89)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C43"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())

                    oRange(iLine, 91) = drSource("C44").ToString()
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                Else
                    'Create source for C44
                    Dim sSource As String = GetSourceForA2SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 90) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 91) = sSource
                    oTempRange = oRange(iLine, 91)
                    oTempRange.Name = "A2L" & drSource("Line").ToString() & "C44"
                End If

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A2P4")

        End Try
    End Sub

    Public Sub A3P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 1"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 110 And draValues("aLine") <> 120 And draValues("aLine") <> 130 And draValues("aLine") <> 140 And
                    draValues("aLine") <> 150 And draValues("aLine") <> 160 And draValues("aLine") <> 168 And draValues("aLine") <> 178 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 22")(0)("Current_Year").ToString())
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        sNamedRange = "A3L" & draValues("aLine").ToString() & "C2"

                    ElseIf iProcessYear = (iCurrentYear - 1) Then
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 22")(0)("Current_Year_Minus_1").ToString())
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        sNamedRange = "A3L" & draValues("aLine").ToString() & "C4"

                    ElseIf iProcessYear = (iCurrentYear - 2) Then
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 22")(0)("Current_Year_Minus_2").ToString())
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        sNamedRange = "A3L" & draValues("aLine").ToString() & "C6"

                    ElseIf iProcessYear = (iCurrentYear - 3) Then
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 22")(0)("Current_Year_Minus_3").ToString())
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        sNamedRange = "A3L" & draValues("aLine").ToString() & "C8"

                    ElseIf iProcessYear = (iCurrentYear - 4) Then
                        oRange(iROW_COUNT, 25) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = 22")(0)("Current_Year_Minus_4").ToString())
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"

                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        sNamedRange = "A3L" & draValues("aLine").ToString() & "C10"
                    End If

                    'APPLY FORMATTING
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.Name = sNamedRange
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) = 110 Or Integer.Parse(drSource("Line")) = 120 Or Integer.Parse(drSource("Line")) = 130 Or
                    Integer.Parse(drSource("Line")) = 140 Or Integer.Parse(drSource("Line")) = 150 Or Integer.Parse(drSource("Line")) = 160 Or
                    Integer.Parse(drSource("Line")) = 168 Or Integer.Parse(drSource("Line")) = 178 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P1SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P1")

        End Try
    End Sub

    Public Sub A3P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 2"
            iColumnCount = 89
            iWorkTableColumnCount = 43
            sSheetTitle = "A3P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 219 And draValues("aLine") <> 224 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = dtPriceIndexes.Select("Index = 9")(0)("Current_Year").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "0.0000"

                        If draValues("aColumn").ToString() = "3" Then
                            oRange(iROW_COUNT, 9) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 9)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        End If

                        If draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 11) = IIf(iROW_COUNT = 25, "=A3L215C4+A3L216C4+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 11)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        End If

                        If draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 13) = IIf(iROW_COUNT = 25, "=A3L215C5+A3L216C5+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 13)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        End If

                        If draValues("aColumn").ToString() = "6" Then
                            oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 15)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        End If

                        If draValues("aColumn").ToString() = "7" Then
                            oRange(iROW_COUNT, 17) = IIf(iROW_COUNT = 25, "=A3L215C7+A3L216C7+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 17)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        End If

                        If draValues("aColumn").ToString() = "8" Then
                            oRange(iROW_COUNT, 19) = IIf(iROW_COUNT = 25, "=A3L215C8+A3L216C8+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 19)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        End If
                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 21) = dtPriceIndexes.Select("Index = 9")(0)("Current_Year_Minus_1").ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                        If draValues("aColumn").ToString() = "3" Then
                            oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 23)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        End If

                        If draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 25) = IIf(iROW_COUNT = 25, "=A3L215C11+A3L216C11+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 25)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        End If

                        If draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 27) = IIf(iROW_COUNT = 25, "=A3L215C12+A3L216C12+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 27)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C12"
                        End If

                        If draValues("aColumn").ToString() = "6" Then
                            oRange(iROW_COUNT, 29) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 29)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C13"
                        End If

                        If draValues("aColumn").ToString() = "7" Then
                            oRange(iROW_COUNT, 31) = IIf(iROW_COUNT = 25, "=A3L215C14+A3L216C14+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 31)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C14"
                        End If

                        If draValues("aColumn").ToString() = "8" Then
                            oRange(iROW_COUNT, 33) = IIf(iROW_COUNT = 25, "=A3L215C15+A3L216C15+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 33)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C15"
                        End If
                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 35) = dtPriceIndexes.Select("Index = 9")(0)("Current_Year_Minus_2").ToString()
                        oTempRange = oRange(iROW_COUNT, 35)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C16"
                        oTempRange.NumberFormat = "0.0000"

                        If draValues("aColumn").ToString() = "3" Then
                            oRange(iROW_COUNT, 37) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 37)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C17"
                        End If

                        If draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 39) = IIf(iROW_COUNT = 25, "=A3L215C18+A3L216C18+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 39)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C18"
                        End If

                        If draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 41) = IIf(iROW_COUNT = 25, "=A3L215C19+A3L216C19+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 41)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C19"
                        End If

                        If draValues("aColumn").ToString() = "6" Then
                            oRange(iROW_COUNT, 43) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 43)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C20"
                        End If

                        If draValues("aColumn").ToString() = "7" Then
                            oRange(iROW_COUNT, 45) = IIf(iROW_COUNT = 25, "=A3L215C21+A3L216C21+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 45)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C21"
                        End If

                        If draValues("aColumn").ToString() = "8" Then
                            oRange(iROW_COUNT, 47) = IIf(iROW_COUNT = 25, "=A3L215C22+A3L216C22+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 47)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C22"
                        End If
                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 49) = dtPriceIndexes.Select("Index = 9")(0)("Current_Year_Minus_3").ToString()
                        oTempRange = oRange(iROW_COUNT, 49)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C23"
                        oTempRange.NumberFormat = "0.0000"

                        If draValues("aColumn").ToString() = "3" Then
                            oRange(iROW_COUNT, 51) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 51)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C24"
                        End If

                        If draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 53) = IIf(iROW_COUNT = 25, "=A3L215C25+A3L216C25+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 53)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C25"
                        End If

                        If draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 55) = IIf(iROW_COUNT = 25, "=A3L215C26+A3L216C26+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 55)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C26"
                        End If

                        If draValues("aColumn").ToString() = "6" Then
                            oRange(iROW_COUNT, 57) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 57)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C27"
                        End If

                        If draValues("aColumn").ToString() = "7" Then
                            oRange(iROW_COUNT, 59) = IIf(iROW_COUNT = 25, "=A3L215C28+A3L216C28+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 59)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C28"
                        End If

                        If draValues("aColumn").ToString() = "8" Then
                            oRange(iROW_COUNT, 61) = IIf(iROW_COUNT = 25, "=A3L215C29+A3L216C29+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 61)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C29"
                        End If
                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 63) = dtPriceIndexes.Select("Index = 9")(0)("Current_Year_Minus_4").ToString()
                        oTempRange = oRange(iROW_COUNT, 63)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C30"
                        oTempRange.NumberFormat = "0.0000"

                        If draValues("aColumn").ToString() = "3" Then
                            oRange(iROW_COUNT, 65) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 65)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C31"
                        End If

                        If draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 67) = IIf(iROW_COUNT = 25, "=A3L215C32+A3L216C32+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 67)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C32"
                        End If

                        If draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 69) = IIf(iROW_COUNT = 25, "=A3L215C33+A3L216C33+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 69)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C33"
                        End If

                        If draValues("aColumn").ToString() = "6" Then
                            oRange(iROW_COUNT, 71) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 71)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C34"
                        End If

                        If draValues("aColumn").ToString() = "7" Then
                            oRange(iROW_COUNT, 73) = IIf(iROW_COUNT = 25, "=A3L215C35+A3L216C35+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 73)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C35"
                        End If

                        If draValues("aColumn").ToString() = "8" Then
                            oRange(iROW_COUNT, 75) = IIf(iROW_COUNT = 25, "=A3L215C36+A3L216C36+", "") + draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 75)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C36"
                        End If
                    End If
                End If
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())

                If Integer.Parse(drSource("Line")) = 219 Or Integer.Parse(drSource("Line")) = 224 Then
                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 9) = scrubYear(drSource("C3").ToString())
                    oTempRange = oRange(iLine, 9)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = scrubYear(drSource("C5").ToString())
                    oTempRange = oRange(iLine, 13)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = scrubYear(drSource("C7").ToString())
                    oTempRange = oRange(iLine, 17)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = scrubYear(drSource("C11").ToString())
                    oTempRange = oRange(iLine, 25)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"

                    oRange(iLine, 29) = scrubYear(drSource("C13").ToString())
                    oTempRange = oRange(iLine, 29)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C13"

                    oRange(iLine, 31) = scrubYear(drSource("C14").ToString())
                    oTempRange = oRange(iLine, 31)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C14"

                    oRange(iLine, 33) = scrubYear(drSource("C15").ToString())
                    oTempRange = oRange(iLine, 33)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C15"

                    oRange(iLine, 35) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 35)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C16"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 37) = scrubYear(drSource("C17").ToString())
                    oTempRange = oRange(iLine, 37)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C17"

                    oRange(iLine, 39) = scrubYear(drSource("C18").ToString())
                    oTempRange = oRange(iLine, 39)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C18"

                    oRange(iLine, 41) = scrubYear(drSource("C19").ToString())
                    oTempRange = oRange(iLine, 41)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C19"

                    oRange(iLine, 43) = scrubYear(drSource("C20").ToString())
                    oTempRange = oRange(iLine, 43)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C20"

                    oRange(iLine, 45) = scrubYear(drSource("C21").ToString())
                    oTempRange = oRange(iLine, 45)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C21"

                    oRange(iLine, 47) = scrubYear(drSource("C22").ToString())
                    oTempRange = oRange(iLine, 47)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C22"

                    oRange(iLine, 49) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 51) = scrubYear(drSource("C24").ToString())
                    oTempRange = oRange(iLine, 51)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C24"

                    oRange(iLine, 53) = scrubYear(drSource("C25").ToString())
                    oTempRange = oRange(iLine, 53)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C25"

                    oRange(iLine, 55) = scrubYear(drSource("C26").ToString())
                    oTempRange = oRange(iLine, 55)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C26"

                    oRange(iLine, 57) = scrubYear(drSource("C27").ToString())
                    oTempRange = oRange(iLine, 57)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C27"

                    oRange(iLine, 59) = scrubYear(drSource("C28").ToString())
                    oTempRange = oRange(iLine, 59)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C28"

                    oRange(iLine, 61) = scrubYear(drSource("C29").ToString())
                    oTempRange = oRange(iLine, 61)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C29"

                    oRange(iLine, 63) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 63)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C30"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 65) = scrubYear(drSource("C31").ToString())
                    oTempRange = oRange(iLine, 65)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C31"

                    oRange(iLine, 67) = scrubYear(drSource("C32").ToString())
                    oTempRange = oRange(iLine, 67)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C32"

                    oRange(iLine, 69) = scrubYear(drSource("C33").ToString())
                    oTempRange = oRange(iLine, 69)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C33"

                    oRange(iLine, 71) = scrubYear(drSource("C34").ToString())
                    oTempRange = oRange(iLine, 71)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C34"

                    oRange(iLine, 73) = scrubYear(drSource("C35").ToString())
                    oTempRange = oRange(iLine, 73)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C35"

                    oRange(iLine, 75) = scrubYear(drSource("C36").ToString())
                    oTempRange = oRange(iLine, 75)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C36"

                    oRange(iLine, 77) = scrubYear(drSource("C37").ToString())
                    oTempRange = oRange(iLine, 77)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C37"

                    oRange(iLine, 79) = scrubYear(drSource("C38").ToString())
                    oTempRange = oRange(iLine, 79)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C38"

                    oRange(iLine, 81) = scrubYear(drSource("C39").ToString())
                    oTempRange = oRange(iLine, 81)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C39"

                    oRange(iLine, 83) = scrubYear(drSource("C40").ToString())
                    oTempRange = oRange(iLine, 83)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C40"

                    oRange(iLine, 85) = scrubYear(drSource("C41").ToString())
                    oTempRange = oRange(iLine, 85)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C41"

                    oRange(iLine, 87) = scrubYear(drSource("C42").ToString())
                    oTempRange = oRange(iLine, 87)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C42"

                    oRange(iLine, 89) = scrubYear(drSource("C43").ToString())
                    oTempRange = oRange(iLine, 89)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C43"
                Else
                    'Create source for C37-C43
                    Dim sSource As String

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 3)
                    oRange(iLine, 76) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 77) = sSource
                    oTempRange = oRange(iLine, 77)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C37"

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 4)
                    oRange(iLine, 78) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 79) = sSource
                    oTempRange = oRange(iLine, 79)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C38"

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 5)
                    oRange(iLine, 80) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 81) = sSource
                    oTempRange = oRange(iLine, 81)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C39"

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 6)
                    oRange(iLine, 82) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 83) = sSource
                    oTempRange = oRange(iLine, 83)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C40"

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 7)
                    oRange(iLine, 84) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 85) = sSource
                    oTempRange = oRange(iLine, 85)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C41"

                    sSource = GetSourceForA3P2SummaryColumn(drSource("Line"), iLine, 8)
                    oRange(iLine, 86) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 87) = sSource
                    oTempRange = oRange(iLine, 87)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C42"

                    oRange(iLine, 89) = scrubYear(drSource("C43").ToString())
                    oTempRange = oRange(iLine, 89)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C43"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P2")

        End Try
    End Sub

    Public Sub A3P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 3"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") < 305 Or draValues("aLine") > 307 And draValues("aLine") < 326 Or
                    draValues("aLine") > 326 And draValues("aLine") < 342 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drPriceIndexeReferences() As DataRow
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P3' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '3'")
                        oRange(iROW_COUNT, 9) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year").ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P3' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '5'")
                        oRange(iROW_COUNT, 13) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_1").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P3' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '7'")
                        oRange(iROW_COUNT, 17) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_2").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P3' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '9'")
                        oRange(iROW_COUNT, 21) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_3").ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P3' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '11'")
                        oRange(iROW_COUNT, 25) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_4").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) >= 305 And Integer.Parse(drSource("Line")) <= 307 Or
                    Integer.Parse(drSource("Line")) = 326 Or Integer.Parse(drSource("Line")) >= 342 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P3toP8SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P3")

        End Try
    End Sub

    Public Sub A3P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 4"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") < 405 Or draValues("aLine") > 407 And draValues("aLine") < 426 Or
                    draValues("aLine") > 426 And draValues("aLine") < 442 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drPriceIndexeReferences() As DataRow
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P4' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '3'")
                        oRange(iROW_COUNT, 9) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year").ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P4' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '5'")
                        oRange(iROW_COUNT, 13) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_1").ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P4' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '7'")
                        oRange(iROW_COUNT, 17) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_2").ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P4' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '9'")
                        oRange(iROW_COUNT, 21) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_3").ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P4' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '11'")
                        oRange(iROW_COUNT, 25) = dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_4").ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) >= 405 And Integer.Parse(drSource("Line")) <= 407 Or
                    Integer.Parse(drSource("Line")) = 426 Or Integer.Parse(drSource("Line")) >= 442 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P3toP8SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P4")

        End Try
    End Sub

    Public Sub A3P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 5"
            iColumnCount = 15
            iWorkTableColumnCount = 6
            sSheetTitle = "A3P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") < 505 Or draValues("aLine") > 507 And draValues("aLine") < 526 Or
                    draValues("aLine") > 526 And draValues("aLine") < 542 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        If draValues("aColumn").ToString() = "1" Then
                            oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 5)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        ElseIf draValues("aColumn").ToString() = "2" Then
                            oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 7)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"

                        ElseIf draValues("aColumn").ToString() = "4" Then
                            oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 11)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"

                        ElseIf draValues("aColumn").ToString() = "5" Then
                            oRange(iROW_COUNT, 13) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 13)
                            oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"

                        End If
                        oTempRange.NumberFormat = "#,##0"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())

                If Integer.Parse(drSource("Line")) >= 505 And Integer.Parse(drSource("Line")) <= 507 Or
                    Integer.Parse(drSource("Line")) = 526 Or Integer.Parse(drSource("Line")) >= 542 Then

                    oRange(iLine, 5) = scrubYear(drSource("C1").ToString())
                    oTempRange = oRange(iLine, 5)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = scrubYear(drSource("C3").ToString())
                    oTempRange = oRange(iLine, 9)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = scrubYear(drSource("C5").ToString())
                    oTempRange = oRange(iLine, 13)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"
                Else
                    oRange(iLine, 9) = scrubYear(drSource("C3").ToString())
                    oTempRange = oRange(iLine, 9)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P5")

        End Try
    End Sub

    Public Sub A3P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 6"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") < 605 Or draValues("aLine") > 607 And draValues("aLine") < 626 Or
                    draValues("aLine") > 626 And draValues("aLine") < 642 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drPriceIndexeReferences() As DataRow
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P6' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '3'")
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P6' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '5'")
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_1").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P6' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '7'")
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_2").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P6' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '9'")
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_3").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P6' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '11'")
                        oRange(iROW_COUNT, 25) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_4").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) >= 605 And Integer.Parse(drSource("Line")) <= 607 Or
                    Integer.Parse(drSource("Line")) = 626 Or Integer.Parse(drSource("Line")) >= 642 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P3toP8SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P6")

        End Try
    End Sub

    Public Sub A3P7(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 7"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P7"
            iLineNumberOffset = 693
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 728 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drPriceIndexeReferences() As DataRow
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P7' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '3'")
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P7' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '5'")
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_1").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P7' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '7'")
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_2").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P7' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '9'")
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_3").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P7' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '11'")
                        oRange(iROW_COUNT, 25) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_4").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) = 728 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P3toP8SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            Dim SSAC_Cells() As String = {"A3L701C2", "A3L701C4", "A3L701C6", "A3L701C8", "A3L701C10",
                                          "A3L702C2", "A3L702C4", "A3L702C6", "A3L702C8", "A3L702C10",
                                          "A3L703C2", "A3L703C4", "A3L703C6", "A3L703C8", "A3L703C10",
                                          "A3L704C2", "A3L704C4", "A3L704C6", "A3L704C8", "A3L704C10",
                                          "A3L705C2", "A3L705C4", "A3L705C6", "A3L705C8", "A3L705C10",
                                          "A3L706C2", "A3L706C4", "A3L706C6", "A3L706C8", "A3L706C10",
                                          "A3L707C2", "A3L707C4", "A3L707C6", "A3L707C8", "A3L707C10",
                                          "A3L708C2", "A3L708C4", "A3L708C6", "A3L708C8", "A3L708C10",
                                          "A3L709C2", "A3L709C4", "A3L709C6", "A3L709C8", "A3L709C10",
                                          "A3L710C2", "A3L710C4", "A3L710C6", "A3L710C8", "A3L710C10",
                                          "A3L711C2", "A3L711C4", "A3L711C6", "A3L711C8", "A3L711C10",
                                          "A3L712C2", "A3L712C4", "A3L712C6", "A3L712C8", "A3L712C10",
                                          "A3L713C2", "A3L713C4", "A3L713C6", "A3L713C8", "A3L713C10",
                                          "A3L714C2", "A3L714C4", "A3L714C6", "A3L714C8", "A3L714C10",
                                          "A3L715C2", "A3L715C4", "A3L715C6", "A3L715C8", "A3L715C10",
                                          "A3L716C2", "A3L716C4", "A3L716C6", "A3L716C8", "A3L716C10",
                                          "A3L717C2", "A3L717C4", "A3L717C6", "A3L717C8", "A3L717C10",
                                          "A3L718C2", "A3L718C4", "A3L718C6", "A3L718C8", "A3L718C10",
                                          "A3L719C2", "A3L719C4", "A3L719C6", "A3L719C8", "A3L719C10",
                                          "A3L720C2", "A3L720C4", "A3L720C6", "A3L720C8", "A3L720C10",
                                          "A3L721C2", "A3L721C4", "A3L721C6", "A3L721C8", "A3L721C10",
                                          "A3L722C2", "A3L722C4", "A3L722C6", "A3L722C8", "A3L722C10",
                                          "A3L723C2", "A3L723C4", "A3L723C6", "A3L723C8", "A3L723C10",
                                          "A3L725C2", "A3L725C4", "A3L725C6", "A3L725C8", "A3L725C10",
                                          "A3L726C2", "A3L726C4", "A3L726C6", "A3L726C8", "A3L726C10",
                                          "A3L727C2", "A3L727C4", "A3L727C6", "A3L727C8", "A3L727C10"}

            'HANDLE SSAC SETTING
            For i As Integer = 8 To 34
                For j As Integer = 5 To 27
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) Then
                        If Not IsNothing(oCell.Value2) Then
                            If SSAC_Cells.Contains(oRange(i, j).Name.Name.ToString()) Then
                                oRange(i, j) = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                            End If
                        End If
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P7")

        End Try
    End Sub

    Public Sub A3P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A3 PART 8"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "A3P8"
            iLineNumberOffset = 793
            sNamedRangePrefix = "A3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 829 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    Dim drPriceIndexeReferences() As DataRow
                    Dim drAnnPeriod() As DataRow = dtDataDictionary.Select("Line = 'A3L" + draValues("aLine").ToString() + "'")

                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        oRange(iROW_COUNT, 5) = drAnnPeriod(0)("AnnPeriod").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C1"

                        oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 7)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C2"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P8' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '3'")
                        oRange(iROW_COUNT, 9) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 9)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C3"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 1 Then
                        oRange(iROW_COUNT, 11) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 11)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C4"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P8' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '5'")
                        oRange(iROW_COUNT, 13) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_1").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 13)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C5"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 2 Then
                        oRange(iROW_COUNT, 15) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 15)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C6"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P8' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '7'")
                        oRange(iROW_COUNT, 17) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_2").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 17)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C7"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 3 Then
                        oRange(iROW_COUNT, 19) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 19)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C8"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P8' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '9'")
                        oRange(iROW_COUNT, 21) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_3").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 21)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C9"
                        oTempRange.NumberFormat = "0.0000"

                    ElseIf iProcessYear = iCurrentYear - 4 Then
                        oRange(iROW_COUNT, 23) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 23)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C10"
                        oTempRange.NumberFormat = "#,##0"

                        drPriceIndexeReferences = dtPriceIndexReferences.Select("Worktable = 'A3P8' AND Line = '" + draValues("aLine").ToString() + "' AND [Column] = '11'")
                        oRange(iROW_COUNT, 25) = IIf(draValues("Value").ToString() = "0", "0", dtPriceIndexes.Select("Index = " + Integer.Parse(drPriceIndexeReferences(0)("Index")).ToString())(0)("Current_Year_Minus_4").ToString()).ToString()
                        oTempRange = oRange(iROW_COUNT, 25)
                        oTempRange.Name = "A3L" & draValues("aLine").ToString() & "C11"
                        oTempRange.NumberFormat = "0.0000"
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())

                If Integer.Parse(drSource("Line")) = 829 Then

                    oRange(iLine, 5) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C4"

                    oRange(iLine, 13) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 13)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C5"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 15) = scrubYear(drSource("C6").ToString())
                    oTempRange = oRange(iLine, 15)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C6"

                    oRange(iLine, 17) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 17)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C7"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 19) = scrubYear(drSource("C8").ToString())
                    oTempRange = oRange(iLine, 19)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C8"

                    oRange(iLine, 21) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 23) = scrubYear(drSource("C10").ToString())
                    oTempRange = oRange(iLine, 23)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C10"

                    oRange(iLine, 25) = "=NULL_VALUE"
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    oRange(iLine, 27) = scrubYear(drSource("C12").ToString())
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                Else
                    'Create source for C12
                    Dim sSource As String = GetSourceForA3P3toP8SummaryColumn(drSource("Line"), iLine)
                    oRange(iLine, 26) = IIf(sSource.Length > 0, "'" + sSource, "")

                    oRange(iLine, 27) = sSource
                    oTempRange = oRange(iLine, 27)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A3L" & drSource("Line").ToString() & "C12"
                End If
            Next

            Dim SSAC_Cells() As String = {"A3L801C2", "A3L801C4", "A3L801C6", "A3L801C8", "A3L801C10",
                              "A3L802C2", "A3L802C4", "A3L802C6", "A3L802C8", "A3L802C10",
                              "A3L803C2", "A3L803C4", "A3L803C6", "A3L803C8", "A3L803C10",
                              "A3L804C2", "A3L804C4", "A3L804C6", "A3L804C8", "A3L804C10",
                              "A3L805C2", "A3L805C4", "A3L805C6", "A3L805C8", "A3L805C10",
                              "A3L806C2", "A3L806C4", "A3L806C6", "A3L806C8", "A3L806C10",
                              "A3L807C2", "A3L807C4", "A3L807C6", "A3L807C8", "A3L807C10",
                              "A3L808C2", "A3L808C4", "A3L808C6", "A3L808C8", "A3L808C10",
                              "A3L809C2", "A3L809C4", "A3L809C6", "A3L809C8", "A3L809C10",
                              "A3L810C2", "A3L810C4", "A3L810C6", "A3L810C8", "A3L810C10",
                              "A3L811C2", "A3L811C4", "A3L811C6", "A3L811C8", "A3L811C10",
                              "A3L812C2", "A3L812C4", "A3L812C6", "A3L812C8", "A3L812C10",
                              "A3L813C2", "A3L813C4", "A3L813C6", "A3L813C8", "A3L813C10",
                              "A3L814C2", "A3L814C4", "A3L814C6", "A3L814C8", "A3L814C10",
                              "A3L815C2", "A3L815C4", "A3L815C6", "A3L815C8", "A3L815C10",
                              "A3L816C2", "A3L816C4", "A3L816C6", "A3L816C8", "A3L816C10",
                              "A3L817C2", "A3L817C4", "A3L817C6", "A3L817C8", "A3L817C10",
                              "A3L818C2", "A3L818C4", "A3L818C6", "A3L818C8", "A3L818C10",
                              "A3L819C2", "A3L819C4", "A3L819C6", "A3L819C8", "A3L819C10",
                              "A3L820C2", "A3L820C4", "A3L820C6", "A3L820C8", "A3L820C10",
                              "A3L821C2", "A3L821C4", "A3L821C6", "A3L821C8", "A3L821C10",
                              "A3L822C2", "A3L822C4", "A3L822C6", "A3L822C8", "A3L822C10",
                              "A3L823C2", "A3L823C4", "A3L823C6", "A3L823C8", "A3L823C10",
                              "A3L824C2", "A3L824C4", "A3L824C6", "A3L824C8", "A3L824C10",
                              "A3L826C2", "A3L826C4", "A3L826C6", "A3L826C8", "A3L826C10",
                              "A3L827C2", "A3L827C4", "A3L827C6", "A3L827C8", "A3L827C10",
                              "A3L828C2", "A3L828C4", "A3L828C6", "A3L828C8", "A3L828C10"}

            'HANDLE SSAC SETTING
            For i As Integer = 8 To 35
                For j As Integer = 5 To 27
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) Then
                        If Not IsNothing(oCell.Value2) Then
                            If SSAC_Cells.Contains(oRange(i, j).Name.Name.ToString()) Then
                                oRange(i, j) = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                            End If
                        End If
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A3P8")

        End Try
    End Sub

    Public Sub A4P1(ByVal index As Integer)

        Dim mWorkStr As String

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A4 PART 1"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "A4P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "A4L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 132 And draValues("aLine") <> 141 And draValues("aLine") <> 145 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        If draValues("aColumn") = 1 Then
                            If draValues("aLine") = 142 Then
                                oRange(iROW_COUNT, 5) = "=IF(INCL_ACCT_76=""N"",0," & draValues("Value").ToString() & ")"
                            ElseIf draValues("aLine") = 143 Then
                                oRange(iROW_COUNT, 5) = "=IF(INCL_ACCT_80=""N"",0," & draValues("Value").ToString() & ")"
                            ElseIf draValues("aLine") = 144 Then
                                oRange(iROW_COUNT, 5) = "=IF(INCL_ACCT_90=""N"",0," & draValues("Value").ToString() & ")"
                            Else
                                oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                            End If

                            oTempRange = oRange(iROW_COUNT, 5)
                            oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C1"
                            oTempRange.NumberFormat = "#,##0"

                        ElseIf draValues("aColumn") = 2 Then
                            oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 7)
                            oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C2"
                            oTempRange.NumberFormat = "#,##0"

                        ElseIf draValues("aColumn") = 3 Then
                            oRange(iROW_COUNT, 9) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 9)
                            oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C3"
                            oTempRange.NumberFormat = "#,##0"
                        End If
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 52
                For j As Integer = 5 To 9
                    If i <> 39 And i <> 48 And i <> 52 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A4L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())

                If Integer.Parse(drSource("Line")) = 132 Or Integer.Parse(drSource("Line")) = 141 Or Integer.Parse(drSource("Line")) = 145 Then

                    oRange(iLine, 5) = scrubYear(drSource("C1").ToString())
                    oTempRange = oRange(iLine, 5)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C1"

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C2"

                    oRange(iLine, 9) = scrubYear(drSource("C3").ToString())
                    oTempRange = oRange(iLine, 9)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C3"

                    oRange(iLine, 11) = scrubYear(drSource("C4").ToString())
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C4"
                Else
                    oRange(iLine, 11) = drSource("C4").ToString()
                    oTempRange = oRange(iLine, 11)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C4"
                End If
            Next

            Dim SSAC_Cells() As String = {"A4L101C1",
                                          "A4L102C1", "A4L102C2", "A4L102C3",
                                          "A4L103C1", "A4L103C2", "A4L103C3",
                                          "A4L104C1", "A4L104C2", "A4L104C3",
                                          "A4L105C1", "A4L105C2", "A4L105C3",
                                          "A4L106C1", "A4L106C2", "A4L106C3",
                                          "A4L107C1", "A4L107C2", "A4L107C3",
                                          "A4L108C1", "A4L108C2", "A4L108C3",
                                          "A4L109C1", "A4L109C2", "A4L109C3",
                                          "A4L110C1", "A4L110C2", "A4L110C3",
                                          "A4L111C1", "A4L111C2", "A4L111C3",
                                          "A4L112C1", "A4L112C2", "A4L112C3",
                                          "A4L113C1", "A4L113C2", "A4L113C3",
                                          "A4L114C1", "A4L114C2", "A4L114C3",
                                          "A4L115C1", "A4L115C2", "A4L115C3",
                                          "A4L116C1", "A4L116C2", "A4L116C3",
                                          "A4L117C1", "A4L117C2", "A4L117C3",
                                          "A4L118C1", "A4L118C2", "A4L118C3",
                                          "A4L119C1", "A4L119C2", "A4L119C3",
                                          "A4L120C1", "A4L120C2", "A4L120C3",
                                          "A4L121C1", "A4L121C2", "A4L121C3",
                                          "A4L122C1", "A4L122C2", "A4L122C3",
                                          "A4L123C1", "A4L123C2", "A4L123C3",
                                          "A4L124C1", "A4L124C2", "A4L124C3",
                                          "A4L126C1", "A4L126C2", "A4L126C3",
                                          "A4L127C1", "A4L127C2", "A4L127C3",
                                          "A4L128C1", "A4L128C2", "A4L128C3",
                                          "A4L129C1",
                                          "A4L130C1",
                                          "A4L131C2", "A4L131C3",
                                          "A4L142C1",
                                          "A4L143C1",
                                          "A4L144C1"}
            'HANDLE SSAC SETTING
            For i As Integer = 8 To 51
                For j As Integer = 5 To 11
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) Then
                        If Not IsNothing(oCell.Value2) Then
                            If SSAC_Cells.Contains(oCell.Name.Name.ToString()) Then
                                'If SSAC_Cells.Contains(oRange(i, j).Name.Name.ToString()) Then
                                'oRange(i, j) = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                                If InStr(oCell.Formula, "=") > 0 Then
                                    mWorkStr = Replace(oCell.Formula.ToString, "=", "=IF(SSAC=""Y"",0,", , 1)
                                    oCell.Formula = mWorkStr & ")"
                                Else
                                    oCell.Value = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                                End If
                            End If
                        End If
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A4P1")

        End Try
    End Sub

    Public Sub A4P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A4 PART 2"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "A4P2"
            iLineNumberOffset = 162
            sNamedRangePrefix = "A4L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)
                If draValues("aLine") <> 176 And draValues("aLine") <> 177 Then

                    Dim iProcessYear = Integer.Parse(draValues("Year"))
                    iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                    If iProcessYear = iCurrentYear Then
                        If draValues("aColumn") = 1 Then
                            oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 5)
                            oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C1"
                            oTempRange.NumberFormat = "#,##0"

                        ElseIf draValues("aColumn") = 2 Then
                            oRange(iROW_COUNT, 7) = draValues("Value").ToString()
                            oTempRange = oRange(iROW_COUNT, 7)
                            oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C2"
                            oTempRange.NumberFormat = "#,##0"

                        End If
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 16
                For j As Integer = 5 To 7
                    If i <> 14 And i <> 15 Then
                        Dim oCaption As Excel.Range = oRange(6, j)
                        Dim oCell As Excel.Range = oRange(i, j)

                        If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                            oRange(i, j) = "=NULL_VALUE"
                            oTempRange = oCell
                            oTempRange.Name = "A4L" & (i + iLineNumberOffset).ToString() &
                                                        oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                            'APPLY FORMATTING
                            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                            oTempRange.NumberFormat = "#######0"
                        End If
                    End If
                Next
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                If Integer.Parse(drSource("Line")) = 176 Or Integer.Parse(drSource("Line")) = 177 Then

                    oRange(iLine, 5) = scrubYear(drSource("C1").ToString())
                    oTempRange = oRange(iLine, 5)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C1"

                    oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "#,##0"
                    oTempRange.Name = "A4L" & drSource("Line").ToString() & "C2"

                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A4P2")

        End Try
    End Sub

    Public Sub A4P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE A4 PART 3"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "A4P3"
            iLineNumberOffset = 193
            sNamedRangePrefix = "A4L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE HARD VALUES FROM aValueS FOR ALL LINES BUT 
            For Each draValues As DataRow In dtAValue.Select(sSelectStringRows)

                Dim iProcessYear = Integer.Parse(draValues("Year"))
                iROW_COUNT = Integer.Parse(draValues("aLine")) - iLineNumberOffset

                If iProcessYear = iCurrentYear Then
                    If draValues("aColumn") = 1 Then
                        oRange(iROW_COUNT, 5) = draValues("Value").ToString()
                        oTempRange = oRange(iROW_COUNT, 5)
                        oTempRange.Name = "A4L" & draValues("aLine").ToString() & "C1"
                        oTempRange.NumberFormat = IIf(Integer.Parse(draValues("aLine")) < 203, "#,##0", "0.0000")
                    End If
                End If
            Next

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                Dim iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                oRange(iLine, 7) = scrubYear(drSource("C2").ToString())
                oTempRange = oRange(iLine, 7)
                oTempRange.NumberFormat = IIf(Integer.Parse(drSource("Line")) < 203, "#,##0", "0.0000")
                oTempRange.Name = "A4L" & drSource("Line").ToString() & "C2"

            Next

            Dim SSAC_Cells() As String = {"A4L201C1", "A4L202C1"}

            'HANDLE SSAC SETTING
            For i As Integer = 8 To 12
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) Then
                        If Not IsNothing(oCell.Value2) Then
                            If SSAC_Cells.Contains(oRange(i, j).Name.Name.ToString()) Then
                                oRange(i, j) = "=IF(SSAC=""Y"",0," & oCell.Value.ToString() & ")"
                            End If
                        End If
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "A4P3")

        End Try
    End Sub

    Public Sub B1P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B1 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B1P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B1L" & drSource("Line").ToString() & "C1"

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B1P1")

        End Try
    End Sub

    Public Sub B2P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B2P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"

                'APPLY FORMATTING
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P1")

        End Try
    End Sub

    Public Sub B2P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 2"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 63
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P2")

        End Try
    End Sub

    Public Sub B2P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 3"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 85
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P3")

        End Try
    End Sub

    Public Sub B2P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 4"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 85
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P4")

        End Try
    End Sub

    Public Sub B2P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 5"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 103
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P5")

        End Try
    End Sub

    Public Sub B2P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 6"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 161
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P6")

        End Try
    End Sub

    Public Sub B2P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 8"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P8"
            iLineNumberOffset = 793
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 52
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P8")

        End Try
    End Sub

    Public Sub B2P9(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B2 PART 9"
            iColumnCount = 7
            iWorkTableColumnCount = 2
            sSheetTitle = "B2P9"
            iLineNumberOffset = 893
            sNamedRangePrefix = "B2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B2L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 42
                For j As Integer = 5 To 7
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B2L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B2P9")

        End Try
    End Sub

    Public Sub B3P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B3P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine < 14, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P1")

        End Try
    End Sub

    Public Sub B3P1A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 1A"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B3P1A"
            iLineNumberOffset = 108
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine < 14, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P1A")

        End Try
    End Sub

    Public Sub B3P1B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 1B"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B3P1B"
            iLineNumberOffset = 123
            sNamedRangePrefix = "B3L"

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine < 14, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P1B")

        End Try
    End Sub

    Public Sub B3P1C(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 1C"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B3P1C"
            iLineNumberOffset = 138
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine < 14, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P1C")

        End Try
    End Sub

    Public Sub B3P1D(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 1D"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B3P1D"
            iLineNumberOffset = 153
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine < 14, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P1D")

        End Try
    End Sub

    Public Sub B3P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 2"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "B3P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 32
                For j As Integer = 5 To 11
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B3L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P2")

        End Try
    End Sub

    Public Sub B3P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 3"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "B3P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(oTempRange.Value >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 44
                For j As Integer = 5 To 13
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B3L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P3")

        End Try
    End Sub

    Public Sub B3P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 4"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "B3P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 41
                For j As Integer = 5 To 13
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B3L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P4")

        End Try
    End Sub

    Public Sub B3P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 5"
            iColumnCount = 31
            iWorkTableColumnCount = 14
            sSheetTitle = "B3P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 31
                For j As Integer = 5 To 31
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B3L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P5")

        End Try
    End Sub

    Public Sub B3P6(ByVal index As Integer)

        Try

            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 6"
            iColumnCount = 9
            iWorkTableColumnCount = 3
            sSheetTitle = "B3P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNumeric(oTempRange.Value) Then
                    oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
                Else
                    oTempRange.NumberFormat = "0.00000"
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNumeric(oTempRange.Value) Then
                    oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
                Else
                    oTempRange.NumberFormat = "0.00000"
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNumeric(oTempRange.Value) Then
                    oTempRange.NumberFormat = IIf(Math.Abs(oTempRange.Value) >= 1 Or oTempRange.Value = 0, "#,##0", "0.00000")
                Else
                    oTempRange.NumberFormat = "0.00000"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P6")

        End Try
    End Sub

    Public Sub B3P7(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 7"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "B3P7"
            iLineNumberOffset = 693
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P7")

        End Try
    End Sub

    Public Sub B3P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B3 PART 8"
            iColumnCount = 57
            iWorkTableColumnCount = 27
            sSheetTitle = "B3P8"
            iLineNumberOffset = 793
            sNamedRangePrefix = "B3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B3L" & drSource("Line").ToString() & "C27"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B3P8")

        End Try
    End Sub

    Public Sub B5P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B5 PART 3"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "B5P3"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset - IIf(Integer.Parse(drSource("Line")) < 300, 0, 198)

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1A"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1B"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1C"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1D"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1E"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1F"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 82
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B5L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B5P3")

        End Try
    End Sub

    Public Sub B5P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B5 PART 4"
            iColumnCount = 29
            iWorkTableColumnCount = 13
            sSheetTitle = "B5P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "B5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 48
                For j As Integer = 5 To 29
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B5L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B5P4")

        End Try
    End Sub

    Public Sub B5P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B5 PART 5"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "B5P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "B5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B5P5")

        End Try
    End Sub

    Public Sub B5P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B5 PART 6"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "B5P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "B5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B5P6")

        End Try
    End Sub

    Public Sub B5P7(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B5 PART 7"
            iColumnCount = 13
            iWorkTableColumnCount = 5
            sSheetTitle = "B5P7"
            iLineNumberOffset = 693
            sNamedRangePrefix = "B5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B5L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 42
                For j As Integer = 5 To 13
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B5L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B5P7")

        End Try
    End Sub

    Public Sub B6P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B6P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P1")

        End Try
    End Sub

    Public Sub B6P2A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 2A"
            iColumnCount = 81
            iWorkTableColumnCount = 39
            sSheetTitle = "B6P2A"
            iLineNumberOffset = 193
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 81
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B6L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P2A")

        End Try
    End Sub

    Public Sub B6P2B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 2B"
            iColumnCount = 81
            iWorkTableColumnCount = 39
            sSheetTitle = "B6P2B"
            iLineNumberOffset = 213
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 81
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B6L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P2B")

        End Try
    End Sub

    Public Sub B6P2C(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 2C"
            iColumnCount = 81
            iWorkTableColumnCount = 39
            sSheetTitle = "B6P2C"
            iLineNumberOffset = 233
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 81
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B6L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P2C")

        End Try
    End Sub

    Public Sub B6P2D(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 2D"
            iColumnCount = 81
            iWorkTableColumnCount = 39
            sSheetTitle = "B6P2D"
            iLineNumberOffset = 253
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 81
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B6L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P2D")

        End Try
    End Sub

    Public Sub B6P2E(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 2E"
            iColumnCount = 81
            iWorkTableColumnCount = 39
            sSheetTitle = "B6P2E"
            iLineNumberOffset = 273
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 81
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = "B6L" & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P2E")

        End Try
    End Sub

    Public Sub B6P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B6 PART 3"
            iColumnCount = 9
            iWorkTableColumnCount = 3
            sSheetTitle = "B6P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "B6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B6L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B6P3")

        End Try
    End Sub

    Public Sub B7P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B7P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B7P1")

        End Try
    End Sub

    Public Sub B7P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 2"
            iColumnCount = 83
            iWorkTableColumnCount = 40
            sSheetTitle = "B7P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = "0.000"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = "0.000"

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = "0.000"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B7P2")

        End Try
    End Sub

    Public Sub B7P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 3"
            iColumnCount = 103
            iWorkTableColumnCount = 50
            sSheetTitle = "B7P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())
                oRange(iLine, 94) = "'" & scrubYear(drSource("C46").ToString())
                oRange(iLine, 96) = "'" & scrubYear(drSource("C47").ToString())
                oRange(iLine, 98) = "'" & scrubYear(drSource("C48").ToString())
                oRange(iLine, 100) = "'" & scrubYear(drSource("C49").ToString())
                oRange(iLine, 102) = "'" & scrubYear(drSource("C50").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C41"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C42"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C43"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C44"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 95) = drSource("C46").ToString()
                oTempRange = oRange(iLine, 95)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C46"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 97) = drSource("C47").ToString()
                oTempRange = oRange(iLine, 97)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C47"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 99) = drSource("C48").ToString()
                oTempRange = oRange(iLine, 99)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C48"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 101) = drSource("C49").ToString()
                oTempRange = oRange(iLine, 101)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C49"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 103) = drSource("C50").ToString()
                oTempRange = oRange(iLine, 103)
                oTempRange.Name = "B7L" & drSource("Line").ToString() & "C50"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, "B7P3")

        End Try
    End Sub

    Public Sub B7P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 4"
            iColumnCount = 103
            iWorkTableColumnCount = 50
            sSheetTitle = "B7P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())
                oRange(iLine, 94) = "'" & scrubYear(drSource("C46").ToString())
                oRange(iLine, 96) = "'" & scrubYear(drSource("C47").ToString())
                oRange(iLine, 98) = "'" & scrubYear(drSource("C48").ToString())
                oRange(iLine, 100) = "'" & scrubYear(drSource("C49").ToString())
                oRange(iLine, 102) = "'" & scrubYear(drSource("C50").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C41"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C42"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C43"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C44"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 95) = drSource("C46").ToString()
                oTempRange = oRange(iLine, 95)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C46"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 97) = drSource("C47").ToString()
                oTempRange = oRange(iLine, 97)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C47"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 99) = drSource("C48").ToString()
                oTempRange = oRange(iLine, 99)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C48"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 101) = drSource("C49").ToString()
                oTempRange = oRange(iLine, 101)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C49"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 103) = drSource("C50").ToString()
                oTempRange = oRange(iLine, 103)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C50"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B7P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 5"
            iColumnCount = 123
            iWorkTableColumnCount = 60
            sSheetTitle = "B7P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())
                oRange(iLine, 94) = "'" & scrubYear(drSource("C46").ToString())
                oRange(iLine, 96) = "'" & scrubYear(drSource("C47").ToString())
                oRange(iLine, 98) = "'" & scrubYear(drSource("C48").ToString())
                oRange(iLine, 100) = "'" & scrubYear(drSource("C49").ToString())
                oRange(iLine, 102) = "'" & scrubYear(drSource("C50").ToString())
                oRange(iLine, 104) = "'" & scrubYear(drSource("C51").ToString())
                oRange(iLine, 106) = "'" & scrubYear(drSource("C52").ToString())
                oRange(iLine, 108) = "'" & scrubYear(drSource("C53").ToString())
                oRange(iLine, 110) = "'" & scrubYear(drSource("C54").ToString())
                oRange(iLine, 112) = "'" & scrubYear(drSource("C55").ToString())
                oRange(iLine, 114) = "'" & scrubYear(drSource("C56").ToString())
                oRange(iLine, 116) = "'" & scrubYear(drSource("C57").ToString())
                oRange(iLine, 118) = "'" & scrubYear(drSource("C58").ToString())
                oRange(iLine, 120) = "'" & scrubYear(drSource("C59").ToString())
                oRange(iLine, 122) = "'" & scrubYear(drSource("C60").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C41"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C42"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C43"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C44"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 95) = drSource("C46").ToString()
                oTempRange = oRange(iLine, 95)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C46"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 97) = drSource("C47").ToString()
                oTempRange = oRange(iLine, 97)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C47"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 99) = drSource("C48").ToString()
                oTempRange = oRange(iLine, 99)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C48"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 101) = drSource("C49").ToString()
                oTempRange = oRange(iLine, 101)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C49"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 103) = drSource("C50").ToString()
                oTempRange = oRange(iLine, 103)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C50"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 105) = drSource("C51").ToString()
                oTempRange = oRange(iLine, 105)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C51"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 107) = drSource("C52").ToString()
                oTempRange = oRange(iLine, 107)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C52"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 109) = drSource("C53").ToString()
                oTempRange = oRange(iLine, 109)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C53"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 111) = drSource("C54").ToString()
                oTempRange = oRange(iLine, 111)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C54"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 113) = drSource("C55").ToString()
                oTempRange = oRange(iLine, 113)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C55"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 115) = drSource("C56").ToString()
                oTempRange = oRange(iLine, 115)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C56"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 117) = drSource("C57").ToString()
                oTempRange = oRange(iLine, 117)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C57"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 119) = drSource("C58").ToString()
                oTempRange = oRange(iLine, 119)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C58"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 121) = drSource("C59").ToString()
                oTempRange = oRange(iLine, 121)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C59"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 123) = drSource("C60").ToString()
                oTempRange = oRange(iLine, 123)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C60"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B7P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 6"
            iColumnCount = 123
            iWorkTableColumnCount = 60
            sSheetTitle = "B7P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())
                oRange(iLine, 94) = "'" & scrubYear(drSource("C46").ToString())
                oRange(iLine, 96) = "'" & scrubYear(drSource("C47").ToString())
                oRange(iLine, 98) = "'" & scrubYear(drSource("C48").ToString())
                oRange(iLine, 100) = "'" & scrubYear(drSource("C49").ToString())
                oRange(iLine, 102) = "'" & scrubYear(drSource("C50").ToString())
                oRange(iLine, 104) = "'" & scrubYear(drSource("C51").ToString())
                oRange(iLine, 106) = "'" & scrubYear(drSource("C52").ToString())
                oRange(iLine, 108) = "'" & scrubYear(drSource("C53").ToString())
                oRange(iLine, 110) = "'" & scrubYear(drSource("C54").ToString())
                oRange(iLine, 112) = "'" & scrubYear(drSource("C55").ToString())
                oRange(iLine, 114) = "'" & scrubYear(drSource("C56").ToString())
                oRange(iLine, 116) = "'" & scrubYear(drSource("C57").ToString())
                oRange(iLine, 118) = "'" & scrubYear(drSource("C58").ToString())
                oRange(iLine, 120) = "'" & scrubYear(drSource("C59").ToString())
                oRange(iLine, 122) = "'" & scrubYear(drSource("C60").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C41"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C42"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C43"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C44"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 95) = drSource("C46").ToString()
                oTempRange = oRange(iLine, 95)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C46"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 97) = drSource("C47").ToString()
                oTempRange = oRange(iLine, 97)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C47"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 99) = drSource("C48").ToString()
                oTempRange = oRange(iLine, 99)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C48"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 101) = drSource("C49").ToString()
                oTempRange = oRange(iLine, 101)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C49"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 103) = drSource("C50").ToString()
                oTempRange = oRange(iLine, 103)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C50"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 105) = drSource("C51").ToString()
                oTempRange = oRange(iLine, 105)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C51"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 107) = drSource("C52").ToString()
                oTempRange = oRange(iLine, 107)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C52"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 109) = drSource("C53").ToString()
                oTempRange = oRange(iLine, 109)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C53"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 111) = drSource("C54").ToString()
                oTempRange = oRange(iLine, 111)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C54"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 113) = drSource("C55").ToString()
                oTempRange = oRange(iLine, 113)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C55"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 115) = drSource("C56").ToString()
                oTempRange = oRange(iLine, 115)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C56"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 117) = drSource("C57").ToString()
                oTempRange = oRange(iLine, 117)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C57"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 119) = drSource("C58").ToString()
                oTempRange = oRange(iLine, 119)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C58"
                oTempRange.NumberFormat = "0.00"

                oRange(iLine, 121) = drSource("C59").ToString()
                oTempRange = oRange(iLine, 121)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C59"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 123) = drSource("C60").ToString()
                oTempRange = oRange(iLine, 123)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C60"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B7P7(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 7"
            iColumnCount = 83
            iWorkTableColumnCount = 40
            sSheetTitle = "B7P7"
            iLineNumberOffset = 693
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = "0.0"

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B7P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B7 PART 8"
            iColumnCount = 93
            iWorkTableColumnCount = 45
            sSheetTitle = "B7P8"
            iLineNumberOffset = 793
            sNamedRangePrefix = "B7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())
                oRange(iLine, 78) = "'" & scrubYear(drSource("C38").ToString())
                oRange(iLine, 80) = "'" & scrubYear(drSource("C39").ToString())
                oRange(iLine, 82) = "'" & scrubYear(drSource("C40").ToString())
                oRange(iLine, 84) = "'" & scrubYear(drSource("C41").ToString())
                oRange(iLine, 86) = "'" & scrubYear(drSource("C42").ToString())
                oRange(iLine, 88) = "'" & scrubYear(drSource("C43").ToString())
                oRange(iLine, 90) = "'" & scrubYear(drSource("C44").ToString())
                oRange(iLine, 92) = "'" & scrubYear(drSource("C45").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 81) = drSource("C39").ToString()
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C41"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 87) = drSource("C42").ToString()
                oTempRange = oRange(iLine, 87)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C42"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 89) = drSource("C43").ToString()
                oTempRange = oRange(iLine, 89)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C43"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 91) = drSource("C44").ToString()
                oTempRange = oRange(iLine, 91)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C44"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")

                oRange(iLine, 93) = drSource("C45").ToString()
                oTempRange = oRange(iLine, 93)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C45"
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B8P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B8 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "B8P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B9P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B9 PART 1"
            iColumnCount = 57
            iWorkTableColumnCount = 27
            sSheetTitle = "B9P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "B9L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 33
                For j As Integer = 5 To 57
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B9P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B9 PART 2"
            iColumnCount = 77
            iWorkTableColumnCount = 37
            sSheetTitle = "B9P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "B9L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())
                oRange(iLine, 62) = "'" & scrubYear(drSource("C30").ToString())
                oRange(iLine, 64) = "'" & scrubYear(drSource("C31").ToString())
                oRange(iLine, 66) = "'" & scrubYear(drSource("C32").ToString())
                oRange(iLine, 68) = "'" & scrubYear(drSource("C33").ToString())
                oRange(iLine, 70) = "'" & scrubYear(drSource("C34").ToString())
                oRange(iLine, 72) = "'" & scrubYear(drSource("C35").ToString())
                oRange(iLine, 74) = "'" & scrubYear(drSource("C36").ToString())
                oRange(iLine, 76) = "'" & scrubYear(drSource("C37").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 77) = drSource("C37").ToString()
                oTempRange = oRange(iLine, 77)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B9P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B9 PART 3"
            iColumnCount = 57
            iWorkTableColumnCount = 27
            sSheetTitle = "B9P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "B9L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B9P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B9 PART 4"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "B9P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "B9L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 89
                For j As Integer = 5 To 11
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub B9P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE B9 PART 5"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "B9P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "B9L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                If IsNothing(oTempRange.Value) OrElse oTempRange.Value.ToString() <> "n/a" Then
                    oTempRange.NumberFormat = IIf(Integer.TryParse(oTempRange.Value, 0) Or Math.Abs(oTempRange.Value) > 1000, "#,##0", "0.00000")
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub C(ByVal index As Integer)

        Try
            For i = 1 To 15
                'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
                sSheetTitle = "C" + (i + IIf(i = 15, 1, 0)).ToString

                'GET OUR SHEET AND A RANGE
                oXLWsheet = oBook.Sheets(i + index - 1)
                oXLWsheet.Name = sSheetTitle

                'FREEZE THE ROWS AND COLUMNS
                oXLWsheet.Select()
                oXLWsheet.Application.ActiveWindow.SplitRow = 9
                oXLWsheet.Application.ActiveWindow.SplitColumn = 3
                oXLWsheet.Application.ActiveWindow.FreezePanes = True

                'WRITE OUT TITLE AND COLUMN HEADERS AND DETAILS
                WriteTitlesForPartC()
                WriteDetailsForPartC(i + IIf(i = 15, 1, 0))

                UpdateStatus(sSheetTitle & " completed")
            Next

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub CSummary(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE C SUMMARY"
            iColumnCount = 10
            sSheetTitle = "CSP1"
            sNamedRangePrefix = "CR"

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = "C Summary"

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'Finally, Deal with the column header formatting
            sColumnRange = "A7:J7"
            oRange = oXLWsheet.Range(sColumnRange)
            With oRange
                .HorizontalAlignment = Excel.XlVAlign.xlVAlignCenter
                .Offset.WrapText = True
                .Borders.LineStyle = Excel.XlLineStyle.xlContinuous
                .Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlDouble
                .RowHeight = 26
                .ColumnWidth = 14
                .Font.Bold = True
            End With

            'Setup custom columns
            oRange = oXLWsheet.Columns(1)
            oRange.ColumnWidth = 4.5

            oRange = oXLWsheet.Columns(2)
            oRange.ColumnWidth = 4.5

            oRange = oXLWsheet.Columns(3)
            oRange.ColumnWidth = 10

            oRange = oXLWsheet.Columns(4)
            oRange.ColumnWidth = 63

            oRange = oXLWsheet.Columns(5)
            oRange.ColumnWidth = 44

            'SET PAGE LAYOUT
            With oXLWsheet.PageSetup
                .Orientation = Excel.XlPageOrientation.xlLandscape
                .Zoom = 60
            End With

            oRange = oXLWsheet.Cells
            dtRegression.DefaultView.Sort = "Regr_No ASC"

            Dim iLine As Integer
            For Each drSource As DataRow In dtRegression.Rows

                iLine = Integer.Parse(drSource("Regr_No")) + 7

                oRange(iLine, 1) = drSource("Regr_No").ToString()
                If Integer.Parse(drSource("Regr_No")) <> 15 Then
                    oRange(iLine, 2) = "C" & drSource("Regr_No").ToString()
                    oRange(iLine, 3) = drSource("Regr_Name").ToString()
                    oRange(iLine, 4) = drSource("Regr_Desc").ToString()
                    oRange(iLine, 5) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "T4"

                    oRange(iLine, 6) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "L1"
                    oTempRange = oRange(iLine, 6)
                    oTempRange.NumberFormat = "0.000%"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

                    oRange(iLine, 7) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "L2"
                    oTempRange = oRange(iLine, 7)
                    oTempRange.NumberFormat = "0.000%"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

                    oRange(iLine, 8) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "L3"
                    oTempRange = oRange(iLine, 8)
                    oTempRange.NumberFormat = "0.000%"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

                    oRange(iLine, 9) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "L4"
                    oTempRange = oRange(iLine, 9)
                    oTempRange.NumberFormat = "0.000%"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

                    oRange(iLine, 10) = "=" & sNamedRangePrefix & drSource("Regr_No").ToString() & "L5"
                    oTempRange = oRange(iLine, 10)
                    oTempRange.NumberFormat = "0.000%"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter
                End If
            Next

            sColumnRange = "F8:J23"
            oVariabilityMatrix = oXLWsheet.Range(sColumnRange)
            oVariabilityMatrix.Name = "VariabilityMatrix"

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D1P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D1 PART 1"
            iColumnCount = 45
            iWorkTableColumnCount = 21
            sSheetTitle = "D1P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""
            Dim sDistributionVariableName2 As String = ""
            Dim sDistributionVariableName3 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 28) = "'" & drSource("C13").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 36) = "'" & drSource("C17").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()
                oRange(iLine, 42) = "'" & drSource("C20").ToString()
                oRange(iLine, 44) = "'" & drSource("C21").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length > 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C12").ToString().Length > 0 Then
                    oRange(iLine, 27) = "=" + drDefinition("Distrib_Pct_2")
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C17").ToString().Length > 0 Then
                    oRange(iLine, 37) = "=" + drDefinition("Distrib_Pct_3")
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If Integer.Parse(drSource("Line")) > 109 And Integer.Parse(drSource("Line")) < 114 Or Integer.Parse(drSource("Line")) = 157 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    'Select Case Integer.Parse(drDefinition("Var_Code"))
                    '    Case 1
                    '        oRange(iLine, 10) = "'=INDEX(VariabilityMatrix," & sNamedRangePrefix & drSource("Line").ToString & "C1," & sNamedRangePrefix & drSource("Line").ToString & "C8)"
                    '        oRange(iLine, 11) = "=INDEX(VariabilityMatrix," & sNamedRangePrefix & drSource("Line").ToString & "C1," & sNamedRangePrefix & drSource("Line").ToString & "C8)"
                    '    Case 2
                    '        oRange(iLine, 10) = "'=" & drDefinition("Default_Pct_Var")
                    '        oRange(iLine, 11) = drDefinition("Default_Pct_Var")
                    '    Case 3
                    '        oRange(iLine, 10) = "'=" & sNamedRangePrefix & drDefinition("Default_Line") & "C4"
                    '        oRange(iLine, 11) = "=" & sNamedRangePrefix & drDefinition("Default_Line") & "C4"
                    '    Case Else
                    '        oRange(iLine, 10) = "'=0"
                    '        oRange(iLine, 11) = "=0"
                    'End Select

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                    oRange(iLine, 20) = "'" & sTempString
                    oRange(iLine, 21) = sTempString
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C14").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_2"), sDistributionVariableName2))
                    oRange(iLine, 30) = "'" & sTempString
                    oRange(iLine, 31) = sTempString
                    oTempRange = oRange(iLine, 31)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C19").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_3"), sDistributionVariableName3))
                    oRange(iLine, 40) = "'" & sTempString
                    oRange(iLine, 41) = sTempString
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 64
                For j As Integer = 5 To 45
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2
            oRange(7, 25) = sDistributionVariableName1 + vbCrLf + oRange(7, 25).Value2

            oRange(7, 27) = sDistributionVariableName2 + vbCrLf + oRange(7, 27).Value2
            oRange(7, 29) = oRange(7, 29).Value2 + vbCrLf + sDistributionVariableName2
            oRange(7, 31) = sDistributionVariableName2 + vbCrLf + oRange(7, 31).Value2
            oRange(7, 33) = sDistributionVariableName2 + vbCrLf + oRange(7, 33).Value2
            oRange(7, 35) = sDistributionVariableName2 + vbCrLf + oRange(7, 35).Value2

            oRange(7, 37) = sDistributionVariableName3 + vbCrLf + oRange(7, 37).Value2
            oRange(7, 39) = oRange(7, 39).Value2 + vbCrLf + sDistributionVariableName3
            oRange(7, 41) = sDistributionVariableName3 + vbCrLf + oRange(7, 41).Value2
            oRange(7, 43) = sDistributionVariableName3 + vbCrLf + oRange(7, 43).Value2
            oRange(7, 45) = sDistributionVariableName3 + vbCrLf + oRange(7, 45).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Private Sub SetVariabilityPercentage(ByRef Range As Excel.Range, ByRef Definition As DataRow, ByRef Source As DataRow,
                                         ByVal Line As Integer, ByVal Column As Integer, ByVal NamedRangePrefix As String,
                                         ByVal MatrixColumn As String, ByVal DefinitionColumn As String)

        Dim sReturn As String

        Select Case Integer.Parse(Definition("Var_Code"))
            Case 1
                sReturn = "=IF(FLOW_THRU_100PCT=""Y"",1,INDEX(VariabilityMatrix," & NamedRangePrefix & Source("Line").ToString & "C1," & NamedRangePrefix & Source("Line").ToString & MatrixColumn & "))"
            Case 2
                sReturn = "=IF(FLOW_THRU_100PCT=""Y"",1," & Definition("Default_Pct_Var") & ")"
            Case 3
                sReturn = "=IF(FLOW_THRU_100PCT=""Y"",1," & NamedRangePrefix & Definition("Default_Line") & DefinitionColumn & ")"
            Case Else
                sReturn = "=0"
        End Select

        Range(Line, Column) = "'" & sReturn
        Range(Line, Column + 1) = sReturn

    End Sub

    Public Sub D1P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D1 PART 2"
            iColumnCount = 39
            iWorkTableColumnCount = 18
            sSheetTitle = "D1P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC1 As Excel.Range = Nothing
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""
            Dim sDistributionVariableName2 As String = ""
            Dim sDistributionVariableName3 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 30) = "'" & drSource("C14").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length > 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C11").ToString().Length > 0 Then
                    oRange(iLine, 25) = "=" + drDefinition("Distrib_Pct_2")
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C15").ToString().Length > 0 Then
                    oRange(iLine, 33) = "=" + drDefinition("Distrib_Pct_3")
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oC1 = oRange(iLine, 5)

                If Integer.Parse(drSource("Line")) = 234 Or Integer.Parse(drSource("Line")) = 251 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                    oRange(iLine, 20) = "'" & sTempString
                    oRange(iLine, 21) = sTempString
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C13").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_2"), sDistributionVariableName2))
                    oRange(iLine, 28) = "'" & sTempString
                    oRange(iLine, 29) = sTempString
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C17").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_3"), sDistributionVariableName3))
                    oRange(iLine, 36) = "'" & sTempString
                    oRange(iLine, 37) = sTempString
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 58
                For j As Integer = 5 To 39
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2

            oRange(7, 25) = sDistributionVariableName2 + vbCrLf + oRange(7, 25).Value2
            oRange(7, 27) = oRange(7, 27).Value2 + vbCrLf + sDistributionVariableName2
            oRange(7, 29) = sDistributionVariableName2 + vbCrLf + oRange(7, 29).Value2
            oRange(7, 31) = sDistributionVariableName2 + vbCrLf + oRange(7, 31).Value2

            oRange(7, 33) = sDistributionVariableName3 + vbCrLf + oRange(7, 33).Value2
            oRange(7, 35) = oRange(7, 35).Value2 + vbCrLf + sDistributionVariableName3
            oRange(7, 37) = sDistributionVariableName3 + vbCrLf + oRange(7, 37).Value2
            oRange(7, 39) = sDistributionVariableName3 + vbCrLf + oRange(7, 39).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D2P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D2 PART 1"
            iColumnCount = 25
            iWorkTableColumnCount = 11
            sSheetTitle = "D2P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length <> 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                oRange(iLine, 20) = "'" & sTempString
                oRange(iLine, 21) = sTempString
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If (Integer.Parse(drSource("Line")) > 109 And Integer.Parse(drSource("Line")) < 114) Or Integer.Parse(drSource("Line")) > 156 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If Integer.Parse(drSource("Line")) = 158 Then
                        oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 19)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 66
                For j As Integer = 5 To 25
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2
            oRange(7, 25) = sDistributionVariableName1 + vbCrLf + oRange(7, 25).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D2P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D2 PART 2"
            iColumnCount = 23
            iWorkTableColumnCount = 10
            sSheetTitle = "D2P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length > 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If Integer.Parse(drSource("Line")) = 234 Or Integer.Parse(drSource("Line")) = 236 Or
                    Integer.Parse(drSource("Line")) = 253 Or Integer.Parse(drSource("Line")) = 255 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                    oRange(iLine, 20) = "'" & sTempString
                    oRange(iLine, 21) = sTempString
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 62
                For j As Integer = 5 To 23
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D3P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D3 PART 1"
            iColumnCount = 85
            iWorkTableColumnCount = 41
            sSheetTitle = "D3P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""
            Dim sDistributionVariableName2 As String = ""
            Dim sDistributionVariableName3 As String = ""
            Dim sDistributionVariableName4 As String = ""
            Dim sDistributionVariableName5 As String = ""
            Dim sDistributionVariableName6 As String = ""
            Dim sDistributionVariableName7 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()

                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 28) = "'" & drSource("C13").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()

                oRange(iLine, 36) = "'" & drSource("C17").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()
                oRange(iLine, 42) = "'" & drSource("C20").ToString()
                oRange(iLine, 44) = "'" & drSource("C21").ToString()

                oRange(iLine, 46) = "'" & drSource("C22").ToString()
                oRange(iLine, 48) = "'" & drSource("C23").ToString()
                oRange(iLine, 52) = "'" & drSource("C25").ToString()
                oRange(iLine, 54) = "'" & drSource("C26").ToString()

                oRange(iLine, 56) = "'" & drSource("C27").ToString()
                oRange(iLine, 58) = "'" & drSource("C28").ToString()
                oRange(iLine, 62) = "'" & drSource("C30").ToString()
                oRange(iLine, 64) = "'" & drSource("C31").ToString()

                oRange(iLine, 66) = "'" & drSource("C32").ToString()
                oRange(iLine, 68) = "'" & drSource("C33").ToString()
                oRange(iLine, 72) = "'" & drSource("C35").ToString()
                oRange(iLine, 74) = "'" & drSource("C36").ToString()

                oRange(iLine, 76) = "'" & drSource("C37").ToString()
                oRange(iLine, 78) = "'" & drSource("C38").ToString()
                oRange(iLine, 82) = "'" & drSource("C40").ToString()
                oRange(iLine, 84) = "'" & drSource("C41").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length > 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                oRange(iLine, 20) = "'" & sTempString
                oRange(iLine, 21) = sTempString
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C12").ToString().Length > 0 Then
                    oRange(iLine, 27) = "=" + drDefinition("Distrib_Pct_2")
                    oTempRange = oRange(iLine, 27)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C14").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_2"), sDistributionVariableName2))
                oRange(iLine, 30) = "'" & sTempString
                oRange(iLine, 31) = sTempString
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C17").ToString().Length > 0 Then
                    oRange(iLine, 37) = "=" + drDefinition("Distrib_Pct_3")
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C19").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_3"), sDistributionVariableName3))
                oRange(iLine, 40) = "'" & sTempString
                oRange(iLine, 41) = sTempString
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C22").ToString().Length > 0 Then
                    oRange(iLine, 47) = "=" + drDefinition("Distrib_Pct_4")
                    oTempRange = oRange(iLine, 47)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C24").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_4"), sDistributionVariableName4))
                oRange(iLine, 50) = "'" & sTempString
                oRange(iLine, 51) = sTempString
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C27").ToString().Length > 0 Then
                    oRange(iLine, 57) = "=" + drDefinition("Distrib_Pct_5")
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C29").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_5"), sDistributionVariableName5))
                oRange(iLine, 60) = "'" & sTempString
                oRange(iLine, 61) = sTempString
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 65) = drSource("C31").ToString()
                oTempRange = oRange(iLine, 65)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C32").ToString().Length > 0 Then
                    oRange(iLine, 67) = "=" + drDefinition("Distrib_Pct_6")
                    oTempRange = oRange(iLine, 67)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 69) = drSource("C33").ToString()
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C34").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_6"), sDistributionVariableName6))
                oRange(iLine, 70) = "'" & sTempString
                oRange(iLine, 71) = sTempString
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 73) = drSource("C35").ToString()
                oTempRange = oRange(iLine, 73)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C35"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 75) = drSource("C36").ToString()
                oTempRange = oRange(iLine, 75)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C36"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If drSource("C37").ToString().Length > 0 Then
                    oRange(iLine, 77) = "=" + drDefinition("Distrib_Pct_7")
                    oTempRange = oRange(iLine, 77)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C37"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 79) = drSource("C38").ToString()
                oTempRange = oRange(iLine, 79)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C38"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C39").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_7"), sDistributionVariableName7))
                oRange(iLine, 80) = "'" & sTempString
                oRange(iLine, 81) = sTempString
                oTempRange = oRange(iLine, 81)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C39"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 83) = drSource("C40").ToString()
                oTempRange = oRange(iLine, 83)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C40"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 85) = drSource("C41").ToString()
                oTempRange = oRange(iLine, 85)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C41"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If (Integer.Parse(drSource("Line")) > 168 And Integer.Parse(drSource("Line")) < 173) Or Integer.Parse(drSource("Line")) = 191 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 98
                For j As Integer = 5 To 85
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2
            oRange(7, 25) = sDistributionVariableName1 + vbCrLf + oRange(7, 25).Value2

            oRange(7, 27) = sDistributionVariableName2 + vbCrLf + oRange(7, 27).Value2
            oRange(7, 29) = oRange(7, 29).Value2 + vbCrLf + sDistributionVariableName2
            oRange(7, 31) = sDistributionVariableName2 + vbCrLf + oRange(7, 31).Value2
            oRange(7, 33) = sDistributionVariableName2 + vbCrLf + oRange(7, 33).Value2
            oRange(7, 35) = sDistributionVariableName2 + vbCrLf + oRange(7, 35).Value2

            oRange(7, 37) = sDistributionVariableName3 + vbCrLf + oRange(7, 37).Value2
            oRange(7, 39) = oRange(7, 39).Value2 + vbCrLf + sDistributionVariableName3
            oRange(7, 41) = sDistributionVariableName3 + vbCrLf + oRange(7, 41).Value2
            oRange(7, 43) = sDistributionVariableName3 + vbCrLf + oRange(7, 43).Value2
            oRange(7, 45) = sDistributionVariableName3 + vbCrLf + oRange(7, 45).Value2

            oRange(7, 47) = sDistributionVariableName4 + vbCrLf + oRange(7, 47).Value2
            oRange(7, 49) = oRange(7, 49).Value2 + vbCrLf + sDistributionVariableName4
            oRange(7, 51) = sDistributionVariableName4 + vbCrLf + oRange(7, 51).Value2
            oRange(7, 53) = sDistributionVariableName4 + vbCrLf + oRange(7, 53).Value2
            oRange(7, 55) = sDistributionVariableName4 + vbCrLf + oRange(7, 55).Value2

            oRange(7, 57) = sDistributionVariableName5 + vbCrLf + oRange(7, 57).Value2
            oRange(7, 59) = oRange(7, 59).Value2 + vbCrLf + sDistributionVariableName5
            oRange(7, 61) = sDistributionVariableName5 + vbCrLf + oRange(7, 61).Value2
            oRange(7, 63) = sDistributionVariableName5 + vbCrLf + oRange(7, 63).Value2
            oRange(7, 65) = sDistributionVariableName5 + vbCrLf + oRange(7, 65).Value2

            oRange(7, 67) = sDistributionVariableName6 + vbCrLf + oRange(7, 67).Value2
            oRange(7, 69) = oRange(7, 69).Value2 + vbCrLf + sDistributionVariableName6
            oRange(7, 71) = sDistributionVariableName6 + vbCrLf + oRange(7, 71).Value2
            oRange(7, 73) = sDistributionVariableName6 + vbCrLf + oRange(7, 73).Value2
            oRange(7, 75) = sDistributionVariableName6 + vbCrLf + oRange(7, 75).Value2

            oRange(7, 77) = sDistributionVariableName7 + vbCrLf + oRange(7, 77).Value2
            oRange(7, 79) = oRange(7, 79).Value2 + vbCrLf + sDistributionVariableName7
            oRange(7, 81) = sDistributionVariableName7 + vbCrLf + oRange(7, 81).Value2
            oRange(7, 83) = sDistributionVariableName7 + vbCrLf + oRange(7, 83).Value2
            oRange(7, 85) = sDistributionVariableName7 + vbCrLf + oRange(7, 85).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D3P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D3 PART 2"
            iColumnCount = 71
            iWorkTableColumnCount = 34
            sSheetTitle = "D3P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D3L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""
            Dim sDistributionVariableName2 As String = ""
            Dim sDistributionVariableName3 As String = ""
            Dim sDistributionVariableName4 As String = ""
            Dim sDistributionVariableName5 As String = ""
            Dim sDistributionVariableName6 As String = ""
            Dim sDistributionVariableName7 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()

                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 28) = "'" & drSource("C13").ToString()
                oRange(iLine, 30) = "'" & drSource("C14").ToString()

                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 36) = "'" & drSource("C17").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()

                oRange(iLine, 40) = "'" & drSource("C19").ToString()
                oRange(iLine, 42) = "'" & drSource("C20").ToString()
                oRange(iLine, 44) = "'" & drSource("C21").ToString()
                oRange(iLine, 46) = "'" & drSource("C22").ToString()

                oRange(iLine, 48) = "'" & drSource("C23").ToString()
                oRange(iLine, 50) = "'" & drSource("C24").ToString()
                oRange(iLine, 52) = "'" & drSource("C25").ToString()
                oRange(iLine, 54) = "'" & drSource("C26").ToString()

                oRange(iLine, 56) = "'" & drSource("C27").ToString()
                oRange(iLine, 58) = "'" & drSource("C28").ToString()
                oRange(iLine, 60) = "'" & drSource("C29").ToString()
                oRange(iLine, 62) = "'" & drSource("C30").ToString()

                oRange(iLine, 64) = "'" & drSource("C31").ToString()
                oRange(iLine, 66) = "'" & drSource("C32").ToString()
                oRange(iLine, 68) = "'" & drSource("C33").ToString()
                oRange(iLine, 70) = "'" & drSource("C34").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If drSource("C6").ToString().Length > 0 Then
                    oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                    oTempRange = oRange(iLine, 15)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                oRange(iLine, 20) = "'" & sTempString
                oRange(iLine, 21) = sTempString
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C11").ToString().Length > 0 Then
                    oRange(iLine, 25) = "=" + drDefinition("Distrib_Pct_2")
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C13").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_2"), sDistributionVariableName2))
                oRange(iLine, 28) = "'" & sTempString
                oRange(iLine, 29) = sTempString
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C15").ToString().Length > 0 Then
                    oRange(iLine, 33) = "=" + drDefinition("Distrib_Pct_3")
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C17").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_3"), sDistributionVariableName3))
                oRange(iLine, 36) = "'" & sTempString
                oRange(iLine, 37) = sTempString
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C19").ToString().Length > 0 Then
                    oRange(iLine, 41) = "=" + drDefinition("Distrib_Pct_4")
                    oTempRange = oRange(iLine, 41)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C21").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_4"), sDistributionVariableName4))
                oRange(iLine, 44) = "'" & sTempString
                oRange(iLine, 45) = sTempString
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C23").ToString().Length > 0 Then
                    oRange(iLine, 49) = "=" + drDefinition("Distrib_Pct_5")
                    oTempRange = oRange(iLine, 49)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C25").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_5"), sDistributionVariableName5))
                oRange(iLine, 52) = "'" & sTempString
                oRange(iLine, 53) = sTempString
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C27").ToString().Length > 0 Then
                    oRange(iLine, 57) = "=" + drDefinition("Distrib_Pct_6")
                    oTempRange = oRange(iLine, 57)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C29").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_6"), sDistributionVariableName6))
                oRange(iLine, 60) = "'" & sTempString
                oRange(iLine, 61) = sTempString
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 63) = drSource("C30").ToString()
                oTempRange = oRange(iLine, 63)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C30"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C31").ToString().Length > 0 Then
                    oRange(iLine, 65) = "=" + drDefinition("Distrib_Pct_7")
                    oTempRange = oRange(iLine, 65)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C31"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 67) = drSource("C32").ToString()
                oTempRange = oRange(iLine, 67)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C32"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C33").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_7"), sDistributionVariableName7))
                oRange(iLine, 68) = "'" & sTempString
                oRange(iLine, 69) = sTempString
                oTempRange = oRange(iLine, 69)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C33"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 71) = drSource("C34").ToString()
                oTempRange = oRange(iLine, 71)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C34"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If Integer.Parse(drSource("Line")) = 217 Or Integer.Parse(drSource("Line")) = 224 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 31
                For j As Integer = 5 To 71
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2

            oRange(7, 25) = sDistributionVariableName2 + vbCrLf + oRange(7, 25).Value2
            oRange(7, 27) = oRange(7, 27).Value2 + vbCrLf + sDistributionVariableName2
            oRange(7, 29) = sDistributionVariableName2 + vbCrLf + oRange(7, 29).Value2
            oRange(7, 31) = sDistributionVariableName2 + vbCrLf + oRange(7, 31).Value2

            oRange(7, 33) = sDistributionVariableName3 + vbCrLf + oRange(7, 33).Value2
            oRange(7, 35) = oRange(7, 35).Value2 + vbCrLf + sDistributionVariableName3
            oRange(7, 37) = sDistributionVariableName3 + vbCrLf + oRange(7, 37).Value2
            oRange(7, 39) = sDistributionVariableName3 + vbCrLf + oRange(7, 39).Value2

            oRange(7, 41) = sDistributionVariableName4 + vbCrLf + oRange(7, 41).Value2
            oRange(7, 43) = oRange(7, 43).Value2 + vbCrLf + sDistributionVariableName4
            oRange(7, 45) = sDistributionVariableName4 + vbCrLf + oRange(7, 45).Value2
            oRange(7, 47) = sDistributionVariableName4 + vbCrLf + oRange(7, 47).Value2

            oRange(7, 49) = sDistributionVariableName5 + vbCrLf + oRange(7, 49).Value2
            oRange(7, 51) = oRange(7, 51).Value2 + vbCrLf + sDistributionVariableName5
            oRange(7, 53) = sDistributionVariableName5 + vbCrLf + oRange(7, 53).Value2
            oRange(7, 55) = sDistributionVariableName5 + vbCrLf + oRange(7, 55).Value2

            oRange(7, 57) = sDistributionVariableName6 + vbCrLf + oRange(7, 57).Value2
            oRange(7, 59) = oRange(7, 59).Value2 + vbCrLf + sDistributionVariableName6
            oRange(7, 61) = sDistributionVariableName6 + vbCrLf + oRange(7, 61).Value2
            oRange(7, 63) = sDistributionVariableName6 + vbCrLf + oRange(7, 63).Value2

            oRange(7, 65) = sDistributionVariableName7 + vbCrLf + oRange(7, 65).Value2
            oRange(7, 67) = oRange(7, 67).Value2 + vbCrLf + sDistributionVariableName7
            oRange(7, 69) = sDistributionVariableName7 + vbCrLf + oRange(7, 69).Value2
            oRange(7, 71) = sDistributionVariableName7 + vbCrLf + oRange(7, 71).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D4P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D4 PART 1"
            iColumnCount = 25
            iWorkTableColumnCount = 11
            sSheetTitle = "D4P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D4L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                oRange(iLine, 20) = "'" & sTempString
                oRange(iLine, 21) = sTempString
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                If Integer.Parse(drSource("Line")) = 157 Or Integer.Parse(drSource("Line")) = 159 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length <> 0 Then
                        oRange(iLine, 15) = drSource("C6").ToString()
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length <> 0 Then
                        oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 66
                For j As Integer = 5 To 25
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2
            oRange(7, 25) = sDistributionVariableName1 + vbCrLf + oRange(7, 25).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Private Function GetDistributionSources(DistributionVariable As String, ByRef VariableName As String) As String
        Dim drRegressionDistribution As DataRow

        drRegressionDistribution = dtRegressionDistribution.Select("Distrib_Var_No = " & DistributionVariable)(0)

        VariableName = drRegressionDistribution("Distrib_Var_Name")

        Return String.Join(",", drRegressionDistribution("Source_1yr"),
                                drRegressionDistribution("Source_2yr"),
                                drRegressionDistribution("Source_3yr"),
                                drRegressionDistribution("Source_4yr"),
                                drRegressionDistribution("Source_5yr"))

    End Function

    Public Sub D4P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D4 PART 2"
            iColumnCount = 23
            iWorkTableColumnCount = 10
            sSheetTitle = "D4P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D4L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If Integer.Parse(drSource("Line")) = 211 Or Integer.Parse(drSource("Line")) = 213 Or
                    Integer.Parse(drSource("Line")) = 218 Or Integer.Parse(drSource("Line")) = 220 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length > 0 Then
                        oRange(iLine, 15) = drSource("C6").ToString()
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length > 0 Then
                        oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                    oRange(iLine, 20) = "'" & sTempString
                    oRange(iLine, 21) = sTempString
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS 
            '(IsNothing(oCell.Value2) OrElse oCell.Text = "#VALUE!")

            For i As Integer = 8 To 27
                For j As Integer = 5 To 23
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D5P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D5 PART 1"
            iColumnCount = 39
            iWorkTableColumnCount = 18
            sSheetTitle = "D5P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D5L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""
            Dim sDistributionVariableName2 As String = ""
            Dim sDistributionVariableName3 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 30) = "'" & drSource("C14").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C11").ToString().Length > 0 Then
                    oRange(iLine, 25) = "=" + drDefinition("Distrib_Pct_2")
                    oTempRange = oRange(iLine, 25)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If drSource("C15").ToString().Length > 0 Then
                    oRange(iLine, 33) = "=" + drDefinition("Distrib_Pct_3")
                    oTempRange = oRange(iLine, 33)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.000%"
                End If

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                Dim formatCondition As Excel.FormatCondition = oTempRange.FormatConditions.Add(Excel.XlFormatConditionType.xlCellValue, Excel.XlFormatConditionOperator.xlEqual, "=0")
                formatCondition.SetFirstPriority()
                formatCondition.NumberFormat = "#,##0"

                If Integer.Parse(drSource("Line")) > 120 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length > 0 Then
                        oRange(iLine, 15) = drSource("C6").ToString()
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C8", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drSource("C6").ToString().Length > 0 Then
                        oRange(iLine, 15) = "=" + drDefinition("Distrib_Pct_1")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.000%"
                    End If

                    oRange(iLine, 18) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 19) = "=" & drDefinition("Annual_Period_Source")

                    oTempRange = oRange(iLine, 19)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                    sTempString = drSource("C9").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_1"), sDistributionVariableName1))
                    oRange(iLine, 20) = "'" & sTempString
                    oRange(iLine, 21) = sTempString
                    oTempRange = oRange(iLine, 21)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C13").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_2"), sDistributionVariableName2))
                    oRange(iLine, 28) = "'" & sTempString
                    oRange(iLine, 29) = sTempString
                    oTempRange = oRange(iLine, 29)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    sTempString = drSource("C17").ToString().Replace("XXXXX", GetDistributionSources(drDefinition("Distrib_Var_3"), sDistributionVariableName3))
                    oRange(iLine, 36) = "'" & sTempString
                    oRange(iLine, 37) = sTempString
                    oTempRange = oRange(iLine, 37)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 29
                For j As Integer = 5 To 39
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            'Adjust report headers
            oRange(7, 15) = sDistributionVariableName1 + vbCrLf + oRange(7, 15).Value2
            oRange(7, 17) = oRange(7, 17).Value2 + vbCrLf + sDistributionVariableName1
            oRange(7, 21) = sDistributionVariableName1 + vbCrLf + oRange(7, 21).Value2
            oRange(7, 23) = sDistributionVariableName1 + vbCrLf + oRange(7, 23).Value2

            oRange(7, 25) = sDistributionVariableName2 + vbCrLf + oRange(7, 25).Value2
            oRange(7, 27) = oRange(7, 27).Value2 + vbCrLf + sDistributionVariableName2
            oRange(7, 29) = sDistributionVariableName2 + vbCrLf + oRange(7, 29).Value2
            oRange(7, 31) = sDistributionVariableName2 + vbCrLf + oRange(7, 31).Value2

            oRange(7, 33) = sDistributionVariableName3 + vbCrLf + oRange(7, 33).Value2
            oRange(7, 35) = oRange(7, 35).Value2 + vbCrLf + sDistributionVariableName3
            oRange(7, 37) = sDistributionVariableName3 + vbCrLf + oRange(7, 37).Value2
            oRange(7, 39) = sDistributionVariableName3 + vbCrLf + oRange(7, 39).Value2

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D6P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D6 PART 1"
            iColumnCount = 25
            iWorkTableColumnCount = 11
            sSheetTitle = "D6P1"
            iLineNumberOffset = -7
            sNamedRangePrefix = "D6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing
            Dim sTempString As String = ""
            Dim sDistributionVariableName1 As String = ""

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 10) = "'" & drSource("C4").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()
                oRange(iLine, 20) = "'" & drSource("C9").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If Integer.Parse(drSource("Line")) > 17 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 6, sNamedRangePrefix, "C3", "C2")

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    oRange(iLine, 8) = "'=" & drDefinition("Annual_Period_Source")
                    oRange(iLine, 9) = "=" & drDefinition("Annual_Period_Source")
                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 26
                For j As Integer = 5 To 25
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub D6P1A_P17(ByVal index As Integer, ByVal PartNumber As String)

        Dim iPageLineNumberOffset As Integer = 100 * (index - 103)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D6 PART " & PartNumber
            iColumnCount = 53
            iWorkTableColumnCount = 25
            sSheetTitle = "D6P" & PartNumber
            iLineNumberOffset = 93 + iPageLineNumberOffset
            sNamedRangePrefix = "D6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 28) = "'" & drSource("C13").ToString()
                oRange(iLine, 30) = "'" & drSource("C14").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 36) = "'" & drSource("C17").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()
                oRange(iLine, 40) = "'" & drSource("C19").ToString()
                oRange(iLine, 42) = "'" & drSource("C20").ToString()
                oRange(iLine, 44) = "'" & drSource("C21").ToString()
                oRange(iLine, 46) = "'" & drSource("C22").ToString()
                oRange(iLine, 48) = "'" & drSource("C23").ToString()
                oRange(iLine, 50) = "'" & drSource("C24").ToString()
                oRange(iLine, 52) = "'" & drSource("C25").ToString()

                'Derived (sources & values)
                If drSource("C1").ToString().Length > 0 Then
                    oRange(iLine, 5) = drDefinition("Regr_No")
                    oTempRange = oRange(iLine, 5)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                End If

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.000%"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000000"

                If Integer.Parse(drSource("Line")) = 128 + iPageLineNumberOffset Or
                    Integer.Parse(drSource("Line")) = 137 + iPageLineNumberOffset Or
                    Integer.Parse(drSource("Line")) > 139 + iPageLineNumberOffset Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drSource("Line")) <> 1735 And Integer.Parse(drSource("Line")) <> 1736 Then
                        If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                            oRange(iLine, 6) = "'=0"
                            oRange(iLine, 7) = "0"
                        Else
                            oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                            oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                        End If

                        oTempRange = oRange(iLine, 7)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#,##0"

                        oC2 = oRange(iLine, 7)
                        If oC2.Value2 <> 0 Then
                            oRange(iLine, 8) = "'=0"
                            oRange(iLine, 9) = "0"
                        Else
                            oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                            oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                        End If

                        oTempRange = oRange(iLine, 9)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#,##0"

                        SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C9", "C4")

                        oTempRange = oRange(iLine, 11)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 20) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 21) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 21)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 48
                For j As Integer = 5 To 53
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D6P18(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D6 PART 18"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D6P18"
            iLineNumberOffset = 1793
            sNamedRangePrefix = "D6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 1819 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 26
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D6P19(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D6 PART 19"
            iColumnCount = 27
            iWorkTableColumnCount = 12
            sSheetTitle = "D6P19"
            iLineNumberOffset = 1893
            sNamedRangePrefix = "D6L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)
                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 6) = "'" & drSource("C2").ToString()
                oRange(iLine, 8) = "'" & drSource("C3").ToString()
                oRange(iLine, 10) = "'" & drSource("C4").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()
                oRange(iLine, 20) = "'" & drSource("C9").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 31
                For j As Integer = 5 To 27
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 1"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 136 Or Integer.Parse(drSource("Line")) = 143 Or Integer.Parse(drSource("Line")) = 146 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 53
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 2"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 236 Or Integer.Parse(drSource("Line")) = 243 Or Integer.Parse(drSource("Line")) = 246 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 53
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 3"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 383 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 90
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 4"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 424 Or Integer.Parse(drSource("Line")) = 431 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 38
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P5(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 5"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P5"
            iLineNumberOffset = 493
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 583 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 90
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 6"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 624 Or Integer.Parse(drSource("Line")) = 631 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 38
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P7A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 7A"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P7A"
            iLineNumberOffset = 693
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 721 Or Integer.Parse(drSource("Line")) = 724 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 32
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P7B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 7B"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P7B"
            iLineNumberOffset = 718
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 733 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 15
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P7C(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 7C"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P7C"
            iLineNumberOffset = 726
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 741 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 15
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P8(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 8"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P8"
            iLineNumberOffset = 793
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 823 Or Integer.Parse(drSource("Line")) = 826 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 34
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P9(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 9"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P9"
            iLineNumberOffset = 893
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 923 Or Integer.Parse(drSource("Line")) = 926 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 34
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P10(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 10"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P10"
            iLineNumberOffset = 993
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 1023 Or Integer.Parse(drSource("Line")) = 1026 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 34
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P11(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 11"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P11"
            iLineNumberOffset = 1093
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 1123 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 30
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P12(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 12"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P12"
            iLineNumberOffset = 1193
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 1208 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 15
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D7P13(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D7 PART 13"
            iColumnCount = 19
            iWorkTableColumnCount = 8
            sSheetTitle = "D7P13"
            iLineNumberOffset = 1293
            sNamedRangePrefix = "D7L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                If Integer.Parse(drSource("Line")) = 1323 Or Integer.Parse(drSource("Line")) = 1326 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 34
                For j As Integer = 5 To 19
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 1"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "D8P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 2"
            iColumnCount = 15
            iWorkTableColumnCount = 6
            sSheetTitle = "D8P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer
            Dim drDefinition As DataRow
            Dim oC2 As Excel.Range = Nothing

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset
                drDefinition = dtDefinitions.Select("Worktable = '" & sSheetTitle & "' AND Line = " & Integer.Parse(drSource("Line")))(0)

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drDefinition("Regr_No")
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"

                If Integer.Parse(drSource("Line")) = 325 Or Integer.Parse(drSource("Line")) = 326 Or Integer.Parse(drSource("Line")) = 327 Or
                    Integer.Parse(drSource("Line")) = 354 Or Integer.Parse(drSource("Line")) = 355 Or Integer.Parse(drSource("Line")) = 356 Or
                    Integer.Parse(drSource("Line")) = 368 Or Integer.Parse(drSource("Line")) = 369 Or Integer.Parse(drSource("Line")) = 370 Then
                    'Summary lines
                    oRange(iLine, 6) = "'" & drSource("C2").ToString()
                    oRange(iLine, 7) = drSource("C2").ToString()

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 8) = "'" & drSource("C3").ToString()
                    oRange(iLine, 9) = drSource("C3").ToString()

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oRange(iLine, 10) = "'" & drSource("C4").ToString()
                    oRange(iLine, 11) = drSource("C4").ToString()

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"
                Else
                    'Detail lines
                    If Integer.Parse(drDefinition("Default_Code")) <> 0 Or Integer.Parse(drDefinition("Regr_No")) = 0 Then
                        oRange(iLine, 6) = "'=0"
                        oRange(iLine, 7) = "0"
                    Else
                        oRange(iLine, 6) = "'=" & drDefinition("Regr_Exp_Source")
                        oRange(iLine, 7) = "=" & drDefinition("Regr_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 7)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    oC2 = oRange(iLine, 7)
                    If oC2.Value2 <> 0 Then
                        oRange(iLine, 8) = "'=0"
                        oRange(iLine, 9) = "0"
                    Else
                        oRange(iLine, 8) = "'=" & drDefinition("Default_Exp_Source")
                        oRange(iLine, 9) = "=" & drDefinition("Default_Exp_Source")
                    End If

                    oTempRange = oRange(iLine, 9)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "#,##0"

                    SetVariabilityPercentage(oRange, drDefinition, drSource, iLine, 10, sNamedRangePrefix, "C6", "C4")

                    oTempRange = oRange(iLine, 11)
                    oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                    oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    oTempRange.NumberFormat = "0.00000"

                    If drDefinition("Annual_Period_Source").ToString().Length > 0 Then
                        oRange(iLine, 14) = "'=" & drDefinition("Annual_Period_Source")
                        oRange(iLine, 15) = "=" & drDefinition("Annual_Period_Source")
                        oTempRange = oRange(iLine, 15)
                        oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                    End If
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 177
                For j As Integer = 5 To 15
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P4(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 4"
            iColumnCount = 11
            iWorkTableColumnCount = 4
            sSheetTitle = "D8P4"
            iLineNumberOffset = 393
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 6) = "'" & drSource("C2").ToString()
                oRange(iLine, 8) = "'" & drSource("C3").ToString()
                oRange(iLine, 10) = "'" & drSource("C4").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine = 49, "0.00000", "#,##0")

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine = 56, "0.00000", "#,##0")

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine = 63, "0.00000", "#,##0")

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = IIf(iLine = 49 Or iLine = 56 Or iLine = 63, "0.00000", "#,##0")
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 63
                For j As Integer = 5 To 11
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P6(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 6"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "D8P6"
            iLineNumberOffset = 593
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "#,##0"
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P7A(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 7A"
            iColumnCount = 15
            iWorkTableColumnCount = 6
            sSheetTitle = "D8P7A"
            iLineNumberOffset = 693
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 6) = "'" & drSource("C2").ToString()
                oRange(iLine, 8) = "'" & drSource("C3").ToString()
                oRange(iLine, 10) = "'" & drSource("C4").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 41
                For j As Integer = 5 To 15
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub D8P7B(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE D8 PART 7B"
            iColumnCount = 55
            iWorkTableColumnCount = 26
            sSheetTitle = "D8P7B"
            iLineNumberOffset = 793
            sNamedRangePrefix = "D8L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle
            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            Dim iLine As Integer

            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first (static)
                oRange(iLine, 4) = "'" & drSource("C1").ToString()
                oRange(iLine, 6) = "'" & drSource("C2").ToString()
                oRange(iLine, 8) = "'" & drSource("C3").ToString()
                oRange(iLine, 10) = "'" & drSource("C4").ToString()
                oRange(iLine, 12) = "'" & drSource("C5").ToString()
                oRange(iLine, 14) = "'" & drSource("C6").ToString()
                oRange(iLine, 16) = "'" & drSource("C7").ToString()
                oRange(iLine, 18) = "'" & drSource("C8").ToString()
                oRange(iLine, 20) = "'" & drSource("C9").ToString()
                oRange(iLine, 22) = "'" & drSource("C10").ToString()
                oRange(iLine, 24) = "'" & drSource("C11").ToString()
                oRange(iLine, 26) = "'" & drSource("C12").ToString()
                oRange(iLine, 28) = "'" & drSource("C13").ToString()
                oRange(iLine, 30) = "'" & drSource("C14").ToString()
                oRange(iLine, 32) = "'" & drSource("C15").ToString()
                oRange(iLine, 34) = "'" & drSource("C16").ToString()
                oRange(iLine, 36) = "'" & drSource("C17").ToString()
                oRange(iLine, 38) = "'" & drSource("C18").ToString()
                oRange(iLine, 40) = "'" & drSource("C19").ToString()
                oRange(iLine, 42) = "'" & drSource("C20").ToString()
                oRange(iLine, 44) = "'" & drSource("C21").ToString()
                oRange(iLine, 46) = "'" & drSource("C22").ToString()
                oRange(iLine, 48) = "'" & drSource("C23").ToString()
                oRange(iLine, 50) = "'" & drSource("C24").ToString()
                oRange(iLine, 52) = "'" & drSource("C25").ToString()
                oRange(iLine, 54) = "'" & drSource("C26").ToString()

                'Derived (sources & values)
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                oTempRange.NumberFormat = "0.00000"
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 27
                For j As Integer = 5 To 55
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "0.00000"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try

    End Sub

    Public Sub E1P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E1 PART 1"
            iColumnCount = 9
            iWorkTableColumnCount = 3
            sSheetTitle = "E1P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "E1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 29
                For j As Integer = 5 To 9
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub E1P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E1 PART 2"
            iColumnCount = 29
            iWorkTableColumnCount = 13
            sSheetTitle = "E1P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "E1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 28
                For j As Integer = 5 To 29
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub E1P3(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E1 PART 3"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "E1P3"
            iLineNumberOffset = 293
            sNamedRangePrefix = "E1L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 89
                For j As Integer = 5 To 5
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub E2P1(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E2 PART 1"
            iColumnCount = 61
            iWorkTableColumnCount = 29
            sSheetTitle = "E2P1"
            iLineNumberOffset = 93
            sNamedRangePrefix = "E2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())
                oRange(iLine, 6) = "'" & scrubYear(drSource("C2").ToString())
                oRange(iLine, 8) = "'" & scrubYear(drSource("C3").ToString())
                oRange(iLine, 10) = "'" & scrubYear(drSource("C4").ToString())
                oRange(iLine, 12) = "'" & scrubYear(drSource("C5").ToString())
                oRange(iLine, 14) = "'" & scrubYear(drSource("C6").ToString())
                oRange(iLine, 16) = "'" & scrubYear(drSource("C7").ToString())
                oRange(iLine, 18) = "'" & scrubYear(drSource("C8").ToString())
                oRange(iLine, 20) = "'" & scrubYear(drSource("C9").ToString())
                oRange(iLine, 22) = "'" & scrubYear(drSource("C10").ToString())
                oRange(iLine, 24) = "'" & scrubYear(drSource("C11").ToString())
                oRange(iLine, 26) = "'" & scrubYear(drSource("C12").ToString())
                oRange(iLine, 28) = "'" & scrubYear(drSource("C13").ToString())
                oRange(iLine, 30) = "'" & scrubYear(drSource("C14").ToString())
                oRange(iLine, 32) = "'" & scrubYear(drSource("C15").ToString())
                oRange(iLine, 34) = "'" & scrubYear(drSource("C16").ToString())
                oRange(iLine, 36) = "'" & scrubYear(drSource("C17").ToString())
                oRange(iLine, 38) = "'" & scrubYear(drSource("C18").ToString())
                oRange(iLine, 40) = "'" & scrubYear(drSource("C19").ToString())
                oRange(iLine, 42) = "'" & scrubYear(drSource("C20").ToString())
                oRange(iLine, 44) = "'" & scrubYear(drSource("C21").ToString())
                oRange(iLine, 46) = "'" & scrubYear(drSource("C22").ToString())
                oRange(iLine, 48) = "'" & scrubYear(drSource("C23").ToString())
                oRange(iLine, 50) = "'" & scrubYear(drSource("C24").ToString())
                oRange(iLine, 52) = "'" & scrubYear(drSource("C25").ToString())
                oRange(iLine, 54) = "'" & scrubYear(drSource("C26").ToString())
                oRange(iLine, 56) = "'" & scrubYear(drSource("C27").ToString())
                oRange(iLine, 58) = "'" & scrubYear(drSource("C28").ToString())
                oRange(iLine, 60) = "'" & scrubYear(drSource("C29").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 7) = drSource("C2").ToString()
                oTempRange = oRange(iLine, 7)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C2"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 9) = drSource("C3").ToString()
                oTempRange = oRange(iLine, 9)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C3"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 11) = drSource("C4").ToString()
                oTempRange = oRange(iLine, 11)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C4"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 13) = drSource("C5").ToString()
                oTempRange = oRange(iLine, 13)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C5"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 15) = drSource("C6").ToString()
                oTempRange = oRange(iLine, 15)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C6"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 17) = drSource("C7").ToString()
                oTempRange = oRange(iLine, 17)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C7"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 19) = drSource("C8").ToString()
                oTempRange = oRange(iLine, 19)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C8"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 21) = drSource("C9").ToString()
                oTempRange = oRange(iLine, 21)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C9"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 23) = drSource("C10").ToString()
                oTempRange = oRange(iLine, 23)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C10"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 25) = drSource("C11").ToString()
                oTempRange = oRange(iLine, 25)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C11"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 27) = drSource("C12").ToString()
                oTempRange = oRange(iLine, 27)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C12"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 29) = drSource("C13").ToString()
                oTempRange = oRange(iLine, 29)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C13"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 31) = drSource("C14").ToString()
                oTempRange = oRange(iLine, 31)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C14"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 33) = drSource("C15").ToString()
                oTempRange = oRange(iLine, 33)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C15"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 35) = drSource("C16").ToString()
                oTempRange = oRange(iLine, 35)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C16"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 37) = drSource("C17").ToString()
                oTempRange = oRange(iLine, 37)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C17"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 39) = drSource("C18").ToString()
                oTempRange = oRange(iLine, 39)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C18"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 41) = drSource("C19").ToString()
                oTempRange = oRange(iLine, 41)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C19"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 43) = drSource("C20").ToString()
                oTempRange = oRange(iLine, 43)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C20"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 45) = drSource("C21").ToString()
                oTempRange = oRange(iLine, 45)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C21"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 47) = drSource("C22").ToString()
                oTempRange = oRange(iLine, 47)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C22"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 49) = drSource("C23").ToString()
                oTempRange = oRange(iLine, 49)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C23"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 51) = drSource("C24").ToString()
                oTempRange = oRange(iLine, 51)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C24"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 53) = drSource("C25").ToString()
                oTempRange = oRange(iLine, 53)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C25"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 55) = drSource("C26").ToString()
                oTempRange = oRange(iLine, 55)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C26"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 57) = drSource("C27").ToString()
                oTempRange = oRange(iLine, 57)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C27"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 59) = drSource("C28").ToString()
                oTempRange = oRange(iLine, 59)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C28"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

                oRange(iLine, 61) = drSource("C29").ToString()
                oTempRange = oRange(iLine, 61)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C29"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE HARD VALUES FROM aValueS REGION VALUES
            For Each drAValueRegion As DataRow In dtAValueRegion_RR.Select(sSelectStringRows)

                iLine = Integer.Parse(drAValueRegion("aLine"))
                If drAValueRegion("Year") = iCurrentYear And drAValueRegion("Code") = "C1" Then
                    iROW_COUNT = iLine - iLineNumberOffset

                    oRange(iROW_COUNT, 5) = drAValueRegion("Value").ToString()
                    oTempRange = oRange(iROW_COUNT, 5)
                    oTempRange.Name = sNamedRangePrefix & drAValueRegion("aLine").ToString() & "C1"
                End If
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 25
                For j As Integer = 5 To 61
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then
                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub E2P2(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E2 PART 2"
            iColumnCount = 5
            iWorkTableColumnCount = 1
            sSheetTitle = "E2P2"
            iLineNumberOffset = 193
            sNamedRangePrefix = "E2L"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = sSheetTitle

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            'WRITE OUT THE FIRST 3 COLUMNS
            WriteFirst3ColumnsAndPageLayout()

            'WRITE OUT THE SOURCES AND ANY VALUES THAT EXECUTE THE SOURCE
            Dim iLine As Integer
            For Each drSource As DataRow In dtLineSourceText.Select(sSelectStringRows)

                iLine = Integer.Parse(drSource("Line")) - iLineNumberOffset

                'Sources first
                oRange(iLine, 4) = "'" & scrubYear(drSource("C1").ToString())

                'Derived Values
                oRange(iLine, 5) = drSource("C1").ToString()
                oTempRange = oRange(iLine, 5)
                oTempRange.Name = sNamedRangePrefix & drSource("Line").ToString() & "C1"
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'WRITE RANGE NAMES FOR EMPTY CELLS
            For i As Integer = 8 To 27
                For j As Integer = 5 To 5
                    Dim oCaption As Excel.Range = oRange(6, j)
                    Dim oCell As Excel.Range = oRange(i, j)

                    If Not IsNothing(oCaption.Value) And IsNothing(oCell.Value2) Then

                        oRange(i, j) = "=NULL_VALUE"
                        oTempRange = oCell
                        oTempRange.Name = sNamedRangePrefix & (i + iLineNumberOffset).ToString() &
                                                    oCaption.Value.ToString().Replace("(", "").Replace(")", "")

                        'APPLY FORMATTING
                        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
                        oTempRange.NumberFormat = "#######0"
                    End If
                Next
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex as system.exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

    Public Sub ESummary(ByVal index As Integer)

        Try
            'BUILD THE WORKTABLE TITLE AND SET WORKTABLE VARS
            sTitle_WORKTABLE = "WORKTABLE E SUMMARY"
            iColumnCount = 7
            sSheetTitle = "ESP1"
            'sNamedRangePrefix = "CR"

            UpdateStatus("Processing " & sSheetTitle)

            Try
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 2) & "'"
            Catch
                sSelectWorktable = "Worktable = '" & sSheetTitle.Substring(0, 2) & "' And Part = '" & sSheetTitle.Substring((sSheetTitle.IndexOf("P") + 1), 1) & "'"
            End Try
            sSelectStringRows = "Rpt_sheet = '" & sSheetTitle & "'"

            'GET OUR SHEET AND A RANGE
            oXLWsheet = oBook.Sheets(index)
            oXLWsheet.Name = "E Summary"

            'FREEZE THE ROWS AND COLUMNS
            oXLWsheet.Select()
            oXLWsheet.Application.ActiveWindow.SplitRow = 7
            oXLWsheet.Application.ActiveWindow.SplitColumn = 3
            oXLWsheet.Application.ActiveWindow.FreezePanes = True

            'WRITE OUT TITLE AND COLUMN HEADERS
            WriteTitlesAndColumnHeaders()

            oRange = oXLWsheet.Columns(3)
            oRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            'Setup custom columns
            oRange = oXLWsheet.Columns(1)
            oRange.ColumnWidth = 6

            oRange = oXLWsheet.Columns(2)
            oRange.ColumnWidth = 8

            oRange = oXLWsheet.Columns(3)
            oRange.ColumnWidth = 10

            oRange = oXLWsheet.Columns(4)
            oRange.ColumnWidth = 10

            oRange = oXLWsheet.Columns(5)
            oRange.ColumnWidth = 20

            oRange = oXLWsheet.Columns(6)
            oRange.ColumnWidth = 12

            oRange = oXLWsheet.Columns(7)
            oRange.ColumnWidth = 15

            oRange = oXLWsheet.Cells

            Dim iLine As Integer = 7
            For Each drECode As DataRow In dtECodes.Rows
                iLine = iLine + 1

                oRange(iLine, 1) = "=CURRENT_YEAR"
                oRange(iLine, 2) = "=RRICC"
                oRange(iLine, 3) = "=RR_ID"
                oRange(iLine, 4) = "=RR_SHORT_NAME"
                oRange(iLine, 5) = "=RR_NAME"
                oRange(iLine, 6) = drECode("ECode").ToString()
                oRange(iLine, 7) = "=" & drECode("ECode").ToString()

                oTempRange = oRange(iLine, 7)
                oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight
            Next

            'Clean up
            For i As Integer = 971 To 980
                Dim oCell As Excel.Range = oRange(i, 7)

                If oCell.Text = "#NAME?" Then
                    oRange(i, 7) = "=0"
                End If
            Next

            UpdateStatus(sSheetTitle & " completed")

        Catch ex As System.Exception

            'write the error out to the sql error table
            oDB.HandleError(iCurrentYear.ToString, "Error", ex.Message.ToString(), ex.StackTrace, sSheetTitle)

        End Try
    End Sub

#Region "Private Methods"

    ''' <summary>
    ''' Writes the Titles and Column headers to each page
    ''' </summary>
    ''' <remarks></remarks>
    ''' 
    Private Sub WriteTitlesForPartC()
        oRange = oXLWsheet.Cells

        oRange.Font.Name = "Consolas"
        oRange.Font.Size = 10
        oRange(1, 1) = sTitle_RR_YEAR
        oTempRange = oRange(1, 1)
        oTempRange.Font.Italic = True

        For Each drTitles As DataRow In dtTitles.Select("Worktable = 'C'")
            oRange(2, 2) = drTitles("Title1").ToString().Split("|")(0)
            oTempRange = oRange(2, 2)
            oTempRange.Font.Bold = True
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

            oRange(3, 2) = drTitles("Title1").ToString().Split("|")(1)
            oTempRange = oRange(3, 2)
            oTempRange.Font.Bold = True
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

            oRange(4, 2) = drTitles("Title2").ToString().Split("|")(0)
            oTempRange = oRange(4, 2)
            oTempRange.Font.Bold = True
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

            oRange(5, 2) = drTitles("Title2").ToString().Split("|")(1)
            oTempRange = oRange(5, 2)
            oTempRange.Font.Bold = True
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignRight

            oRange(7, 2) = drTitles("Title3").ToString().Split("|")(0)
            oTempRange = oRange(7, 2)

            oRange(9, 3) = drTitles("rpt_col1").ToString()
            oTempRange = oRange(9, 3)
            oTempRange.Font.Bold = True

            oRange(9, 4) = drTitles("rpt_col2").ToString()
            oTempRange = oRange(9, 4)
            oTempRange.Font.Bold = True

            oRange(9, 5) = drTitles("rpt_col3").ToString()
            oTempRange = oRange(9, 5)
            oTempRange.Font.Bold = True

            oRange(9, 6) = drTitles("rpt_col4").ToString()
            oTempRange = oRange(9, 6)
            oTempRange.Font.Bold = True

            oRange(9, 7) = drTitles("rpt_col5").ToString()
            oTempRange = oRange(9, 7)
            oTempRange.Font.Bold = True

            oRange(9, 8) = drTitles("rpt_col6").ToString()
            oTempRange = oRange(9, 8)
            oTempRange.Font.Bold = True

            oRange(9, 9) = drTitles("rpt_col7").ToString()
            oTempRange = oRange(9, 9)
            oTempRange.Font.Bold = True

            oRange(10, 3) = "CURRENT YEAR"
            oTempRange = oRange(10, 3)

            oRange(11, 3) = "2 YEAR AVERAGE"
            oTempRange = oRange(11, 3)

            oRange(12, 3) = "3 YEAR AVERAGE"
            oTempRange = oRange(12, 3)

            oRange(13, 3) = "4 YEAR AVERAGE"
            oTempRange = oRange(13, 3)

            oRange(14, 3) = "5 YEAR AVERAGE"
            oTempRange = oRange(14, 3)

            oRange(16, 2) = drTitles("Title3").ToString().Split("|")(1)

            oRange(18, 2) = drTitles("rpt_col8").ToString()
            oTempRange = oRange(18, 2)

            oRange(18, 3) = drTitles("rpt_col9").ToString()
            oTempRange = oRange(18, 3)

            oRange(18, 4) = drTitles("rpt_col10").ToString()
            oTempRange = oRange(18, 4)

            oRange(18, 5) = drTitles("rpt_col11").ToString()
            oTempRange = oRange(18, 5)
        Next

        'Finally, Deal with the column header formatting
        sColumnRange = "C9:I9"
        oRange = oXLWsheet.Range(sColumnRange)
        With oRange
            .HorizontalAlignment = Excel.XlVAlign.xlVAlignCenter
            .Offset.WrapText = True
            .Borders.LineStyle = Excel.XlLineStyle.xlContinuous
            .Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlDouble
            .RowHeight = 26
            .ColumnWidth = 15
            .Font.Bold = True
        End With

        sColumnRange = "B18:E18"
        oRange = oXLWsheet.Range(sColumnRange)
        With oRange
            .HorizontalAlignment = Excel.XlVAlign.xlVAlignCenter
            .Offset.WrapText = True
            .Borders.LineStyle = Excel.XlLineStyle.xlContinuous
            .Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlDouble
            .Font.Bold = True
        End With

        'Setup custom columns
        oRange = oXLWsheet.Columns(1)
        oRange.ColumnWidth = 8

        oRange = oXLWsheet.Columns(2)
        oRange.ColumnWidth = 8

        oRange = oXLWsheet.Columns(3)
        oRange.ColumnWidth = 30

        oRange = oXLWsheet.Columns(8)
        oRange.ColumnWidth = 75

        'SET PAGE LAYOUT
        With oXLWsheet.PageSetup
            .Orientation = Excel.XlPageOrientation.xlLandscape
            .Zoom = 60
        End With

    End Sub

    Private Sub WriteDetailsForPartC(PartNumber As Integer)
        oRange = oXLWsheet.Cells
        sNamedRangePrefix = "CR"

        Dim drRegression As DataRow = dtRegression.Select("Regr_No=" + PartNumber.ToString())(0)

        oRange(2, 3) = PartNumber.ToString()
        oTempRange = oRange(2, 3)
        oTempRange.Font.Bold = True
        oTempRange.Name = sNamedRangePrefix & PartNumber.ToString() & "T1"
        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

        oRange(3, 3) = drRegression("Regr_Desc")
        oTempRange = oRange(3, 3)
        oTempRange.Font.Bold = True
        oTempRange.Font.Size = 12
        oTempRange.Name = sNamedRangePrefix & PartNumber.ToString() & "T2"
        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

        oRange(4, 3) = drRegression("Regr_Name")
        oTempRange = oRange(4, 3)
        oTempRange.Font.Bold = True
        oTempRange.Name = sNamedRangePrefix & PartNumber.ToString() & "T3"
        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

        oRange(5, 3) = drRegression("Regr_Name").ToString() + " = (" +
                        drRegression("Cap_Coeff").ToString() + " * " + drRegression("Cap_Var").ToString() + ") + (" +
                        drRegression("Out_Coeff").ToString() + " * " + drRegression("Out_Var").ToString() + ")"
        oTempRange = oRange(5, 3)
        oTempRange.Font.Bold = True
        oTempRange.Name = sNamedRangePrefix & PartNumber.ToString() & "T4"
        oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

        For i As Integer = 1 To 5
            oRange(9 + i, 4) = drRegression("Out_Source_" + i.ToString() + "yr")
            oTempRange = oRange(9 + i, 4)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(9 + i, 5) = drRegression("Out_Coeff")
            oTempRange = oRange(9 + i, 5)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(9 + i, 6) = drRegression("Cap_Source_" + i.ToString() + "yr")
            oTempRange = oRange(9 + i, 6)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(9 + i, 7) = drRegression("Cap_Coeff")
            oTempRange = oRange(9 + i, 7)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            Dim sVarEquaion As String = GetVariabilityEquation(drRegression("Out_Source_" + i.ToString() + "yr"),
                                                               drRegression("Out_Coeff"),
                                                               drRegression("Cap_Source_" + i.ToString() + "yr"),
                                                               drRegression("Cap_Coeff"))

            oRange(9 + i, 8) = "'" + sVarEquaion
            oTempRange = oRange(9 + i, 8)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(9 + i, 9) = sVarEquaion
            oTempRange = oRange(9 + i, 9)
            oTempRange.NumberFormat = "00.0%"
            oTempRange.Name = sNamedRangePrefix & PartNumber.ToString() & "L" & i.ToString()
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter
        Next

        oRange(16, 2) = oRange(16, 2).value2 + drRegression("Regr_Name")
        oTempRange = oRange(16, 2)

        Dim iCounter As Integer = 1
        For Each oRow As DataRow In dtRegressionDependentVariable.Select("Regr_No=" + PartNumber.ToString())

            oRange(18 + iCounter, 1) = oRow("Dep_Var_No")
            oTempRange = oRange(18 + iCounter, 1)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(18 + iCounter, 2) = "'" + oRow("Code")
            oTempRange = oRange(18 + iCounter, 2)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

            oRange(18 + iCounter, 3) = oRow("Indentification")
            oTempRange = oRange(18 + iCounter, 3)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

            oRange(18 + iCounter, 4) = oRow("Rpt_Sheet")
            oTempRange = oRange(18 + iCounter, 4)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            oRange(18 + iCounter, 5) = oRow("Line")
            oTempRange = oRange(18 + iCounter, 5)
            oTempRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter

            iCounter = iCounter + 1
        Next

    End Sub

    Private Function GetVariabilityEquation(OutVarSource As String, OutVarCoeff As String, CapVarSource As String, CapVarCoeff As String) As String
        Dim sReturn As String

        sReturn = "=(" + OutVarSource + "*" + OutVarCoeff + ")/((" + OutVarSource + "*" + OutVarCoeff + ")+(" + CapVarSource + "*" + CapVarCoeff + "))"

        Return sReturn

    End Function

    Private Sub WriteTitlesAndColumnHeaders()

        oRange = oXLWsheet.Cells

        oRange.Font.Name = "Consolas"
        oRange.Font.Size = 10
        oRange(1, 1) = sTitle_RR_YEAR
        oTempRange = oRange(1, 1)
        oTempRange.Font.Italic = True

        oRange(2, 1) = sTitle_WORKTABLE
        oTempRange = oRange(2, 1)
        oTempRange.Font.Bold = True
        oTempRange.Font.Size = 12

        For Each drTitles As DataRow In dtTitles.Select(sSelectWorktable)

            'first get the worktable titles
            oRange(3, 2) = drTitles("Title1").ToString()
            oTempRange = oRange(3, 2)
            oTempRange.Font.Bold = True

            oRange(4, 2) = drTitles("Title2").ToString()
            oTempRange = oRange(4, 2)
            oTempRange.Font.Bold = True

            oRange(5, 2) = drTitles("Title3").ToString()
            oTempRange = oRange(4, 2)
            oTempRange.Font.Bold = True

            sWorktableColumn = ""

            'now get the column headers
            For iCurrentCol As Integer = 1 To iColumnCount

                sColumnName = "rpt_col" & iCurrentCol.ToString

                If drTitles(sColumnName).ToString().IndexOf("Source") > 0 Then
                    sWorktableColumn = drTitles(sColumnName).ToString().Substring(0, drTitles(sColumnName).ToString().IndexOf(" "))
                Else
                    If sWorktableColumn <> "" Then
                        oRange(6, iCurrentCol) = sWorktableColumn
                        oTempRange = oRange(6, iCurrentCol)
                        oTempRange.HorizontalAlignment = Excel.XlVAlign.xlVAlignCenter
                    End If
                End If

                oRange(7, iCurrentCol) = drTitles(sColumnName).ToString().Replace("|", Chr(10))
            Next

            'Finally, Deal with the column header formatting
            sColumnRange = "A7:"
            If iColumnCount < 27 Then
                sColumnRange += Convert.ToChar(iColumnCount + 64)
            ElseIf iColumnCount > 26 And iColumnCount < 53 Then
                sColumnRange += "A"
                sColumnRange += Convert.ToChar((iColumnCount - 26) + 64)
            ElseIf iColumnCount > 52 And iColumnCount < 79 Then
                sColumnRange += "B"
                sColumnRange += Convert.ToChar((iColumnCount - 52) + 64)
            ElseIf iColumnCount > 78 And iColumnCount < 105 Then
                sColumnRange += "C"
                sColumnRange += Convert.ToChar((iColumnCount - 78) + 64)
            ElseIf iColumnCount > 104 And iColumnCount < 131 Then
                sColumnRange += "D"
                sColumnRange += Convert.ToChar((iColumnCount - 104) + 64)
            ElseIf iColumnCount > 130 And iColumnCount < 157 Then
                sColumnRange += "E"
                sColumnRange += Convert.ToChar((iColumnCount - 130) + 64)
            Else
                sColumnRange += "F"
                sColumnRange += Convert.ToChar((iColumnCount - 156) + 64)
            End If
            sColumnRange += "7"

            oRange = oXLWsheet.Range(sColumnRange)
            With oRange
                .HorizontalAlignment = Excel.XlVAlign.xlVAlignCenter
                .Offset.WrapText = True
                .Borders.LineStyle = Excel.XlLineStyle.xlContinuous
                .Borders(Excel.XlBordersIndex.xlEdgeBottom).LineStyle = Excel.XlLineStyle.xlDouble
                .RowHeight = 40
                .ColumnWidth = 25
                .Font.Bold = True
            End With

            'Setup the line Column
            oRange = oXLWsheet.Columns(1)
            oRange.ColumnWidth = 8
            oRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

            'Setup the Code Column
            oRange = oXLWsheet.Columns(2)
            oRange.ColumnWidth = 8
            oRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

            'Setup the Identification Column
            oRange = oXLWsheet.Columns(3)
            oRange.ColumnWidth = 50
            oRange.HorizontalAlignment = Excel.XlHAlign.xlHAlignLeft

        Next

    End Sub

    ''' <summary>
    ''' Writes the first 3 columns to each page
    ''' </summary>
    ''' <remarks></remarks>
    Private Sub WriteFirst3ColumnsAndPageLayout()

        'SET PAGE LAYOUT
        With oXLWsheet.PageSetup
            .Orientation = Excel.XlPageOrientation.xlLandscape
            .Zoom = 70
            .LeftFooter = "Page &P of &N"
            .PrintTitleRows = "$1:$7"
            .PrintTitleColumns = "$A:$C"
        End With

        'RESET iROW_COUNT and oRange
        iROW_COUNT = 8
        oRange = oXLWsheet.Cells

        For Each drRow As DataRow In dtLineSourceText.Select(sSelectStringRows)

            'Write The Line Number
            oRange(iROW_COUNT, 1) = drRow("Line").ToString()

            'Write Code
            oRange(iROW_COUNT, 2) = "'" + drRow("Code").ToString()

            'Write Identification
            oRange(iROW_COUNT, 3) = drRow("Identification").ToString()

            'increment iROW_COUNT
            iROW_COUNT = iROW_COUNT + 1

        Next

        iROW_COUNT = iROW_COUNT + 2

        For Each drRow As DataRow In dtFootnotes.Select(sSelectWorktable)
            'Write The Footnote number
            oRange(iROW_COUNT, 2) = drRow("No").ToString()

            'Write Code
            oRange(iROW_COUNT, 3) = "'" + drRow("Text").ToString()

            'increment iROW_COUNT
            iROW_COUNT = iROW_COUNT + 1
        Next

    End Sub

    ''' <summary>
    ''' Replaces the #Y# placeholders with the correct years
    ''' </summary>
    ''' <param name="s"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function scrubYear(ByVal s As String) As String

        s = s.Replace("#Y#", iCurrentYear.ToString())
        s = s.Replace("#Y-1#", (iCurrentYear - 1).ToString())
        s = s.Replace("#Y-2#", (iCurrentYear - 2).ToString())
        s = s.Replace("#Y-3#", (iCurrentYear - 3).ToString())
        s = s.Replace("#Y-4#", (iCurrentYear - 4).ToString())
        s = s.Replace("#Y-5#", (iCurrentYear - 4).ToString())

        Return s

    End Function

    ''' <summary>
    ''' Returns true if the excel field has no value or just spaces
    ''' </summary>
    ''' <param name="s"></param>
    ''' <returns></returns>
    ''' <remarks></remarks>
    Private Function checkForEmptyString(ByVal s As String) As Boolean
        If (Len(Trim(s)) = 0 And Len(s) <> 0) Or Len(Trim(s)) = 0 Then
            Return True
        Else
            Return False
        End If
    End Function

    Private Sub UpdateStatus(StatusText As String, Optional Completed As Boolean = False)

        Try
            RaiseEvent StatusUpdated(iRailroadNumber, StatusText, Completed)

            If bCreateLog Then
                Dim w As StreamWriter = IO.File.AppendText(sLogFileName)
                w.WriteLine(DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss") & " => " & StatusText)
                w.Flush()
                w.Close()
            End If
        Catch

        End Try
    End Sub

#End Region

    Protected Overrides Sub Finalize()
        MyBase.Finalize()
    End Sub
End Class
